<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of trimPathway</title>
  <meta name="keywords" content="trimPathway">
  <meta name="description" content="trimPathway">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../index.html">Home</a> &gt;  <a href="index.html">pathway</a> &gt; trimPathway.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../index.html"><img alt="<" border="0" src="../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for pathway&nbsp;<img alt=">" border="0" src="../right.png"></a></td></tr></table>-->

<h1>trimPathway
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>trimPathway</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function pathway=trimPathway(pathway, rxnsToKeep, deleteUnconnectedMets) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> trimPathway
   Delete reactions from a pathway object

   pathway                   map structure as generated by 
                             constructPathwayFromCelldesigner
   rxnsToKeep                cell array with the IDs of the reactions to
                             keep
   deleteUnconnectedMets     delete metabolites that are no longer connected
                             by any reactions (opt, default true)

     pathway                   an updated pathway object

   Usage: pathway=trimPathway(pathway, rxnsToKeep, deleteUnconnectedMets)

   Rasmus Agren, 2010-12-16</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function pathway=trimPathway(pathway, rxnsToKeep, deleteUnconnectedMets)</a>
0002 <span class="comment">% trimPathway</span>
0003 <span class="comment">%   Delete reactions from a pathway object</span>
0004 <span class="comment">%</span>
0005 <span class="comment">%   pathway                   map structure as generated by</span>
0006 <span class="comment">%                             constructPathwayFromCelldesigner</span>
0007 <span class="comment">%   rxnsToKeep                cell array with the IDs of the reactions to</span>
0008 <span class="comment">%                             keep</span>
0009 <span class="comment">%   deleteUnconnectedMets     delete metabolites that are no longer connected</span>
0010 <span class="comment">%                             by any reactions (opt, default true)</span>
0011 <span class="comment">%</span>
0012 <span class="comment">%     pathway                   an updated pathway object</span>
0013 <span class="comment">%</span>
0014 <span class="comment">%   Usage: pathway=trimPathway(pathway, rxnsToKeep, deleteUnconnectedMets)</span>
0015 <span class="comment">%</span>
0016 <span class="comment">%   Rasmus Agren, 2010-12-16</span>
0017 <span class="comment">%</span>
0018 
0019 <span class="keyword">if</span> nargin&lt;3
0020     deleteUnconnectedMets=true;
0021 <span class="keyword">end</span>
0022 
0023 <span class="comment">%First find the aliases and indexes of all reactions that should be deleted</span>
0024 indexesToDelete=false(numel(pathway.listOfSpecies),1);
0025 aliasesToDelete={};
0026 
0027 <span class="keyword">for</span> i=1:numel(pathway.listOfSpecies)
0028    <span class="keyword">if</span> strcmpi(pathway.listOfSpecies(i).type,<span class="string">'PROTEIN'</span>)
0029       <span class="comment">%Check if the name is in the list of reactions to delete</span>
0030       <span class="keyword">if</span> ~ismember(pathway.listOfSpecies(i).name,rxnsToKeep)
0031           indexesToDelete(i)=true;
0032           aliasesToDelete=[aliasesToDelete;pathway.listOfSpecies(i).alias];
0033       <span class="keyword">end</span>
0034    <span class="keyword">end</span>
0035 <span class="keyword">end</span>
0036 
0037 <span class="comment">%Then go through each of the reactions and delete the ones that only have</span>
0038 <span class="comment">%modifiers that are in the aliasesToDelete list</span>
0039 rxnsToDelete=false(numel(pathway.listOfReactions),1);
0040 
0041 <span class="keyword">for</span> i=1:numel(pathway.listOfReactions)
0042     <span class="comment">%Keeps track of which components to delete. -1=enzyme to delete, 0=metabolite,</span>
0043     <span class="comment">%1=enzyme to keep</span>
0044     componentsToDelete=zeros(numel(pathway.listOfReactions(i).componentList),1);
0045     <span class="keyword">for</span> j=1:numel(pathway.listOfReactions(i).componentList)
0046         <span class="keyword">if</span> strcmpi(pathway.listOfReactions(i).componentList(j).type,<span class="string">'ENZYME'</span>)
0047             <span class="comment">%If the enzyme alias is not in the list then should it not be</span>
0048             <span class="comment">%deleted</span>
0049             <span class="keyword">if</span> ismember(pathway.listOfReactions(i).componentList(j).alias,aliasesToDelete)
0050                 componentsToDelete(j)=-1;
0051             <span class="keyword">else</span>
0052                 componentsToDelete(j)=1;
0053             <span class="keyword">end</span>
0054         <span class="keyword">end</span>
0055     <span class="keyword">end</span>
0056     <span class="comment">%If all enzymes should be deleted then should the whole reacction be</span>
0057     <span class="comment">%deleted. Otherwise only delete those enzymes</span>
0058     <span class="keyword">if</span> ~any(componentsToDelete==1)
0059         rxnsToDelete(i)=true;
0060     <span class="keyword">else</span>
0061         pathway.listOfReactions(i).componentList(componentsToDelete==-1)=[];
0062     <span class="keyword">end</span>
0063 <span class="keyword">end</span>
0064 
0065 <span class="comment">%Delete the reactions and components that should be deleted</span>
0066 pathway.listOfSpecies(indexesToDelete)=[];
0067 pathway.listOfReactions(rxnsToDelete)=[];
0068 
0069 <span class="comment">%This is not neat but it goes through all the reactions and adds the</span>
0070 <span class="comment">%aliases that should be kept. All other are deleted</span>
0071 aliasesToKeeep={};
0072 <span class="keyword">if</span> deleteUnconnectedMets==true
0073     <span class="keyword">for</span> i=1:numel(pathway.listOfReactions)
0074        <span class="keyword">for</span> j=1:numel(pathway.listOfReactions(i).componentList)
0075            aliasesToKeeep=[aliasesToKeeep;pathway.listOfReactions(i).componentList(j).alias];
0076        <span class="keyword">end</span>
0077     <span class="keyword">end</span>
0078     
0079     <span class="comment">%Go through the species again and only keep those that are in the</span>
0080     <span class="comment">%aliasesToKeeep list</span>
0081     indexesToDelete=true(numel(pathway.listOfSpecies),1);
0082     <span class="keyword">for</span> i=1:numel(pathway.listOfSpecies)
0083         <span class="keyword">if</span> ismember(pathway.listOfSpecies(i).alias,aliasesToKeeep)
0084             indexesToDelete(i)=false;
0085         <span class="keyword">end</span>
0086     <span class="keyword">end</span>
0087     
0088     pathway.listOfSpecies(indexesToDelete)=[];
0089 <span class="keyword">end</span>
0090 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Wed 14-Mar-2018 21:08:28 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of drawMap</title>
  <meta name="keywords" content="drawMap">
  <meta name="description" content="drawMap">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../index.html">Home</a> &gt;  <a href="index.html">plotting</a> &gt; drawMap.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../index.html"><img alt="<" border="0" src="../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for plotting&nbsp;<img alt=">" border="0" src="../right.png"></a></td></tr></table>-->

<h1>drawMap
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>drawMap</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function notMapped=drawMap(title,pathway,modelA,conditionA,conditionB,modelB,filename,cutOff) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> drawMap
   Imports a previously drawn map of the metabolic network and plots
   the fluxes on that map. If the pathway contains expression data the log-fold
   changes are plotted as well

   title           title to be printed on the map
   pathway         map structure as generated by 
                   constructPathwayFromCelldesigner
   modelA            model structure for condition A
   conditionA      flux vector for condition A
   conditionB        flux vector for condition B (opt)
   modelB            model structure for condition B (opt, default modelA)
   filename        exports the map as a pdf (opt)
   cutOff          only print fluxes where one of the fluxes are above this
                   value (opt, default 10^-7)

   notMapped         the reaction ids that carried a flux in either of the
                   conditions but that were not present in the metabolic map

   The objective function in modelA is assumed to be the objective function
   in both cases. If only one flux is supplied then that flux is printed two
   times in each box.

   Usage: notMapped=drawMap(title,pathway,modelA,conditionA,...
           conditionB,modelB,filename,cutOff)

   Rasmus Agren, 2013-06-27</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="../core/getObjectiveString.html" class="code" title="function objectiveString = getObjectiveString(max, objectiveNames, objectiveValues)">getObjectiveString</a>	getObjectiveString</li><li><a href="../core/setTitle.html" class="code" title="function setTitle(handle, pathway, title)">setTitle</a>	plotLabels</li><li><a href="../pathway/colorPathway.html" class="code" title="function returnPathway = colorPathway(pathway, reactionIDs, fluxes, referenceFluxes,cutOff, defaultColor, upColor, downColor)">colorPathway</a>	colorPathway</li><li><a href="../pathway/markPathwayWithFluxes.html" class="code" title="function [returnPathway errorFlag]= markPathwayWithFluxes(pathway, reactionIDs, fluxes, referenceFluxes)">markPathwayWithFluxes</a>	markPathwayWithFluxes</li><li><a href="drawPathway.html" class="code" title="function drawPathway(pathway, handle, cutOff, defaultColor)">drawPathway</a>	drawPathway</li><li><a href="plotAdditionalInfo.html" class="code" title="function plotAdditionalInfo(handle, pathway, additionalText, exampleBoxText,maxChange, defaultColor, upColor, downColor)">plotAdditionalInfo</a>	plotAdditionalInfo</li><li><a href="plotLabels.html" class="code" title="function plotLabels(handle,pathway)">plotLabels</a>	plotLabels</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="../tutorial/tutorial0.html" class="code" title="">tutorial0</a>	****RAVEN TOOLBOX MINI TUTORIAL***</li><li><a href="../tutorial/tutorial2.html" class="code" title="">tutorial2</a>	This contains the code necessary for running Exercises 2. It is assumed</li><li><a href="../tutorial/tutorial2_solutions.html" class="code" title="">tutorial2_solutions</a>	This is the solution to tutorial 2. All parameters are set in this file,</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function notMapped=drawMap(title,pathway,modelA,conditionA,conditionB,modelB,filename,cutOff)</a>
0002 <span class="comment">% drawMap</span>
0003 <span class="comment">%   Imports a previously drawn map of the metabolic network and plots</span>
0004 <span class="comment">%   the fluxes on that map. If the pathway contains expression data the log-fold</span>
0005 <span class="comment">%   changes are plotted as well</span>
0006 <span class="comment">%</span>
0007 <span class="comment">%   title           title to be printed on the map</span>
0008 <span class="comment">%   pathway         map structure as generated by</span>
0009 <span class="comment">%                   constructPathwayFromCelldesigner</span>
0010 <span class="comment">%   modelA            model structure for condition A</span>
0011 <span class="comment">%   conditionA      flux vector for condition A</span>
0012 <span class="comment">%   conditionB        flux vector for condition B (opt)</span>
0013 <span class="comment">%   modelB            model structure for condition B (opt, default modelA)</span>
0014 <span class="comment">%   filename        exports the map as a pdf (opt)</span>
0015 <span class="comment">%   cutOff          only print fluxes where one of the fluxes are above this</span>
0016 <span class="comment">%                   value (opt, default 10^-7)</span>
0017 <span class="comment">%</span>
0018 <span class="comment">%   notMapped         the reaction ids that carried a flux in either of the</span>
0019 <span class="comment">%                   conditions but that were not present in the metabolic map</span>
0020 <span class="comment">%</span>
0021 <span class="comment">%   The objective function in modelA is assumed to be the objective function</span>
0022 <span class="comment">%   in both cases. If only one flux is supplied then that flux is printed two</span>
0023 <span class="comment">%   times in each box.</span>
0024 <span class="comment">%</span>
0025 <span class="comment">%   Usage: notMapped=drawMap(title,pathway,modelA,conditionA,...</span>
0026 <span class="comment">%           conditionB,modelB,filename,cutOff)</span>
0027 <span class="comment">%</span>
0028 <span class="comment">%   Rasmus Agren, 2013-06-27</span>
0029 <span class="comment">%</span>
0030 
0031 <span class="keyword">if</span> nargin&lt;4
0032     conditionB=conditionA;
0033 <span class="keyword">end</span>
0034 
0035 <span class="keyword">if</span> nargin&lt;5
0036     modelB=modelA;
0037 <span class="keyword">end</span>
0038 
0039 <span class="keyword">if</span> nargin&lt;8
0040     cutOff=10^-7;
0041 <span class="keyword">end</span>
0042 
0043 <span class="keyword">if</span> isempty(conditionB)
0044     conditionB=conditionA;
0045 <span class="keyword">end</span>
0046 
0047 <span class="keyword">if</span> isempty(modelB)
0048     modelB=modelA;
0049 <span class="keyword">end</span>
0050 
0051 objectiveNames=modelA.rxns(modelA.c~=0);
0052 objectiveValues=modelA.c(modelA.c~=0);
0053 
0054 <span class="comment">%Replace all values which are below the cut-off with 0.0</span>
0055 conditionA(abs(conditionA)&lt;cutOff)=0;
0056 conditionB(abs(conditionB)&lt;cutOff)=0;
0057 
0058 <span class="comment">%Get the reactions that could not be mapped</span>
0059 carriesFlux=union(modelA.rxns,modelB.rxns);
0060 
0061 rxnsInModel={};
0062 <span class="comment">%Loop through the pathway structure and get the reaction that can be mapped</span>
0063 <span class="keyword">for</span> i=1:numel(pathway.listOfSpecies)
0064     <span class="keyword">if</span> strcmp(pathway.listOfSpecies(i).type,<span class="string">'PROTEIN'</span>)
0065         <span class="keyword">if</span> ~isempty(pathway.listOfSpecies(i).note)
0066             rxnsInModel=[rxnsInModel;pathway.listOfSpecies(i).note(1)]; 
0067         <span class="keyword">end</span>
0068     <span class="keyword">end</span>
0069 <span class="keyword">end</span>
0070 
0071 <span class="comment">%Find all reaction bounds that are &quot;non-standard&quot;. Since the default bounds</span>
0072 <span class="comment">%are not indicated in the model structure it is assumed that the maximal</span>
0073 <span class="comment">%bound value is the default one.</span>
0074 rxnBoundsA=find(modelA.ub~=max(modelA.ub) | (modelA.lb~=-max(modelA.ub) &amp; modelA.rev==1) | (modelA.lb~=0 &amp; modelA.rev==0));
0075 rxnBoundsB=find(modelB.ub~=max(modelB.ub) | (modelB.lb~=-max(modelB.ub) &amp; modelB.rev==1) | (modelB.lb~=0 &amp; modelB.rev==0));
0076 
0077 notMapped=setdiff(carriesFlux,rxnsInModel);
0078 
0079 pathway=<a href="../pathway/colorPathway.html" class="code" title="function returnPathway = colorPathway(pathway, reactionIDs, fluxes, referenceFluxes,cutOff, defaultColor, upColor, downColor)">colorPathway</a>(pathway,modelA.rxns,conditionA,conditionB,cutOff);
0080 pathway=<a href="../pathway/markPathwayWithFluxes.html" class="code" title="function [returnPathway errorFlag]= markPathwayWithFluxes(pathway, reactionIDs, fluxes, referenceFluxes)">markPathwayWithFluxes</a>(pathway,modelA.rxns,conditionA,conditionB);
0081 
0082 h=figure;
0083 <a href="drawPathway.html" class="code" title="function drawPathway(pathway, handle, cutOff, defaultColor)">drawPathway</a>(pathway,h,cutOff);
0084 
0085 <span class="comment">%Plot labels and title at pathway map</span>
0086 <a href="plotLabels.html" class="code" title="function plotLabels(handle,pathway)">plotLabels</a>(h,pathway);
0087 <a href="../core/setTitle.html" class="code" title="function setTitle(handle, pathway, title)">setTitle</a>(h,pathway,title);
0088 
0089 <span class="comment">%Plot example box, color example and additional information</span>
0090 exampleBoxText(1)={<span class="string">'Reaction ID'</span>};
0091 exampleBoxText(2)={<span class="string">'Condition A'</span>};
0092 exampleBoxText(3)={<span class="string">'Condition B'</span>};
0093 <span class="keyword">if</span> nargin&gt;7
0094     exampleBoxText(4)={<span class="string">'Other data'</span>};
0095 <span class="keyword">end</span>
0096 
0097 additionalText={};
0098 additionalText=[additionalText;{<span class="string">'Objective function'</span>}];
0099 
0100 additionalText=[additionalText;{<a href="../core/getObjectiveString.html" class="code" title="function objectiveString = getObjectiveString(max, objectiveNames, objectiveValues)">getObjectiveString</a>(true, objectiveNames, objectiveValues)}];
0101 additionalText=[additionalText;{<span class="string">''</span>}];
0102 additionalText=[additionalText;{<span class="string">'Constraints (condition A)'</span>}];
0103 
0104 counter=numel(additionalText)+1;
0105 <span class="keyword">for</span> i=1:length(rxnBoundsA)
0106     additionalText{counter}=[modelA.rxns{rxnBoundsA(i)} <span class="string">'  ['</span> <span class="keyword">...</span>
0107         num2str([modelA.lb(rxnBoundsA(i)) modelA.ub(rxnBoundsA(i))]) <span class="string">']'</span>];
0108     counter=counter+1;
0109 <span class="keyword">end</span>
0110 
0111 additionalText=[additionalText;{<span class="string">''</span>}];
0112 additionalText=[additionalText;{<span class="string">'Constraints (condition B)'</span>}];
0113 
0114 counter=numel(additionalText)+1;
0115 <span class="keyword">for</span> i=1:length(rxnBoundsB)
0116     additionalText{counter}=[modelB.rxns{rxnBoundsB(i)} <span class="string">'  ['</span> <span class="keyword">...</span>
0117         num2str([modelB.lb(rxnBoundsB(i)) modelB.ub(rxnBoundsB(i))]) <span class="string">']'</span>];
0118     counter=counter+1;
0119 <span class="keyword">end</span>
0120 
0121 <a href="plotAdditionalInfo.html" class="code" title="function plotAdditionalInfo(handle, pathway, additionalText, exampleBoxText,maxChange, defaultColor, upColor, downColor)">plotAdditionalInfo</a>(h, pathway, additionalText, exampleBoxText, 1);
0122 
0123 <span class="keyword">if</span> nargin&gt;5
0124     <span class="keyword">if</span> any(filename)
0125         set(gcf, <span class="string">'PaperType'</span>, <span class="string">'A4'</span>); 
0126         orient landscape;
0127         print(<span class="string">'-dpdf'</span>, <span class="string">'-r600'</span>, filename);
0128         fprintf(<span class="string">'File saved as %s\n'</span>,filename);
0129     <span class="keyword">end</span>
0130 <span class="keyword">end</span>
0131 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Fri 14-Oct-2016 12:02:10 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>
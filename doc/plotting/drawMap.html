<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of drawMap</title>
  <meta name="keywords" content="drawMap">
  <meta name="description" content="drawMap">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../index.html">Home</a> &gt;  <a href="index.html">plotting</a> &gt; drawMap.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../index.html"><img alt="<" border="0" src="../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for plotting&nbsp;<img alt=">" border="0" src="../right.png"></a></td></tr></table>-->

<h1>drawMap
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>drawMap</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function notMapped=drawMap(title,pathway,modelA,conditionA,conditionB,modelB,filename,cutOff,supressOpen) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> drawMap
   Imports a previously drawn map of the metabolic network and plots
   the fluxes on that map. If the pathway contains expression data the log-fold
   changes are plotted as well

   title           title to be printed on the map
   pathway         map structure as generated by
                   constructPathwayFromCelldesigner
   modelA            model structure for condition A
   conditionA      flux vector for condition A
   conditionB        flux vector for condition B (opt)
   modelB            model structure for condition B (opt, default modelA)
   filename        exports the map as a pdf (opt)
   cutOff          only print fluxes where one of the fluxes are above this
                   value (opt, default 10^-7)
   supressOpen     true if the pdf file should not be opened (opt, default
                   false)

   notMapped         the reaction ids that carried a flux in either of the
                   conditions but that were not present in the metabolic map

   The objective function in modelA is assumed to be the objective function
   in both cases. If only one flux is supplied then that flux is printed two
   times in each box.

   Usage: notMapped=drawMap(title,pathway,modelA,conditionA,...
           conditionB,modelB,filename,cutOff,supressOpen)</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="drawPathway.html" class="code" title="function drawPathway(pathway, h, cutOff, defaultColor)">drawPathway</a>	drawPathway</li><li><a href="getObjectiveString.html" class="code" title="function objectiveString = getObjectiveString(max, objectiveNames, objectiveValues)">getObjectiveString</a>	getObjectiveString</li><li><a href="plotAdditionalInfo.html" class="code" title="function plotAdditionalInfo(handle, pathway, additionalText, exampleBoxText,maxChange, defaultColor, upColor, downColor)">plotAdditionalInfo</a>	plotAdditionalInfo</li><li><a href="plotLabels.html" class="code" title="function plotLabels(handle,pathway)">plotLabels</a>	plotLabels</li><li><a href="setTitle.html" class="code" title="function setTitle(handle, pathway, title)">setTitle</a>	plotLabels</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function notMapped=drawMap(title,pathway,modelA,conditionA,conditionB,modelB,filename,cutOff,supressOpen)</a>
0002 <span class="comment">% drawMap</span>
0003 <span class="comment">%   Imports a previously drawn map of the metabolic network and plots</span>
0004 <span class="comment">%   the fluxes on that map. If the pathway contains expression data the log-fold</span>
0005 <span class="comment">%   changes are plotted as well</span>
0006 <span class="comment">%</span>
0007 <span class="comment">%   title           title to be printed on the map</span>
0008 <span class="comment">%   pathway         map structure as generated by</span>
0009 <span class="comment">%                   constructPathwayFromCelldesigner</span>
0010 <span class="comment">%   modelA            model structure for condition A</span>
0011 <span class="comment">%   conditionA      flux vector for condition A</span>
0012 <span class="comment">%   conditionB        flux vector for condition B (opt)</span>
0013 <span class="comment">%   modelB            model structure for condition B (opt, default modelA)</span>
0014 <span class="comment">%   filename        exports the map as a pdf (opt)</span>
0015 <span class="comment">%   cutOff          only print fluxes where one of the fluxes are above this</span>
0016 <span class="comment">%                   value (opt, default 10^-7)</span>
0017 <span class="comment">%   supressOpen     true if the pdf file should not be opened (opt, default</span>
0018 <span class="comment">%                   false)</span>
0019 <span class="comment">%</span>
0020 <span class="comment">%   notMapped         the reaction ids that carried a flux in either of the</span>
0021 <span class="comment">%                   conditions but that were not present in the metabolic map</span>
0022 <span class="comment">%</span>
0023 <span class="comment">%   The objective function in modelA is assumed to be the objective function</span>
0024 <span class="comment">%   in both cases. If only one flux is supplied then that flux is printed two</span>
0025 <span class="comment">%   times in each box.</span>
0026 <span class="comment">%</span>
0027 <span class="comment">%   Usage: notMapped=drawMap(title,pathway,modelA,conditionA,...</span>
0028 <span class="comment">%           conditionB,modelB,filename,cutOff,supressOpen)</span>
0029 
0030 <span class="keyword">if</span> nargin&lt;4
0031     conditionB=conditionA;
0032 <span class="keyword">end</span>
0033 
0034 <span class="keyword">if</span> nargin&lt;5
0035     modelB=modelA;
0036 <span class="keyword">end</span>
0037 
0038 <span class="keyword">if</span> nargin&lt;8
0039     cutOff=10^-7;
0040 <span class="keyword">end</span>
0041 
0042 <span class="keyword">if</span> nargin&lt;9
0043     supressOpen=false;
0044 <span class="keyword">end</span>
0045 
0046 <span class="keyword">if</span> isempty(conditionB)
0047     conditionB=conditionA;
0048 <span class="keyword">end</span>
0049 
0050 <span class="keyword">if</span> isempty(modelB)
0051     modelB=modelA;
0052 <span class="keyword">end</span>
0053 
0054 objectiveNames=modelA.rxns(modelA.c~=0);
0055 objectiveValues=modelA.c(modelA.c~=0);
0056 
0057 <span class="comment">%Replace all values which are below the cut-off with 0.0</span>
0058 conditionA(abs(conditionA)&lt;cutOff)=0;
0059 conditionB(abs(conditionB)&lt;cutOff)=0;
0060 
0061 <span class="comment">%Get the reactions that could not be mapped</span>
0062 carriesFlux=union(modelA.rxns,modelB.rxns);
0063 
0064 rxnsInModel={};
0065 <span class="comment">%Loop through the pathway structure and get the reaction that can be mapped</span>
0066 <span class="keyword">for</span> i=1:numel(pathway.listOfSpecies)
0067     <span class="keyword">if</span> strcmp(pathway.listOfSpecies(i).type,<span class="string">'PROTEIN'</span>)
0068         <span class="keyword">if</span> ~isempty(pathway.listOfSpecies(i).note)
0069             rxnsInModel=[rxnsInModel;pathway.listOfSpecies(i).note(1)];
0070         <span class="keyword">end</span>
0071     <span class="keyword">end</span>
0072 <span class="keyword">end</span>
0073 
0074 <span class="comment">%Find all reaction bounds that are &quot;non-standard&quot;. Since the default bounds</span>
0075 <span class="comment">%are not indicated in the model structure it is assumed that the maximal</span>
0076 <span class="comment">%bound value is the default one.</span>
0077 rxnBoundsA=find(modelA.ub~=max(modelA.ub) | (modelA.lb~=-max(modelA.ub) &amp; modelA.rev==1) | (modelA.lb~=0 &amp; modelA.rev==0));
0078 rxnBoundsB=find(modelB.ub~=max(modelB.ub) | (modelB.lb~=-max(modelB.ub) &amp; modelB.rev==1) | (modelB.lb~=0 &amp; modelB.rev==0));
0079 
0080 notMapped=setdiff(carriesFlux,rxnsInModel);
0081 
0082 pathway=colorPathway(pathway,modelA.rxns,conditionA,conditionB,cutOff);
0083 pathway=markPathwayWithFluxes(pathway,modelA.rxns,conditionA,conditionB);
0084 
0085 h=figure(<span class="string">'Visible'</span>,<span class="string">'Off'</span>);
0086 <a href="drawPathway.html" class="code" title="function drawPathway(pathway, h, cutOff, defaultColor)">drawPathway</a>(pathway,h,cutOff);
0087 
0088 <span class="comment">%Plot labels and title at pathway map</span>
0089 <a href="plotLabels.html" class="code" title="function plotLabels(handle,pathway)">plotLabels</a>(h,pathway);
0090 <a href="setTitle.html" class="code" title="function setTitle(handle, pathway, title)">setTitle</a>(h,pathway,title);
0091 
0092 <span class="comment">%Plot example box, color example and additional information</span>
0093 exampleBoxText(1)={<span class="string">'Reaction ID'</span>};
0094 exampleBoxText(2)={<span class="string">'Condition A'</span>};
0095 exampleBoxText(3)={<span class="string">'Condition B'</span>};
0096 <span class="keyword">if</span> nargin&gt;7
0097     exampleBoxText(4)={<span class="string">'Other data'</span>};
0098 <span class="keyword">end</span>
0099 
0100 additionalText={};
0101 additionalText=[additionalText;{<span class="string">'Objective function'</span>}];
0102 
0103 additionalText=[additionalText;{<a href="getObjectiveString.html" class="code" title="function objectiveString = getObjectiveString(max, objectiveNames, objectiveValues)">getObjectiveString</a>(true, objectiveNames, objectiveValues)}];
0104 additionalText=[additionalText;{<span class="string">''</span>}];
0105 additionalText=[additionalText;{<span class="string">'Constraints (condition A)'</span>}];
0106 
0107 counter=numel(additionalText)+1;
0108 <span class="keyword">for</span> i=1:length(rxnBoundsA)
0109     additionalText{counter}=[modelA.rxns{rxnBoundsA(i)} <span class="string">'  ['</span> <span class="keyword">...</span>
0110         num2str([modelA.lb(rxnBoundsA(i)) modelA.ub(rxnBoundsA(i))]) <span class="string">']'</span>];
0111     counter=counter+1;
0112 <span class="keyword">end</span>
0113 
0114 additionalText=[additionalText;{<span class="string">''</span>}];
0115 additionalText=[additionalText;{<span class="string">'Constraints (condition B)'</span>}];
0116 
0117 counter=numel(additionalText)+1;
0118 <span class="keyword">for</span> i=1:length(rxnBoundsB)
0119     additionalText{counter}=[modelB.rxns{rxnBoundsB(i)} <span class="string">'  ['</span> <span class="keyword">...</span>
0120         num2str([modelB.lb(rxnBoundsB(i)) modelB.ub(rxnBoundsB(i))]) <span class="string">']'</span>];
0121     counter=counter+1;
0122 <span class="keyword">end</span>
0123 
0124 <a href="plotAdditionalInfo.html" class="code" title="function plotAdditionalInfo(handle, pathway, additionalText, exampleBoxText,maxChange, defaultColor, upColor, downColor)">plotAdditionalInfo</a>(h, pathway, additionalText, exampleBoxText, 1);
0125 
0126 <span class="keyword">if</span> nargin&gt;5
0127     <span class="keyword">if</span> any(filename)
0128         set(gcf, <span class="string">'PaperType'</span>, <span class="string">'A4'</span>);
0129         orient landscape;
0130         print(<span class="string">'-dpdf'</span>, <span class="string">'-r600'</span>, filename);
0131         fprintf(<span class="string">'File saved as %s\n'</span>,filename);
0132     <span class="keyword">end</span>
0133 <span class="keyword">end</span>
0134 
0135 <span class="keyword">if</span> supressOpen==false
0136     open(filename);
0137 <span class="keyword">end</span>
0138 <span class="keyword">end</span></pre></div>
<hr><address>Generated by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>
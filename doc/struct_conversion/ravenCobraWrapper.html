<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of ravenCobraWrapper</title>
  <meta name="keywords" content="ravenCobraWrapper">
  <meta name="description" content="ravenCobraWrapper">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../index.html">Home</a> &gt;  <a href="index.html">struct_conversion</a> &gt; ravenCobraWrapper.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../index.html"><img alt="<" border="0" src="../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for struct_conversion&nbsp;<img alt=">" border="0" src="../right.png"></a></td></tr></table>-->

<h1>ravenCobraWrapper
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>ravenCobraWrapper</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function newModel=ravenCobraWrapper(model) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> ravenCobraWrapper
   Converts between RAVEN and COBRA structures

   model          a RAVEN/COBRA-compatible model structure

   newModel       a COBRA/RAVEN-compatible model structure
   
   This function is a bidirectional tool to convert between RAVEN and COBRA
   structures. It recognises COBRA structure by checking field 'rules'
   existense, which is only found in COBRA Toolbox structure.

   NOTE: During RAVEN -&gt; COBRA -&gt; RAVEN conversion cycle the following
   fields are lost: annotation, compOutside, compMiriams, rxnComps,
   geneComps, unconstrained. Boundary metabolites are lost,
   because COBRA structure does not involve boundary metabolites, so they
   are removed using simplifyModel before RAVEN -&gt; COBRA conversion. The
   field 'rev' is also partially lost, but during COBRA -&gt; RAVEN
   conversion it's reconstructed based on lower bound reaction values

   NOTE: During COBRA -&gt; RAVEN -&gt; COBRA conversion cycle the following
   fields are lost: b, csense, osenseStr, description, geneEntrezID,
   metNotes, metSmiles, modelVersion, proteinNames, proteins

   NOTE: The information about mandatory RAVEN fields was taken from
   checkModelStruct function, whereas the corresponding information about
   COBRA fields was fetched from verifyModel function

   Usage: newModel=ravenCobraWrapper(model)

   Benjamín J. Sánchez, 2018-08-13</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="extractMiriam.html" class="code" title="function [miriams,extractedMiriamNames]=extractMiriam(modelMiriams,miriamNames)">extractMiriam</a>	extractMiriam</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="#_sub1" class="code">function rules=grrulesToRules(model)</a></li><li><a href="#_sub2" class="code">function grRules=rulesTogrrules(model)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function newModel=ravenCobraWrapper(model)</a>
0002 <span class="comment">% ravenCobraWrapper</span>
0003 <span class="comment">%   Converts between RAVEN and COBRA structures</span>
0004 <span class="comment">%</span>
0005 <span class="comment">%   model          a RAVEN/COBRA-compatible model structure</span>
0006 <span class="comment">%</span>
0007 <span class="comment">%   newModel       a COBRA/RAVEN-compatible model structure</span>
0008 <span class="comment">%</span>
0009 <span class="comment">%   This function is a bidirectional tool to convert between RAVEN and COBRA</span>
0010 <span class="comment">%   structures. It recognises COBRA structure by checking field 'rules'</span>
0011 <span class="comment">%   existense, which is only found in COBRA Toolbox structure.</span>
0012 <span class="comment">%</span>
0013 <span class="comment">%   NOTE: During RAVEN -&gt; COBRA -&gt; RAVEN conversion cycle the following</span>
0014 <span class="comment">%   fields are lost: annotation, compOutside, compMiriams, rxnComps,</span>
0015 <span class="comment">%   geneComps, unconstrained. Boundary metabolites are lost,</span>
0016 <span class="comment">%   because COBRA structure does not involve boundary metabolites, so they</span>
0017 <span class="comment">%   are removed using simplifyModel before RAVEN -&gt; COBRA conversion. The</span>
0018 <span class="comment">%   field 'rev' is also partially lost, but during COBRA -&gt; RAVEN</span>
0019 <span class="comment">%   conversion it's reconstructed based on lower bound reaction values</span>
0020 <span class="comment">%</span>
0021 <span class="comment">%   NOTE: During COBRA -&gt; RAVEN -&gt; COBRA conversion cycle the following</span>
0022 <span class="comment">%   fields are lost: b, csense, osenseStr, description, geneEntrezID,</span>
0023 <span class="comment">%   metNotes, metSmiles, modelVersion, proteinNames, proteins</span>
0024 <span class="comment">%</span>
0025 <span class="comment">%   NOTE: The information about mandatory RAVEN fields was taken from</span>
0026 <span class="comment">%   checkModelStruct function, whereas the corresponding information about</span>
0027 <span class="comment">%   COBRA fields was fetched from verifyModel function</span>
0028 <span class="comment">%</span>
0029 <span class="comment">%   Usage: newModel=ravenCobraWrapper(model)</span>
0030 <span class="comment">%</span>
0031 <span class="comment">%   Benjamín J. Sánchez, 2018-08-13</span>
0032 <span class="comment">%</span>
0033 
0034 <span class="keyword">if</span> isfield(model,<span class="string">'rules'</span>)
0035     isRaven=false;
0036 <span class="keyword">else</span>
0037     isRaven=true;
0038 <span class="keyword">end</span>
0039 
0040 <span class="keyword">if</span> isRaven
0041     fprintf(<span class="string">'Converting RAVEN structure to COBRA..\n'</span>);
0042     <span class="comment">%Convert from RAVEN to COBRA structure</span>
0043     
0044     <span class="comment">%Firstly remove boundary metabolites</span>
0045     model=simplifyModel(model);
0046     
0047     <span class="comment">%Mandatory COBRA fields</span>
0048     newModel.rxns=model.rxns;
0049     <span class="keyword">if</span> all(~cellfun(@isempty,regexp(model.mets,<span class="string">'\[[^\]]+\]$'</span>)))
0050         newModel.mets=model.mets;
0051     <span class="keyword">else</span>
0052         newModel.mets=strcat(model.mets,<span class="string">'['</span>,model.comps(model.metComps),<span class="string">']'</span>);
0053     <span class="keyword">end</span>
0054     newModel.S=model.S;
0055     newModel.lb=model.lb;
0056     newModel.ub=model.ub;
0057     newModel.c=model.c;
0058     <span class="comment">%b, csense, osenseStr, genes, rules are also mandatory, but defined</span>
0059     <span class="comment">%later to match the order of fields</span>
0060     
0061     <span class="comment">%Optional COBRA fields</span>
0062     <span class="keyword">if</span> isfield(model,<span class="string">'id'</span>)
0063         newModel.modelID=model.id;
0064     <span class="keyword">end</span>
0065     <span class="keyword">if</span> isfield(model,<span class="string">'description'</span>)
0066         newModel.modelName=model.description;
0067     <span class="keyword">end</span>
0068     <span class="keyword">if</span> isfield(model,<span class="string">'rxnNames'</span>)
0069         newModel.rxnNames=model.rxnNames;
0070     <span class="keyword">end</span>
0071     <span class="keyword">if</span> isfield(model,<span class="string">'subSystems'</span>)
0072         newModel.subSystems=model.subSystems;
0073     <span class="keyword">end</span>
0074     <span class="keyword">if</span> isfield(model,<span class="string">'eccodes'</span>)
0075         newModel.rxnECNumbers=model.eccodes;
0076     <span class="keyword">end</span>
0077     <span class="keyword">if</span> isfield(model,<span class="string">'rxnMiriams'</span>)
0078         [miriams,extractedMiriamNames]=<a href="extractMiriam.html" class="code" title="function [miriams,extractedMiriamNames]=extractMiriam(modelMiriams,miriamNames)">extractMiriam</a>(model.rxnMiriams);
0079         miriams=regexprep(miriams,<span class="string">'^[A-Za-z\.]*\/'</span>,<span class="string">''</span>);
0080         i=ismember(extractedMiriamNames,<span class="string">'kegg.reaction'</span>);
0081         <span class="keyword">if</span> any(i)
0082             newModel.rxnKEGGID=miriams(:,i);
0083         <span class="keyword">end</span>
0084         i=ismember(extractedMiriamNames,<span class="string">'bigg.reaction'</span>);
0085         <span class="keyword">if</span> any(i)
0086             newModel.rxnBIGGID=miriams(:,i);
0087         <span class="keyword">end</span>
0088         i=ismember(extractedMiriamNames,<span class="string">'rhea'</span>);
0089         <span class="keyword">if</span> any(i)
0090             newModel.rxnRheaID=miriams(:,i);
0091         <span class="keyword">end</span>
0092         i=ismember(extractedMiriamNames,<span class="string">'metacyc.reaction'</span>);
0093         <span class="keyword">if</span> any(i)
0094             newModel.rxnMetaCycID=miriams(:,i);
0095         <span class="keyword">end</span>
0096         i=ismember(extractedMiriamNames,<span class="string">'reactome'</span>);
0097         <span class="keyword">if</span> any(i)
0098             newModel.rxnREACTOMEID=miriams(:,i);
0099         <span class="keyword">end</span>
0100         i=ismember(extractedMiriamNames,<span class="string">'sabiork.reaction'</span>);
0101         <span class="keyword">if</span> any(i)
0102             newModel.rxnSABIORKID=miriams(:,i);
0103         <span class="keyword">end</span>
0104         i=ismember(extractedMiriamNames,<span class="string">'seed.reaction'</span>);
0105         <span class="keyword">if</span> any(i)
0106             newModel.rxnSEEDID=miriams(:,i);
0107         <span class="keyword">end</span>
0108         i=ismember(extractedMiriamNames,<span class="string">'metanetx.reaction'</span>);
0109         <span class="keyword">if</span> any(i)
0110             newModel.rxnMetaNetXID=miriams(:,i);
0111         <span class="keyword">end</span>
0112         i=ismember(extractedMiriamNames,<span class="string">'sbo'</span>);
0113         <span class="keyword">if</span> any(i)
0114             newModel.rxnSBOTerms=miriams(:,i);
0115         <span class="keyword">end</span>
0116     <span class="keyword">end</span>
0117     <span class="keyword">if</span> isfield(model,<span class="string">'rxnReferences'</span>)
0118         newModel.rxnReferences=model.rxnReferences;
0119     <span class="keyword">end</span>
0120     <span class="keyword">if</span> isfield(model,<span class="string">'rxnNotes'</span>)
0121         newModel.rxnNotes=model.rxnNotes;
0122     <span class="keyword">end</span>
0123     <span class="keyword">if</span> isfield(model,<span class="string">'metNames'</span>)
0124         newModel.metNames=strcat(model.metNames,<span class="string">' ['</span>,model.compNames(model.metComps),<span class="string">']'</span>);
0125     <span class="keyword">end</span>
0126     <span class="keyword">if</span> isfield(model,<span class="string">'metFormulas'</span>)
0127         newModel.metFormulas=model.metFormulas;
0128     <span class="keyword">end</span>
0129     <span class="keyword">if</span> isfield(model,<span class="string">'metMiriams'</span>)
0130         [miriams,extractedMiriamNames]=<a href="extractMiriam.html" class="code" title="function [miriams,extractedMiriamNames]=extractMiriam(modelMiriams,miriamNames)">extractMiriam</a>(model.metMiriams);
0131         miriams=regexprep(miriams,<span class="string">'^[A-Za-z\.]*\/'</span>,<span class="string">''</span>);
0132         <span class="comment">%Shorten miriam names for KEGG and PubChem. These shorter names</span>
0133         <span class="comment">%will be used later to concatenate KEGG COMPOUND/GLYCAN and PubChem</span>
0134         <span class="comment">%Compound/Substance, into corresponding COBRA model fields</span>
0135         extractedMiriamNames=regexprep(extractedMiriamNames,<span class="string">'^kegg\..+'</span>,<span class="string">'kegg'</span>);
0136         extractedMiriamNames=regexprep(extractedMiriamNames,<span class="string">'^pubchem\..+'</span>,<span class="string">'pubchem'</span>);
0137         i=ismember(extractedMiriamNames,<span class="string">'kegg'</span>);
0138         <span class="keyword">if</span> any(i) <span class="comment">% Combine KEGG compounds and glycans</span>
0139             <span class="keyword">for</span> j=1:length(i)
0140                 <span class="keyword">if</span> i(j) &amp;&amp; isfield(newModel,<span class="string">'metKEGGID'</span>)~=1
0141                     newModel.metKEGGID=miriams(:,j);
0142                 <span class="keyword">elseif</span> i(j)
0143                     newModel.metKEGGID=strcat(newModel.metKEGGID,<span class="string">';'</span>,miriams(:,j));
0144                 <span class="keyword">end</span>
0145             <span class="keyword">end</span>
0146             newModel.metKEGGID=regexprep(newModel.metKEGGID,<span class="string">'^;|;$'</span>,<span class="string">''</span>);
0147         <span class="keyword">end</span>
0148         i=ismember(extractedMiriamNames,<span class="string">'chebi'</span>);
0149         <span class="keyword">if</span> any(i)
0150             newModel.metChEBIID=miriams(:,i);
0151         <span class="keyword">end</span>
0152         i=ismember(extractedMiriamNames,<span class="string">'pubchem'</span>);
0153         <span class="keyword">if</span> any(i) <span class="comment">% Combine Pubchem compounds and substances</span>
0154             <span class="keyword">for</span> j=1:length(i)
0155                 <span class="keyword">if</span> i(j) &amp;&amp; isfield(newModel,<span class="string">'metPubChemID'</span>)~=1
0156                     newModel.metPubChemID=miriams(:,j);
0157                 <span class="keyword">elseif</span> i(j)
0158                     newModel.metPubChemID=strcat(newModel.metPubChemID,<span class="string">';'</span>,miriams(:,j));
0159                 <span class="keyword">end</span>
0160             <span class="keyword">end</span>
0161             newModel.metPubChemID=regexprep(newModel.metPubChemID,<span class="string">'^;|;$'</span>,<span class="string">''</span>);
0162         <span class="keyword">end</span>
0163         i=ismember(extractedMiriamNames,<span class="string">'bigg.metabolite'</span>);
0164         <span class="keyword">if</span> any(i)
0165             newModel.metBIGGID=miriams(:,i);
0166         <span class="keyword">end</span>
0167         i=ismember(extractedMiriamNames,<span class="string">'envipath'</span>);
0168         <span class="keyword">if</span> any(i)
0169             newModel.metEnviPathID=miriams(:,i);
0170         <span class="keyword">end</span>        
0171         i=ismember(extractedMiriamNames,<span class="string">'hmdb'</span>);
0172         <span class="keyword">if</span> any(i)
0173             newModel.metHMDBID=miriams(:,i);
0174         <span class="keyword">end</span>
0175         i=ismember(extractedMiriamNames,<span class="string">'lipidmaps'</span>);
0176         <span class="keyword">if</span> any(i)
0177             newModel.metLIPIDMAPSID=miriams(:,i);
0178         <span class="keyword">end</span>
0179         i=ismember(extractedMiriamNames,<span class="string">'metacyc.compound'</span>);
0180         <span class="keyword">if</span> any(i)
0181             newModel.metMetaCycID=miriams(:,i);
0182         <span class="keyword">end</span>
0183         i=ismember(extractedMiriamNames,<span class="string">'reactome.metabolite'</span>);
0184         <span class="keyword">if</span> any(i)
0185             newModel.metREACTOMEID=miriams(:,i);
0186         <span class="keyword">end</span>   
0187         i=ismember(extractedMiriamNames,<span class="string">'sabiork.metabolite'</span>);
0188         <span class="keyword">if</span> any(i)
0189             newModel.metSABIORKID=miriams(:,i);
0190         <span class="keyword">end</span>
0191         i=ismember(extractedMiriamNames,<span class="string">'seed.compound'</span>);
0192         <span class="keyword">if</span> any(i)
0193             newModel.metSEEDID=miriams(:,i);
0194         <span class="keyword">end</span>
0195         i=ismember(extractedMiriamNames,<span class="string">'slm'</span>);
0196         <span class="keyword">if</span> any(i)
0197             newModel.metSLMID=miriams(:,i);
0198         <span class="keyword">end</span>
0199         i=ismember(extractedMiriamNames,<span class="string">'metanetx.chemical'</span>);
0200         <span class="keyword">if</span> any(i)
0201             newModel.metMetaNetXID=miriams(:,i);
0202         <span class="keyword">end</span>
0203         i=ismember(extractedMiriamNames,<span class="string">'sbo'</span>);
0204         <span class="keyword">if</span> any(i)
0205             newModel.metSBOTerms=miriams(:,i);
0206         <span class="keyword">end</span>
0207     <span class="keyword">end</span>
0208     <span class="keyword">if</span> isfield(model,<span class="string">'inchis'</span>)
0209         newModel.metInChIString=regexprep(strcat(<span class="string">'InChI='</span>, model.inchis),<span class="string">'^InChI=$'</span>,<span class="string">''</span>);
0210     <span class="keyword">end</span>
0211     <span class="keyword">if</span> isfield(model,<span class="string">'genes'</span>)
0212         newModel.genes=model.genes;
0213         newModel.rules=<a href="#_sub1" class="code" title="subfunction rules=grrulesToRules(model)">grrulesToRules</a>(model);
0214     <span class="keyword">else</span>
0215         fprintf(<span class="string">'WARNING: no genes detected. The model therefore may not be exportable to SBML file with writeCbModel\n'</span>);
0216     <span class="keyword">end</span>
0217     <span class="keyword">if</span> isfield(model,<span class="string">'comps'</span>)
0218         newModel.comps=model.comps;
0219     <span class="keyword">end</span>
0220     <span class="keyword">if</span> isfield(model,<span class="string">'compNames'</span>)
0221         newModel.compNames=model.compNames;
0222     <span class="keyword">end</span>
0223     <span class="keyword">if</span> isfield(model,<span class="string">'metCharges'</span>)
0224         newModel.metCharges=model.metCharges;
0225     <span class="keyword">end</span>
0226     newModel.b=zeros(numel(model.mets),1);
0227     newModel.csense=repmat(<span class="string">'E'</span>,size(model.mets));
0228     <span class="keyword">if</span> isfield(model,<span class="string">'geneMiriams'</span>)
0229        [miriams,extractedMiriamNames]=<a href="extractMiriam.html" class="code" title="function [miriams,extractedMiriamNames]=extractMiriam(modelMiriams,miriamNames)">extractMiriam</a>(model.geneMiriams);
0230         miriams=regexprep(miriams,<span class="string">'^[A-Za-z\.]*\/'</span>,<span class="string">''</span>);
0231         i=ismember(extractedMiriamNames,<span class="string">'kegg.genes'</span>);
0232         <span class="keyword">if</span> any(i)
0233             newModel.geneiskegg__46__genesID=miriams(:,i);
0234         <span class="keyword">end</span>
0235         i=ismember(extractedMiriamNames,<span class="string">'kegg.genes'</span>);
0236         <span class="keyword">if</span> any(i)
0237             newModel.geneiskegg__46__genesID=miriams(:,i);
0238         <span class="keyword">end</span>
0239         i=ismember(extractedMiriamNames,<span class="string">'sgd'</span>);
0240         <span class="keyword">if</span> any(i)
0241             newModel.geneissgdID=miriams(:,i);
0242         <span class="keyword">end</span>      
0243         i=ismember(extractedMiriamNames,<span class="string">'uniprot'</span>);
0244         <span class="keyword">if</span> any(i)
0245             newModel.proteinisuniprotID=miriams(:,i);
0246         <span class="keyword">end</span>      
0247     <span class="keyword">end</span>
0248     <span class="keyword">if</span> isfield(model,<span class="string">'geneShortNames'</span>)
0249         newModel.geneNames=model.geneShortNames;
0250     <span class="keyword">end</span>
0251     <span class="keyword">if</span> isfield(model,<span class="string">'rxnConfidenceScores'</span>)
0252         newModel.rxnConfidenceScores=model.rxnConfidenceScores;
0253     <span class="keyword">end</span>
0254     <span class="keyword">if</span> isfield(model,<span class="string">'genes'</span>)
0255         newModel.rules=<a href="#_sub1" class="code" title="subfunction rules=grrulesToRules(model)">grrulesToRules</a>(model);
0256     <span class="keyword">end</span>
0257     newModel.osenseStr=<span class="string">'max'</span>;
0258     
0259     <span class="comment">%It seems that grRules, rxnGeneMat and rev are disposable fields in</span>
0260     <span class="comment">%COBRA version, but we export them to make things faster, when</span>
0261     <span class="comment">%converting COBRA structure back to RAVEN</span>
0262     <span class="keyword">if</span> isfield(model,<span class="string">'rxnGeneMat'</span>)
0263         newModel.rxnGeneMat=model.rxnGeneMat;
0264     <span class="keyword">end</span>
0265     <span class="keyword">if</span> isfield(model,<span class="string">'grRules'</span>)
0266         [grRules, rxnGeneMat] = standardizeGrRules(model,true);
0267         newModel.grRules      = grRules;
0268         <span class="comment">%Incorporate a rxnGeneMat consistent with standardized grRules</span>
0269         newModel.rxnGeneMat   = rxnGeneMat;
0270     <span class="keyword">end</span>
0271     newModel.rev=model.rev;
0272 <span class="keyword">else</span>
0273     fprintf(<span class="string">'Converting COBRA structure to RAVEN..\n'</span>);
0274     <span class="comment">%Convert from COBRA to RAVEN structure</span>
0275     
0276     <span class="comment">%Mandatory RAVEN fields</span>
0277     newModel.rxns=model.rxns;
0278     newModel.mets=model.mets;
0279     <span class="keyword">if</span> ~isfield(model,<span class="string">'comps'</span>)
0280         model.comps = unique(regexprep(model.mets,<span class="string">'.*\[([^\]]+)\]$'</span>,<span class="string">'$1'</span>));
0281     <span class="keyword">end</span>
0282 
0283     <span class="keyword">for</span> i=1:numel(model.comps)
0284         newModel.mets=regexprep(newModel.mets,[<span class="string">'\['</span>, model.comps{i}, <span class="string">'\]$'</span>],<span class="string">''</span>);
0285         newModel.mets=regexprep(newModel.mets,[<span class="string">'\['</span>, model.compNames{i}, <span class="string">'\]$'</span>],<span class="string">''</span>);
0286     <span class="keyword">end</span>
0287     
0288     <span class="comment">%In some rare cases, there may be overlapping mets due to removal e.g.</span>
0289     <span class="comment">%[c]. To avoid this, we change e.g. [c] into _c</span>
0290     <span class="keyword">if</span> numel(unique(newModel.mets))~=numel(model.mets)
0291         newModel.mets=model.mets;
0292         <span class="keyword">for</span> i=1:numel(model.comps)
0293             newModel.mets=regexprep(newModel.mets,<span class="string">'\]$'</span>,<span class="string">''</span>);
0294             newModel.mets=regexprep(newModel.mets,[<span class="string">'\['</span>, model.comps{i}, <span class="string">'$'</span>],[<span class="string">'_'</span>, model.comps{i}]);
0295         <span class="keyword">end</span>
0296     <span class="keyword">end</span>
0297     
0298     newModel.S=model.S;
0299     newModel.lb=model.lb;
0300     newModel.ub=model.ub;
0301     <span class="comment">%Since COBRA no longer contains rev field it is assumed that rxn is</span>
0302     <span class="comment">%reversible if its lower bound is set to zero</span>
0303     <span class="keyword">if</span> ~isfield(model,<span class="string">'rev'</span>)
0304         <span class="keyword">for</span> i=1:numel(model.rxns)
0305             <span class="keyword">if</span> model.lb(i)&lt;0
0306                 newModel.rev(i,1)=1;
0307             <span class="keyword">else</span>
0308                 newModel.rev(i,1)=0;
0309             <span class="keyword">end</span>
0310         <span class="keyword">end</span>
0311     <span class="keyword">else</span>
0312         newModel.rev=model.rev;
0313     <span class="keyword">end</span>
0314     newModel.c=model.c;
0315     newModel.b=zeros(numel(model.mets),1);
0316     <span class="keyword">if</span> isfield(model,<span class="string">'comps'</span>)
0317         newModel.comps=model.comps;
0318     <span class="keyword">else</span>
0319         <span class="comment">%Since 'comps' field is not mandatory in COBRA, it may be required</span>
0320         <span class="comment">%to obtain the non-redundant list of comps from metabolite ids, if</span>
0321         <span class="comment">%'comps' field is not available</span>
0322         newModel.comps=regexprep(model.mets,<span class="string">'^.+\['</span>,<span class="string">''</span>);
0323         newModel.comps=regexprep(newModel.comps,<span class="string">'\]$'</span>,<span class="string">''</span>);
0324         newModel.comps=unique(newModel.comps);
0325     <span class="keyword">end</span>
0326     
0327     <span class="comment">%metComps is also mandatory, but defined later to match the order of</span>
0328     <span class="comment">%fields</span>
0329     
0330     <span class="comment">%Fields 'description' and 'id' are also considered as mandatory, but</span>
0331     <span class="comment">%these are added to the model during exportModel/exportToExcelFormat</span>
0332     <span class="comment">%anyway, so there is no point to add this information here</span>
0333     
0334     <span class="comment">%Optional RAVEN fields</span>
0335     <span class="keyword">if</span> isfield(model,<span class="string">'modelID'</span>)
0336         newModel.id=model.modelID;
0337     <span class="keyword">end</span>
0338     <span class="keyword">if</span> isfield(model,<span class="string">'modelName'</span>)
0339         newModel.description=model.modelName;
0340     <span class="keyword">end</span>
0341     <span class="keyword">if</span> isfield(model,<span class="string">'compNames'</span>)
0342         newModel.compNames=model.compNames;
0343     <span class="keyword">end</span>
0344     <span class="keyword">if</span> isfield(model,<span class="string">'rxnNames'</span>)
0345         newModel.rxnNames=model.rxnNames;
0346     <span class="keyword">end</span>
0347     <span class="keyword">if</span> isfield(model,<span class="string">'grRules'</span>)
0348         [grRules,rxnGeneMat] = standardizeGrRules(model,true);
0349         newModel.grRules     = grRules;
0350         newModel.rxnGeneMat  = rxnGeneMat;
0351     <span class="keyword">else</span>
0352         model.grRules        = <a href="#_sub2" class="code" title="subfunction grRules=rulesTogrrules(model)">rulesTogrrules</a>(model);
0353         [grRules,rxnGeneMat] = standardizeGrRules(model,true);
0354         newModel.grRules     = grRules;
0355         newModel.rxnGeneMat  = rxnGeneMat;
0356     <span class="keyword">end</span>
0357     <span class="keyword">if</span> isfield(model,<span class="string">'subSystems'</span>)
0358         newModel.subSystems=model.subSystems;
0359     <span class="keyword">end</span>
0360     <span class="keyword">if</span> isfield(model,<span class="string">'rxnECNumbers'</span>)
0361         newModel.eccodes=regexprep(model.rxnECNumbers,<span class="string">'EC|EC:'</span>,<span class="string">''</span>);
0362     <span class="keyword">end</span>
0363     <span class="keyword">if</span> any(isfield(model,{<span class="string">'rxnBIGGID'</span>,<span class="string">'rxnKEGGID'</span>,<span class="string">'rxnMetaCycID'</span>,<span class="string">'rxnMetaNetXID'</span>,<span class="keyword">...</span>
0364             <span class="string">'rxnReferences'</span>,<span class="string">'rxnREACTOMEID'</span>,<span class="string">'rxnRheaID'</span>,<span class="string">'rxnSABIORKID'</span>,<span class="keyword">...</span>
0365             <span class="string">'rxnSBOTerms'</span>,<span class="string">'rxnSEEDID'</span>}))
0366         <span class="keyword">for</span> i=1:numel(model.rxns)
0367             counter=1;
0368             newModel.rxnMiriams{i,1}=[];
0369             <span class="keyword">if</span> isfield(model,<span class="string">'rxnBIGGID'</span>)
0370                 <span class="keyword">if</span> ~isempty(model.rxnBIGGID{i})
0371                     newModel.rxnMiriams{i,1}.name{counter,1} = <span class="string">'bigg.reaction'</span>;
0372                     newModel.rxnMiriams{i,1}.value{counter,1} = model.rxnBIGGID{i};
0373                     counter=counter+1;
0374                 <span class="keyword">end</span>
0375             <span class="keyword">end</span>
0376             <span class="keyword">if</span> isfield(model,<span class="string">'rxnKEGGID'</span>)
0377                 <span class="keyword">if</span> ~isempty(model.rxnKEGGID{i})
0378                     newModel.rxnMiriams{i,1}.name{counter,1} = <span class="string">'kegg.reaction'</span>;
0379                     newModel.rxnMiriams{i,1}.value{counter,1} = model.rxnKEGGID{i};
0380                     counter=counter+1;
0381                 <span class="keyword">end</span>
0382             <span class="keyword">end</span>
0383             <span class="keyword">if</span> isfield(model,<span class="string">'rxnMetaCycID'</span>)
0384                 <span class="keyword">if</span> ~isempty(model.rxnMetaCycID{i})
0385                     newModel.rxnMiriams{i,1}.name{counter,1} = <span class="string">'metacyc.reaction'</span>;
0386                     newModel.rxnMiriams{i,1}.value{counter,1} = model.rxnMetaCycID{i};
0387                     counter=counter+1;
0388                 <span class="keyword">end</span>
0389             <span class="keyword">end</span>
0390             <span class="keyword">if</span> isfield(model,<span class="string">'rxnMetaNetXID'</span>)
0391                 <span class="keyword">if</span> ~isempty(model.rxnMetaNetXID{i})
0392                     newModel.rxnMiriams{i,1}.name{counter,1} = <span class="string">'metanetx.reaction'</span>;
0393                     newModel.rxnMiriams{i,1}.value{counter,1} = model.rxnMetaNetXID{i};
0394                     counter=counter+1;
0395                 <span class="keyword">end</span>
0396             <span class="keyword">end</span>
0397             <span class="keyword">if</span> isfield(model,<span class="string">'rxnReferences'</span>)
0398                 <span class="keyword">if</span> ~isempty(model.rxnReferences{i})
0399                     pmids = model.rxnReferences{i};
0400                     pmids = strsplit(pmids,<span class="string">'; '</span>);
0401                     <span class="keyword">for</span> j = 1:length(pmids)
0402                         newModel.rxnMiriams{i,1}.name{counter,1} = <span class="string">'pmid'</span>;
0403                         newModel.rxnMiriams{i,1}.value{counter,1} = pmids{j};
0404                         counter=counter+1;
0405                     <span class="keyword">end</span>
0406                 <span class="keyword">end</span>
0407             <span class="keyword">end</span>
0408             <span class="keyword">if</span> isfield(model,<span class="string">'rxnREACTOMEID'</span>)
0409                 <span class="keyword">if</span> ~isempty(model.rxnREACTOMEID{i})
0410                     newModel.rxnMiriams{i,1}.name{counter,1} = <span class="string">'reactome'</span>;
0411                     newModel.rxnMiriams{i,1}.value{counter,1} = model.rxnREACTOMEID{i};
0412                     counter=counter+1;
0413                 <span class="keyword">end</span>
0414             <span class="keyword">end</span>
0415             <span class="keyword">if</span> isfield(model,<span class="string">'rxnRheaID'</span>)
0416                 <span class="keyword">if</span> ~isempty(model.rxnRheaID{i})
0417                     newModel.rxnMiriams{i,1}.name{counter,1} = <span class="string">'rhea'</span>;
0418                     newModel.rxnMiriams{i,1}.value{counter,1} = model.rxnRheaID{i};
0419                     counter=counter+1;
0420                 <span class="keyword">end</span>
0421             <span class="keyword">end</span>
0422             <span class="keyword">if</span> isfield(model,<span class="string">'rxnSABIORKID'</span>)
0423                 <span class="keyword">if</span> ~isempty(model.rxnSABIORKID{i})
0424                     newModel.rxnMiriams{i,1}.name{counter,1} = <span class="string">'sabiork.reaction'</span>;
0425                     newModel.rxnMiriams{i,1}.value{counter,1} = model.rxnSABIORKID{i};
0426                     counter=counter+1;
0427                 <span class="keyword">end</span>
0428             <span class="keyword">end</span>
0429             <span class="keyword">if</span> isfield(model,<span class="string">'rxnSBOTerms'</span>)
0430                 <span class="keyword">if</span> ~isempty(model.rxnSBOTerms{i})
0431                     newModel.rxnMiriams{i,1}.name{counter,1} = <span class="string">'sbo'</span>;
0432                     newModel.rxnMiriams{i,1}.value{counter,1} = model.rxnSBOTerms{i};
0433                     counter=counter+1;
0434                 <span class="keyword">end</span>
0435             <span class="keyword">end</span>
0436             <span class="keyword">if</span> isfield(model,<span class="string">'rxnSEEDID'</span>)
0437                 <span class="keyword">if</span> ~isempty(model.rxnSEEDID{i})
0438                     newModel.rxnMiriams{i,1}.name{counter,1} = <span class="string">'seed.reaction'</span>;
0439                     <span class="comment">%non-official identifiers.org namespace, 'seed'</span>
0440                     <span class="comment">%namespace refers to subsystems</span>
0441                     newModel.rxnMiriams{i,1}.value{counter,1} = model.rxnSEEDID{i};
0442                     counter=counter+1;
0443                 <span class="keyword">end</span>
0444             <span class="keyword">end</span>
0445         <span class="keyword">end</span>
0446     <span class="keyword">end</span>
0447     <span class="keyword">if</span> isfield(model,<span class="string">'rxnReferences'</span>)
0448         <span class="comment">%if a rxnReferences field is all numeric, it's a pubmedID, and then</span>
0449         <span class="comment">%it's already in rxnMiriams</span>
0450         <span class="comment">%implement regexp if we want to filter those out</span>
0451         newModel.rxnReferences=model.rxnReferences;
0452     <span class="keyword">end</span>
0453     <span class="keyword">if</span> isfield(model,<span class="string">'rxnConfidenceScores'</span>)
0454         newModel.rxnConfidenceScores=model.rxnConfidenceScores;
0455     <span class="keyword">end</span>
0456     <span class="keyword">if</span> isfield(model,<span class="string">'genes'</span>)
0457         newModel.genes=model.genes;
0458     <span class="keyword">end</span>
0459     <span class="keyword">if</span> isfield(model,<span class="string">'geneiskegg__46__genesID'</span>) || isfield(model,<span class="string">'geneissgdID'</span>) || isfield(model,<span class="string">'proteinisuniprotID'</span>)
0460         <span class="keyword">for</span> i=1:numel(model.genes)
0461             counter=1;
0462             newModel.geneMiriams{i,1}=[];
0463             <span class="keyword">if</span> isfield(model,<span class="string">'geneiskegg__46__genesID'</span>)
0464                 <span class="keyword">if</span> ~isempty(model.geneiskegg__46__genesID{i})
0465                     newModel.geneMiriams{i,1}.name{counter,1} = <span class="string">'kegg.genes'</span>;
0466                     newModel.geneMiriams{i,1}.value{counter,1} = model.geneiskegg__46__genesID{i};
0467                     counter=counter+1;
0468                 <span class="keyword">end</span>
0469             <span class="keyword">end</span>
0470             <span class="keyword">if</span> isfield(model,<span class="string">'geneissgdID'</span>)
0471                 <span class="keyword">if</span> ~isempty(model.geneissgdID{i})
0472                     newModel.geneMiriams{i,1}.name{counter,1} = <span class="string">'sgd'</span>;
0473                     newModel.geneMiriams{i,1}.value{counter,1} = model.geneissgdID{i};
0474                     counter=counter+1;
0475                 <span class="keyword">end</span>
0476             <span class="keyword">end</span>
0477             <span class="keyword">if</span> isfield(model,<span class="string">'proteinisuniprotID'</span>)
0478                 <span class="keyword">if</span> ~isempty(model.proteinisuniprotID{i})
0479                     newModel.geneMiriams{i,1}.name{counter,1} = <span class="string">'uniprot'</span>;
0480                     newModel.geneMiriams{i,1}.value{counter,1} = model.proteinisuniprotID{i};
0481                     counter=counter+1;
0482                 <span class="keyword">end</span>
0483             <span class="keyword">end</span>
0484         <span class="keyword">end</span>
0485     <span class="keyword">end</span>
0486     <span class="keyword">if</span> isfield(model,<span class="string">'geneNames'</span>)
0487         newModel.geneShortNames=model.geneNames;
0488     <span class="keyword">end</span>
0489     newModel.metNames=model.metNames;
0490     <span class="keyword">for</span> i=1:numel(model.comps)
0491         newModel.metNames=regexprep(newModel.metNames,[<span class="string">'\['</span>, model.comps{i}, <span class="string">'\]$'</span>],<span class="string">''</span>);
0492         newModel.metNames=regexprep(newModel.metNames,[<span class="string">'\['</span>, model.compNames{i}, <span class="string">'\]$'</span>],<span class="string">''</span>);
0493     <span class="keyword">end</span>
0494     newModel.metNames=deblank(newModel.metNames);
0495     newModel.metComps=regexprep(model.mets,<span class="string">'^.+\['</span>,<span class="string">''</span>);
0496     newModel.metComps=regexprep(newModel.metComps,<span class="string">'\]$'</span>,<span class="string">''</span>);
0497     [~, newModel.metComps]=ismember(newModel.metComps,newModel.comps);
0498     <span class="keyword">if</span> isfield(model,<span class="string">'metInChIString'</span>)
0499         newModel.inchis=regexprep(model.metInChIString,<span class="string">'^InChI='</span>,<span class="string">''</span>);
0500     <span class="keyword">end</span>
0501     printWarning=false;
0502     <span class="keyword">if</span> isfield(model,<span class="string">'metFormulas'</span>)
0503         newModel.metFormulas=model.metFormulas;
0504     <span class="keyword">end</span>
0505     <span class="keyword">if</span> any(isfield(model,{<span class="string">'metBIGGID'</span>,<span class="string">'metChEBIID'</span>,<span class="string">'metEnviPathID'</span>,<span class="string">'metHMDBID'</span>,<span class="keyword">...</span>
0506             <span class="string">'metKEGGID'</span>,<span class="string">'metLIPIDMAPSID'</span>,<span class="string">'metMetaCycID'</span>,<span class="string">'metMetaNetXID'</span>,<span class="keyword">...</span>
0507             <span class="string">'metPubChemID'</span>,<span class="string">'metREACTOMEID'</span>,<span class="string">'metSABIORKID'</span>,<span class="string">'metSBOTerms'</span>,<span class="keyword">...</span>
0508             <span class="string">'metSEEDID'</span>,<span class="string">'metSLMID'</span>}))
0509         <span class="keyword">for</span> i=1:numel(model.mets)
0510             counter=1;
0511             newModel.metMiriams{i,1}=[];
0512             <span class="keyword">if</span> isfield(model,<span class="string">'metBiGGID'</span>)
0513                 <span class="keyword">if</span> ~isempty(model.metBiGGID{i})
0514                     newModel.metMiriams{i,1}.name{counter,1} = <span class="string">'bigg.metabolite'</span>;
0515                     newModel.metMiriams{i,1}.value{counter,1} = model.metBiGGID{i};
0516                     counter=counter+1;
0517                 <span class="keyword">end</span>
0518             <span class="keyword">end</span>
0519             <span class="keyword">if</span> isfield(model,<span class="string">'metChEBIID'</span>)
0520                 <span class="keyword">if</span> ~isempty(model.metChEBIID{i})
0521                     newModel.metMiriams{i,1}.name{counter,1} = <span class="string">'chebi'</span>;
0522                     newModel.metMiriams{i,1}.value{counter,1} = model.metChEBIID{i};
0523                     counter=counter+1;
0524                 <span class="keyword">end</span>
0525             <span class="keyword">end</span>
0526             <span class="keyword">if</span> isfield(model,<span class="string">'metEnviPathID'</span>)
0527                 <span class="keyword">if</span> ~isempty(model.metChEBIID{i})
0528                     newModel.metMiriams{i,1}.name{counter,1} = <span class="string">'envipath'</span>;<span class="comment">%not in identifiers.org</span>
0529                     newModel.metMiriams{i,1}.value{counter,1} = model.metEnviPathID{i};
0530                     counter=counter+1;
0531                 <span class="keyword">end</span>
0532             <span class="keyword">end</span>
0533             <span class="keyword">if</span> isfield(model,<span class="string">'metHMDBID'</span>)
0534                 <span class="keyword">if</span> ~isempty(model.metHMDBID{i})
0535                     newModel.metMiriams{i,1}.name{counter,1} = <span class="string">'hmdb'</span>;
0536                     newModel.metMiriams{i,1}.value{counter,1} = model.metHMDBID{i};
0537                     counter=counter+1;
0538                 <span class="keyword">end</span>
0539             <span class="keyword">end</span>
0540             <span class="keyword">if</span> isfield(model,<span class="string">'metKEGGID'</span>)
0541                 <span class="keyword">if</span> ~isempty(model.metKEGGID{i})
0542                     <span class="keyword">if</span> strcmp(model.metKEGGID{i}(1),<span class="string">'C'</span>)
0543                         newModel.metMiriams{i,1}.name{counter,1} = <span class="string">'kegg.compound'</span>;
0544                         newModel.metMiriams{i,1}.value{counter,1} = model.metKEGGID{i};
0545                         counter=counter+1;
0546                     <span class="keyword">elseif</span> strcmp(model.metKEGGID{i}(1),<span class="string">'G'</span>)
0547                         newModel.metMiriams{i,1}.name{counter,1} = <span class="string">'kegg.glycan'</span>;
0548                         newModel.metMiriams{i,1}.value{counter,1} = model.metKEGGID{i};
0549                         counter=counter+1;
0550                     <span class="keyword">end</span>
0551                 <span class="keyword">end</span>
0552             <span class="keyword">end</span>
0553             <span class="keyword">if</span> isfield(model,<span class="string">'metLIPIDMAPSID'</span>)
0554                 <span class="keyword">if</span> ~isempty(model.metLIPIDMAPSID{i})
0555                     newModel.metMiriams{i,1}.name{counter,1} = <span class="string">'lipidmaps'</span>;
0556                     newModel.metMiriams{i,1}.value{counter,1} = model.metLIPIDMAPSID{i};
0557                     counter=counter+1;
0558                 <span class="keyword">end</span>
0559             <span class="keyword">end</span>
0560             <span class="keyword">if</span> isfield(model,<span class="string">'metMetaCycID'</span>)
0561                 <span class="keyword">if</span> ~isempty(model.metMetaCycID{i})
0562                     newModel.metMiriams{i,1}.name{counter,1} = <span class="string">'metacyc.compound'</span>;
0563                     newModel.metMiriams{i,1}.value{counter,1} = model.metMetaCycID{i};
0564                     counter=counter+1;
0565                 <span class="keyword">end</span>
0566             <span class="keyword">end</span>
0567             <span class="keyword">if</span> isfield(model,<span class="string">'metMetaNetXID'</span>)
0568                 <span class="keyword">if</span> ~isempty(model.metMetaNetXID{i})
0569                     newModel.metMiriams{i,1}.name{counter,1} = <span class="string">'metanetx.chemical'</span>;
0570                     newModel.metMiriams{i,1}.value{counter,1} = model.metMetaNetXID{i};
0571                     counter=counter+1;
0572                 <span class="keyword">end</span>
0573             <span class="keyword">end</span>
0574             <span class="keyword">if</span> isfield(model,<span class="string">'metPubChemID'</span>)
0575                 <span class="keyword">if</span> ~isempty(model.metPubChemID{i})
0576                     <span class="keyword">if</span> length(model.metPubChemID{i})&gt;3 &amp;&amp; strcmp(model.metPubChemID{i}(1:4),<span class="string">'CID:'</span>)
0577                         newModel.metMiriams{i,1}.name{counter,1} = <span class="string">'pubchem.compound'</span>;
0578                         newModel.metMiriams{i,1}.value{counter,1} = model.metPubChemID{i};
0579                         counter=counter+1;
0580                     <span class="keyword">elseif</span> length(model.metPubChemID{i})&gt;3 &amp;&amp; strcmp(model.metPubChemID{i}(1:4),<span class="string">'SID:'</span>)
0581                         newModel.metMiriams{i,1}.name{counter,1} = <span class="string">'pubchem.substance'</span>;
0582                         newModel.metMiriams{i,1}.value{counter,1} = model.metPubChemID{i};
0583                         counter=counter+1;
0584                     <span class="keyword">else</span>
0585                         newModel.metMiriams{i,1}.name{counter,1} = <span class="string">'pubchem.compound'</span>;
0586                         newModel.metMiriams{i,1}.value{counter,1} = model.metPubChemID{i};
0587                         counter=counter+1;
0588                         printWarning=true;
0589                     <span class="keyword">end</span>
0590                 <span class="keyword">end</span>
0591             <span class="keyword">end</span>
0592             <span class="keyword">if</span> isfield(model,<span class="string">'metREACTOMEID'</span>)
0593                 <span class="keyword">if</span> ~isempty(model.metREACTOMEID{i})
0594                     newModel.metMiriams{i,1}.name{counter,1} = <span class="string">'reactome.metabolite'</span>;
0595                     <span class="comment">%non-official identifiers.org, 'reactome' namespace</span>
0596                     <span class="comment">%refers to reactions</span>
0597                     newModel.metMiriams{i,1}.value{counter,1} = model.metREACTOMEID{i};
0598                     counter=counter+1;
0599                 <span class="keyword">end</span>
0600             <span class="keyword">end</span>
0601             <span class="keyword">if</span> isfield(model,<span class="string">'metSABIORKID'</span>)
0602                 <span class="keyword">if</span> ~isempty(model.metSEEDID{i})
0603                     newModel.metMiriams{i,1}.name{counter,1} = <span class="string">'sabiork.metabolite'</span>;
0604                     <span class="comment">%non-official identifiers.org namespace,</span>
0605                     <span class="comment">%'sabiork.reaction' refers to reactions</span>
0606                     newModel.metMiriams{i,1}.value{counter,1} = model.metSABIORKID{i};
0607                     counter=counter+1;
0608                 <span class="keyword">end</span>
0609             <span class="keyword">end</span>
0610             <span class="keyword">if</span> isfield(model,<span class="string">'metSBOTerms'</span>)
0611                 <span class="keyword">if</span> ~isempty(model.metSBOTerms{i})
0612                     newModel.metMiriams{i,1}.name{counter,1} = <span class="string">'sbo'</span>;
0613                     newModel.metMiriams{i,1}.value{counter,1} = model.metSBOTerms{i};
0614                     counter=counter+1;
0615                 <span class="keyword">end</span>
0616             <span class="keyword">end</span>
0617             <span class="keyword">if</span> isfield(model,<span class="string">'metSEEDID'</span>)
0618                 <span class="keyword">if</span> ~isempty(model.metSEEDID{i})
0619                     newModel.metMiriams{i,1}.name{counter,1} = <span class="string">'seed.compound'</span>;
0620                     newModel.metMiriams{i,1}.value{counter,1} = model.metSEEDID{i};
0621                     counter=counter+1;
0622                 <span class="keyword">end</span>
0623             <span class="keyword">end</span>
0624             <span class="keyword">if</span> isfield(model,<span class="string">'metSLMID'</span>)
0625                 <span class="keyword">if</span> ~isempty(model.metSLMID{i})
0626                     newModel.metMiriams{i,1}.name{counter,1} = <span class="string">'swisslipid'</span>;
0627                     newModel.metMiriams{i,1}.value{counter,1} = model.metSLMID{i};
0628                     counter=counter+1;
0629                 <span class="keyword">end</span>
0630             <span class="keyword">end</span>
0631         <span class="keyword">end</span>
0632     <span class="keyword">end</span>
0633     <span class="keyword">if</span> printWarning
0634         fprintf(<span class="string">'Could not determine whether PubChemIDs are compounds (CID)\n or substances (SID). All annotated PubChemIDs will therefore \n be assigned as compounds (CID).\n'</span>);
0635     <span class="keyword">end</span>
0636     <span class="keyword">if</span> isfield(model,<span class="string">'metCharges'</span>)
0637         newModel.metCharges=model.metCharges;
0638     <span class="keyword">end</span>
0639 <span class="keyword">end</span>
0640 <span class="keyword">end</span>
0641 
0642 <a name="_sub1" href="#_subfunctions" class="code">function rules=grrulesToRules(model)</a>
0643 <span class="comment">%This function just takes grRules, changes all gene names to</span>
0644 <span class="comment">%'x(geneNumber)' and also changes 'or' and 'and' relations to corresponding</span>
0645 <span class="comment">%symbols</span>
0646 replacingGenes=cell([size(model.genes,1) 1]);
0647 <span class="keyword">for</span> i=1:numel(replacingGenes)
0648     replacingGenes{i}=strcat(<span class="string">'x('</span>,num2str(i),<span class="string">')'</span>);
0649 <span class="keyword">end</span>
0650 rules = strcat({<span class="string">' '</span>},model.grRules,{<span class="string">' '</span>});
0651 <span class="keyword">for</span> i=1:length(model.genes)
0652     rules=regexprep(rules,[<span class="string">' '</span> model.genes{i} <span class="string">' '</span>],[<span class="string">' '</span> replacingGenes{i} <span class="string">' '</span>]);
0653     rules=regexprep(rules,[<span class="string">'('</span> model.genes{i} <span class="string">' '</span>],[<span class="string">'('</span> replacingGenes{i} <span class="string">' '</span>]);
0654     rules=regexprep(rules,[<span class="string">' '</span> model.genes{i} <span class="string">')'</span>],[<span class="string">' '</span> replacingGenes{i} <span class="string">')'</span>]);
0655 <span class="keyword">end</span>
0656 rules=regexprep(rules,<span class="string">' and '</span>,<span class="string">' &amp; '</span>);
0657 rules=regexprep(rules,<span class="string">' or '</span>,<span class="string">' | '</span>);
0658 rules=strtrim(rules);
0659 <span class="keyword">end</span>
0660 
0661 <a name="_sub2" href="#_subfunctions" class="code">function grRules=rulesTogrrules(model)</a>
0662 <span class="comment">%This function takes rules, replaces &amp;/| for and/or, replaces the x(i)</span>
0663 <span class="comment">%format with the actual gene ID, and takes out extra whitespace and</span>
0664 <span class="comment">%redundant parenthesis introduced by COBRA, to create grRules.</span>
0665 grRules = strrep(model.rules,<span class="string">'&amp;'</span>,<span class="string">'and'</span>);
0666 grRules = strrep(grRules,<span class="string">'|'</span>,<span class="string">'or'</span>);
0667 <span class="keyword">for</span> i = 1:length(model.genes)
0668     grRules = strrep(grRules,[<span class="string">'x('</span> num2str(i) <span class="string">')'</span>],model.genes{i});
0669 <span class="keyword">end</span>
0670 grRules = strrep(grRules,<span class="string">'( '</span>,<span class="string">'('</span>);
0671 grRules = strrep(grRules,<span class="string">' )'</span>,<span class="string">')'</span>);
0672 grRules = regexprep(grRules,<span class="string">'^('</span>,<span class="string">''</span>); <span class="comment">%rules that start with a &quot;(&quot;</span>
0673 grRules = regexprep(grRules,<span class="string">')$'</span>,<span class="string">''</span>); <span class="comment">%rules that end with a &quot;)&quot;</span>
0674 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Fri 12-Apr-2019 17:48:05 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of getIndexes</title>
  <meta name="keywords" content="getIndexes">
  <meta name="description" content="getIndexes">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../index.html">Home</a> &gt;  <a href="index.html">core</a> &gt; getIndexes.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../index.html"><img alt="<" border="0" src="../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for core&nbsp;<img alt=">" border="0" src="../right.png"></a></td></tr></table>-->

<h1>getIndexes
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>getIndexes</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function indexes=getIndexes(model, objects, type, returnLogical) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> getIndexes
   Retrieves the indexes for a list of reactions or metabolites

 Input:
   model           a model structure
   objects         either a cell array of IDs, a logical vector with the
                   same number of elements as metabolites in the model,
                   of a vector of indexes
   type            'rxns', 'mets', or 'genes' depending on what to retrieve
                   'metnames' queries metabolite names, while 'metcomps'
                   allows to provide specific metabolites and their
                   compartments in the format metaboliteName[comp]. If a
                   model.ec structure exists (GECKO 3), then also
                   'ecenzymes', 'ecrxns' and 'ecgenes' are allowed
   returnLogical   Sets whether to return a logical array or an array with
                   the indexes (optional, default false)

 Output:
   indexes         can be a logical array or a double array depending on
                   the value of returnLogical

 Note: If 'ecenzymes', 'ecrxns' or 'ecgenes' are used with a GECKO 3
 model, then the indexes are from the model.ec.enzymes, model.ec.rxns or
 model.ec.genes fields, respectively.
 
 Usage: indexes=getIndexes(model, objects, type, returnLogical)</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="convertCharArray.html" class="code" title="function inputConverted = convertCharArray(funcInput)">convertCharArray</a>	convertCharArray</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="addExchangeRxns.html" class="code" title="function [model, addedRxns]=addExchangeRxns(model,reactionType,mets)">addExchangeRxns</a>	addExchangeRxns</li><li><a href="changeGrRules.html" class="code" title="function model = changeGrRules(model,rxns,grRules,replace)">changeGrRules</a>	changeGrRules</li><li><a href="constructEquations.html" class="code" title="function equationStrings=constructEquations(model,rxns,useComps,sortRevRxns,sortMetNames,useMetID,useFormula,useRevField)">constructEquations</a>	constructEquations</li><li><a href="consumeSomething.html" class="code" title="function [solution, metabolite]=consumeSomething(model,ignoreMets,isNames,minNrFluxes,params,ignoreIntBounds)">consumeSomething</a>	consumeSomething</li><li><a href="contractModel.html" class="code" title="function [reducedModel, removedRxns, indexedDuplicateRxns]=contractModel(model,distReverse,mets)">contractModel</a>	contractModel</li><li><a href="convertToIrrev.html" class="code" title="function [irrevModel,matchRev,rev2irrev,irrev2rev]=convertToIrrev(model,rxns)">convertToIrrev</a>	convertToIrrev</li><li><a href="copyToComps.html" class="code" title="function model=copyToComps(model,toComps,rxns,deleteOriginal,compNames,compOutside)">copyToComps</a>	copyToComps</li><li><a href="getAllRxnsFromGenes.html" class="code" title="function allRxns=getAllRxnsFromGenes(model,rxns)">getAllRxnsFromGenes</a>	getAllRxnsFromGenes</li><li><a href="getAllowedBounds.html" class="code" title="function [minFluxes, maxFluxes, exitFlags]=getAllowedBounds(model,rxns,runParallel)">getAllowedBounds</a>	getAllowedBounds</li><li><a href="getElementalBalance.html" class="code" title="function balanceStructure=getElementalBalance(model,rxns,printUnbalanced,printUnparsable)">getElementalBalance</a>	getElementalBalance</li><li><a href="haveFlux.html" class="code" title="function I=haveFlux(model,cutOff,rxns)">haveFlux</a>	haveFlux</li><li><a href="makeSomething.html" class="code" title="function [solution, metabolite]=makeSomething(model,ignoreMets,isNames,minNrFluxes,allowExcretion,params,ignoreIntBounds)">makeSomething</a>	makeSomething</li><li><a href="printModel.html" class="code" title="function printModel(model,rxnList,outputString,outputFile,metaboliteList)">printModel</a>	printModel</li><li><a href="removeGenes.html" class="code" title="function reducedModel = removeGenes(model,genesToRemove,removeUnusedMets,removeBlockedRxns,standardizeRules)">removeGenes</a>	removeGenes</li><li><a href="removeMets.html" class="code" title="function reducedModel=removeMets(model,metsToRemove,isNames,removeUnusedRxns,removeUnusedGenes,removeUnusedComps)">removeMets</a>	removeMets</li><li><a href="removeReactions.html" class="code" title="function reducedModel=removeReactions(model,rxnsToRemove,removeUnusedMets,removeUnusedGenes,removeUnusedComps)">removeReactions</a>	removeReactions</li><li><a href="runDynamicFBA.html" class="code" title="function [concentrationMatrix, excRxnNames, timeVec, biomassVec] = runDynamicFBA(model, substrateRxns, initConcentrations, initBiomass, timeStep, nSteps, plotRxns, exclUptakeRxns)">runDynamicFBA</a>	runDynamicFBA</li><li><a href="runPhenotypePhasePlane.html" class="code" title="function [growthRates, shadowPrices1, shadowPrices2] = runPhenotypePhasePlane(model, controlRxn1, controlRxn2, nPts, range1, range2)">runPhenotypePhasePlane</a>	runPhenotypePhasePlane</li><li><a href="runRobustnessAnalysis.html" class="code" title="function [controlFlux, objFlux] = runRobustnessAnalysis(model, controlRxn, nPoints, objRxn, plotRedCost)">runRobustnessAnalysis</a>	runRobustnessAnalysis</li><li><a href="runSimpleOptKnock.html" class="code" title="function out = runSimpleOptKnock(model, targetRxn, biomassRxn, deletions, genesOrRxns, maxNumKO, minGrowth)">runSimpleOptKnock</a>	runSimpleOptKnock</li><li><a href="simplifyModel.html" class="code" title="function [reducedModel, deletedReactions, deletedMetabolites]=simplifyModel(model,deleteUnconstrained, deleteDuplicates, deleteZeroInterval, deleteInaccessible, deleteMinMax, groupLinear, constrainReversible, reservedRxns, suppressWarnings)">simplifyModel</a>	simplifyModel</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function indexes=getIndexes(model, objects, type, returnLogical)</a>
0002 <span class="comment">% getIndexes</span>
0003 <span class="comment">%   Retrieves the indexes for a list of reactions or metabolites</span>
0004 <span class="comment">%</span>
0005 <span class="comment">% Input:</span>
0006 <span class="comment">%   model           a model structure</span>
0007 <span class="comment">%   objects         either a cell array of IDs, a logical vector with the</span>
0008 <span class="comment">%                   same number of elements as metabolites in the model,</span>
0009 <span class="comment">%                   of a vector of indexes</span>
0010 <span class="comment">%   type            'rxns', 'mets', or 'genes' depending on what to retrieve</span>
0011 <span class="comment">%                   'metnames' queries metabolite names, while 'metcomps'</span>
0012 <span class="comment">%                   allows to provide specific metabolites and their</span>
0013 <span class="comment">%                   compartments in the format metaboliteName[comp]. If a</span>
0014 <span class="comment">%                   model.ec structure exists (GECKO 3), then also</span>
0015 <span class="comment">%                   'ecenzymes', 'ecrxns' and 'ecgenes' are allowed</span>
0016 <span class="comment">%   returnLogical   Sets whether to return a logical array or an array with</span>
0017 <span class="comment">%                   the indexes (optional, default false)</span>
0018 <span class="comment">%</span>
0019 <span class="comment">% Output:</span>
0020 <span class="comment">%   indexes         can be a logical array or a double array depending on</span>
0021 <span class="comment">%                   the value of returnLogical</span>
0022 <span class="comment">%</span>
0023 <span class="comment">% Note: If 'ecenzymes', 'ecrxns' or 'ecgenes' are used with a GECKO 3</span>
0024 <span class="comment">% model, then the indexes are from the model.ec.enzymes, model.ec.rxns or</span>
0025 <span class="comment">% model.ec.genes fields, respectively.</span>
0026 <span class="comment">%</span>
0027 <span class="comment">% Usage: indexes=getIndexes(model, objects, type, returnLogical)</span>
0028 
0029 <span class="keyword">if</span> nargin&lt;4
0030     returnLogical=false;
0031 <span class="keyword">end</span>
0032 
0033 <span class="keyword">if</span> ~islogical(objects) &amp;&amp; ~isnumeric(objects)
0034     objects=<a href="convertCharArray.html" class="code" title="function inputConverted = convertCharArray(funcInput)">convertCharArray</a>(objects);
0035 <span class="keyword">end</span>
0036 type=char(type);
0037 
0038 indexes=[];
0039 
0040 <span class="keyword">if</span> startsWith(type,<span class="string">'ec'</span>) &amp;&amp; ~isfield(model,<span class="string">'ec'</span>)
0041     error(<span class="string">'Type %s cannot be used if no model.ec structure is present.'</span>,type)
0042 <span class="keyword">end</span>
0043 
0044 <span class="keyword">switch</span> type
0045     <span class="keyword">case</span> <span class="string">'rxns'</span>
0046         searchIn=model.rxns;
0047     <span class="keyword">case</span> <span class="string">'mets'</span>
0048         searchIn=model.mets;
0049     <span class="keyword">case</span> <span class="string">'genes'</span>
0050         searchIn=model.genes;
0051     <span class="keyword">case</span> <span class="string">'metnames'</span>
0052         searchIn=model.metNames;
0053     <span class="keyword">case</span> <span class="string">'metcomps'</span>
0054         <span class="comment">% If provided as metaboliteName[comp], then index search is quite</span>
0055         <span class="comment">% different from general approach, and therefore coded separately.</span>
0056         mets=regexprep(objects,<span class="string">'(^.+)\[(.+)\]$'</span>,<span class="string">'$1'</span>);
0057         comps=regexprep(objects,<span class="string">'(^.+)\[(.+)\]$'</span>,<span class="string">'$2'</span>);
0058         indexes=zeros(1,numel(objects));
0059         <span class="keyword">for</span> i=1:numel(objects)
0060             index=find(strcmp(mets(i),model.metNames));
0061             index=index(strcmp(comps(i),model.comps(model.metComps(index))));
0062             <span class="keyword">if</span> ~isempty(index)
0063                 indexes(i)=index;
0064             <span class="keyword">else</span>
0065                 error([<span class="string">'Could not find object '</span> objects{i} <span class="string">' in the model'</span>]);
0066             <span class="keyword">end</span>
0067         <span class="keyword">end</span>
0068         indexes=indexes(:);
0069         <span class="keyword">if</span> returnLogical==true
0070             tempIndexes=false(numel(model.mets),1);
0071             tempIndexes(indexes)=true;
0072             indexes=tempIndexes;
0073         <span class="keyword">end</span>
0074         <span class="keyword">return</span> <span class="comment">%None of the remaining function needs to run if metcomps</span>
0075     <span class="keyword">case</span> <span class="string">'ecrxns'</span>
0076         searchIn=model.ec.rxns;
0077     <span class="keyword">case</span> <span class="string">'ecenzymes'</span>
0078         searchIn=model.ec.enzymes;
0079     <span class="keyword">case</span> <span class="string">'ecgenes'</span>
0080         searchIn=model.ec.genes;
0081     <span class="keyword">otherwise</span>
0082         <span class="keyword">if</span> contains(objects,{<span class="string">'rxns'</span>,<span class="string">'mets'</span>,<span class="string">'metnames'</span>,<span class="string">'metcomps'</span>,<span class="string">'genes'</span>,<span class="string">'ecgenes'</span>,<span class="string">'ecenzymes'</span>,<span class="string">'ecrxns'</span>})
0083             error(<span class="string">'The second and third parameter provided to run getIndexes are likely switched. Note that the second parameter is the object to find the index for, while the third parameter is the object type (''rxns'', ''mets'', ''metnames'', ''metcomps'', ''genes'', ''ecgenes'', ''ecenzymes'' or ''ecrxns'').'</span>)
0084         <span class="keyword">else</span>
0085             error(<span class="string">'Incorrect value of the ''type'' parameter. Allowed values are ''rxns'', ''mets'', ''metnames'', ''metcomps'', ''genes'', ''ecgenes'', ''ecenzymes'' or ''ecrxns''.'</span>);
0086        <span class="keyword">end</span>
0087 <span class="keyword">end</span>
0088 
0089 <span class="keyword">if</span> iscell(objects)
0090     <span class="keyword">for</span> i=1:numel(objects)
0091         index=find(strcmp(objects(i),searchIn));
0092         <span class="keyword">if</span> strcmpi(type,<span class="string">'metnames'</span>)
0093             indexes{i}=index;
0094         <span class="keyword">elseif</span> ~isempty(index)
0095             <span class="keyword">if</span> length(index) &gt; 1
0096                 error(<span class="string">'There are multiple instances of object &quot;%s&quot; in the model, while &quot;%s&quot; type should be unique'</span>, objects{i}, type)
0097             <span class="keyword">end</span>
0098             indexes(i)=index;
0099         <span class="keyword">else</span>
0100             error([<span class="string">'Could not find object '''</span> objects{i} <span class="string">''' in the model'</span>]);
0101         <span class="keyword">end</span>
0102     <span class="keyword">end</span>
0103 <span class="keyword">else</span>
0104     <span class="comment">%Now it's either a logical (or 0/1) array or an array with indexes. We</span>
0105     <span class="comment">%want it to be an array with indexes.</span>
0106     <span class="keyword">if</span> all(objects)
0107         <span class="comment">%This gets weird if it's all 1</span>
0108         indexes=objects;
0109     <span class="keyword">else</span>
0110         indexes=find(objects);
0111     <span class="keyword">end</span>
0112 <span class="keyword">end</span>
0113 
0114 <span class="keyword">if</span> returnLogical==true
0115     tempIndexes=false(numel(searchIn),1);
0116     tempIndexes(indexes)=true;
0117     indexes=tempIndexes;
0118 <span class="keyword">end</span>
0119 
0120 indexes=indexes(:);
0121 <span class="keyword">if</span> iscell(indexes) &amp;&amp; length(indexes)==1
0122     indexes=indexes{1};
0123 <span class="keyword">end</span>
0124 <span class="keyword">end</span></pre></div>
<hr><address>Generated by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of setParam</title>
  <meta name="keywords" content="setParam">
  <meta name="description" content="setParam">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../index.html">Home</a> &gt;  <a href="index.html">core</a> &gt; setParam.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../index.html"><img alt="<" border="0" src="../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for core&nbsp;<img alt=">" border="0" src="../right.png"></a></td></tr></table>-->

<h1>setParam
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>setParam</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function model=setParam(model, paramType, rxnList, params, var) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> setParam
   Sets parameters for reactions

   model       a model structure
   paramType   the type of parameter to set:
               'lb'    Lower bound
               'ub'    Upper bound
               'eq'    Both upper and lower bound (equality constraint)
               'obj'   Objective coefficient
               'rev'   Reversibility (only changes the model.rev fields,
                       does not affect model.lb and model.ub) 
               'var'   Variance around measured bound
               'unc'   Unconstrained, set lower and upper bound to the
                       default values (-1000 and 1000, or any other values
                       that are defined in model.annotation.defaultLB and
                       .defaultUB)
   rxnList     a cell array of reaction IDs or a vector with their
               corresponding indexes
   params      a vector of the corresponding values
   var         percentage of variance around measured value, if 'var' is
               set as paramType. Defining 'var' as 5 results in lb and ub
               at 97.5% and 102.5% of the provide params value (if params
               value is negative, then lb and ub are 102.5% and 97.5%).

   model       an updated model structure

   Usage: model=setParam(model, paramType, rxnList, params)</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="convertCharArray.html" class="code" title="function inputConverted = convertCharArray(funcInput)">convertCharArray</a>	convertCharArray</li><li><a href="dispEM.html" class="code" title="function dispEM(string,throwErrors,toList,trimWarnings)">dispEM</a>	dispEM</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="FSEOF.html" class="code" title="function targets=FSEOF(model,biomassRxn,targetRxn,iterations,coefficient,outputFile)">FSEOF</a>	FSEOF: implements the algorithm of Flux Scanning based on Enforced Objective Flux.</li><li><a href="checkRxn.html" class="code" title="function report=checkRxn(model,rxn,cutoff,revDir,printReport)">checkRxn</a>	checkRxn</li><li><a href="checkTasks.html" class="code" title="function [taskReport, essentialRxns, taskStructure, essentialFluxes]=checkTasks(model,inputFile,printOutput,printOnlyFailed,getEssential,taskStructure)">checkTasks</a>	checkTasks</li><li><a href="consumeSomething.html" class="code" title="function [solution, metabolite]=consumeSomething(model,ignoreMets,isNames,minNrFluxes,params,ignoreIntBounds)">consumeSomething</a>	consumeSomething</li><li><a href="fitTasks.html" class="code" title="function [outModel, addedRxns]=fitTasks(model,refModel,inputFile,printOutput,rxnScores,taskStructure,params)">fitTasks</a>	fitTasks</li><li><a href="getEssentialRxns.html" class="code" title="function [essentialRxns, essentialRxnsIndexes]=getEssentialRxns(model,ignoreRxns)">getEssentialRxns</a>	getEssentialRxns</li><li><a href="makeSomething.html" class="code" title="function [solution, metabolite]=makeSomething(model,ignoreMets,isNames,minNrFluxes,allowExcretion,params,ignoreIntBounds)">makeSomething</a>	makeSomething</li><li><a href="randomSampling.html" class="code" title="function [solutions, goodRxns]=randomSampling(model,nSamples,replaceBoundsWithInf,supressErrors,runParallel,goodRxns,minFlux)">randomSampling</a>	randomSampling</li><li><a href="runPhenotypePhasePlane.html" class="code" title="function [growthRates, shadowPrices1, shadowPrices2] = runPhenotypePhasePlane(model, controlRxn1, controlRxn2, nPts, range1, range2)">runPhenotypePhasePlane</a>	runPhenotypePhasePlane</li><li><a href="runProductionEnvelope.html" class="code" title="function [biomassValues, targetValues] = runProductionEnvelope(model, targetRxn, biomassRxn, nPts)">runProductionEnvelope</a>	runProductionEnvelope</li><li><a href="runRobustnessAnalysis.html" class="code" title="function [controlFlux, objFlux] = runRobustnessAnalysis(model, controlRxn, nPoints, objRxn, plotRedCost)">runRobustnessAnalysis</a>	runRobustnessAnalysis</li><li><a href="runSimpleOptKnock.html" class="code" title="function out = runSimpleOptKnock(model, targetRxn, biomassRxn, deletions, genesOrRxns, maxNumKO, minGrowth)">runSimpleOptKnock</a>	runSimpleOptKnock</li><li><a href="setExchangeBounds.html" class="code" title="function [exchModel,unusedMets] = setExchangeBounds(model,mets,lb,ub,closeOthers,mediaOnly)">setExchangeBounds</a>	setExchangeBounds</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function model=setParam(model, paramType, rxnList, params, var)</a>
0002 <span class="comment">% setParam</span>
0003 <span class="comment">%   Sets parameters for reactions</span>
0004 <span class="comment">%</span>
0005 <span class="comment">%   model       a model structure</span>
0006 <span class="comment">%   paramType   the type of parameter to set:</span>
0007 <span class="comment">%               'lb'    Lower bound</span>
0008 <span class="comment">%               'ub'    Upper bound</span>
0009 <span class="comment">%               'eq'    Both upper and lower bound (equality constraint)</span>
0010 <span class="comment">%               'obj'   Objective coefficient</span>
0011 <span class="comment">%               'rev'   Reversibility (only changes the model.rev fields,</span>
0012 <span class="comment">%                       does not affect model.lb and model.ub)</span>
0013 <span class="comment">%               'var'   Variance around measured bound</span>
0014 <span class="comment">%               'unc'   Unconstrained, set lower and upper bound to the</span>
0015 <span class="comment">%                       default values (-1000 and 1000, or any other values</span>
0016 <span class="comment">%                       that are defined in model.annotation.defaultLB and</span>
0017 <span class="comment">%                       .defaultUB)</span>
0018 <span class="comment">%   rxnList     a cell array of reaction IDs or a vector with their</span>
0019 <span class="comment">%               corresponding indexes</span>
0020 <span class="comment">%   params      a vector of the corresponding values</span>
0021 <span class="comment">%   var         percentage of variance around measured value, if 'var' is</span>
0022 <span class="comment">%               set as paramType. Defining 'var' as 5 results in lb and ub</span>
0023 <span class="comment">%               at 97.5% and 102.5% of the provide params value (if params</span>
0024 <span class="comment">%               value is negative, then lb and ub are 102.5% and 97.5%).</span>
0025 <span class="comment">%</span>
0026 <span class="comment">%   model       an updated model structure</span>
0027 <span class="comment">%</span>
0028 <span class="comment">%   Usage: model=setParam(model, paramType, rxnList, params)</span>
0029 
0030 paramType=<a href="convertCharArray.html" class="code" title="function inputConverted = convertCharArray(funcInput)">convertCharArray</a>(paramType);
0031 <span class="keyword">if</span> ~any(strcmpi(paramType,{<span class="string">'lb'</span>,<span class="string">'ub'</span>,<span class="string">'eq'</span>,<span class="string">'obj'</span>,<span class="string">'rev'</span>,<span class="string">'var'</span>,<span class="string">'unc'</span>}))
0032     EM=[<span class="string">'Incorrect parameter type: &quot;'</span> paramType <span class="string">'&quot;'</span>];
0033     <a href="dispEM.html" class="code" title="function dispEM(string,throwErrors,toList,trimWarnings)">dispEM</a>(EM);
0034 <span class="keyword">end</span>
0035 <span class="keyword">if</span> isnumeric(rxnList) || islogical(rxnList)
0036     rxnList=model.rxns(rxnList);
0037 <span class="keyword">else</span>
0038     rxnList=<a href="convertCharArray.html" class="code" title="function inputConverted = convertCharArray(funcInput)">convertCharArray</a>(rxnList);
0039 <span class="keyword">end</span>
0040 
0041 <span class="comment">%Allow to set several parameters to the same value</span>
0042 <span class="keyword">if</span> numel(rxnList)~=numel(params) &amp;&amp; numel(params)~=1
0043     EM=<span class="string">'The number of parameter values and the number of reactions must be the same'</span>;
0044     <a href="dispEM.html" class="code" title="function dispEM(string,throwErrors,toList,trimWarnings)">dispEM</a>(EM);
0045 <span class="keyword">end</span>
0046 
0047 <span class="keyword">if</span> length(rxnList)&gt;1
0048     <span class="keyword">if</span> length(paramType)==1
0049         paramType(1:length(rxnList))=paramType;
0050     <span class="keyword">end</span>
0051     <span class="keyword">if</span> length(params)==1
0052         params(1:length(rxnList))=params;
0053     <span class="keyword">end</span>
0054 <span class="keyword">end</span>
0055 
0056 <span class="comment">%Find the indexes for the reactions in rxnList. Do not use getIndexes</span>
0057 <span class="comment">%as we do not want to throw errors if matches fail</span>
0058 indexes=zeros(numel(rxnList),1);
0059 
0060 <span class="keyword">for</span> i=1:numel(rxnList)
0061     index=find(strcmp(rxnList{i},model.rxns),1);
0062     <span class="keyword">if</span> ~isempty(index)
0063         indexes(i)=index;
0064     <span class="keyword">else</span>
0065         indexes(i)=-1;
0066         EM=[<span class="string">'Reaction '</span> rxnList{i} <span class="string">' is not present in the reaction list'</span>];
0067         <a href="dispEM.html" class="code" title="function dispEM(string,throwErrors,toList,trimWarnings)">dispEM</a>(EM,false);
0068     <span class="keyword">end</span>
0069 <span class="keyword">end</span>
0070 
0071 <span class="comment">%Remove the reactions that were not found</span>
0072 params(indexes==-1)=[];
0073 indexes(indexes==-1)=[];
0074 paramType(indexes==-1)=[];
0075 <span class="comment">%Change the parameters</span>
0076 
0077 <span class="keyword">if</span> ~isempty(indexes)
0078     <span class="keyword">if</span> contains(paramType,<span class="string">'obj'</span>)
0079         model.c=zeros(numel(model.c),1); <span class="comment">% parameter is changed, not added</span>
0080     <span class="keyword">end</span>
0081     <span class="keyword">for</span> j=1:length(paramType)
0082         <span class="keyword">if</span> strcmpi(paramType{j},<span class="string">'eq'</span>)
0083             model.lb(indexes(j))=params(j);
0084             model.ub(indexes(j))=params(j);
0085         <span class="keyword">end</span>
0086         <span class="keyword">if</span> strcmpi(paramType{j},<span class="string">'lb'</span>)
0087             model.lb(indexes(j))=params(j);
0088         <span class="keyword">end</span>
0089         <span class="keyword">if</span> strcmpi(paramType{j},<span class="string">'ub'</span>)
0090             model.ub(indexes(j))=params(j);
0091         <span class="keyword">end</span>
0092         <span class="keyword">if</span> strcmpi(paramType{j},<span class="string">'obj'</span>)
0093             model.c(indexes(j))=params(j);
0094         <span class="keyword">end</span>
0095         <span class="keyword">if</span> strcmpi(paramType{j},<span class="string">'rev'</span>)
0096             <span class="comment">%Non-zero values are interpreted as reversible</span>
0097             model.rev(indexes(j))=params(j)~=0;
0098         <span class="keyword">end</span>
0099         <span class="keyword">if</span> strcmpi(paramType{j},<span class="string">'var'</span>)
0100             <span class="keyword">if</span> params(j) &lt; 0
0101                 model.lb(indexes(j)) = params(j) * (1+var/200);
0102                 model.ub(indexes(j)) = params(j) * (1-var/200);
0103             <span class="keyword">else</span>
0104                 model.lb(indexes(j)) = params(j) * (1-var/200);
0105                 model.ub(indexes(j)) = params(j) * (1+var/200);
0106             <span class="keyword">end</span>
0107         <span class="keyword">end</span>
0108         <span class="keyword">if</span> strcmpi(paramType{j},<span class="string">'unc'</span>)
0109             <span class="keyword">if</span> isfield(model.annotation,<span class="string">'defaultLB'</span>)
0110                 lb = model.annotation.defaultLB;
0111             <span class="keyword">else</span>
0112                 lb = -1000;
0113             <span class="keyword">end</span>
0114             <span class="keyword">if</span> isfield(model.annotation,<span class="string">'defaultUB'</span>)
0115                 ub = model.annotation.defaultUB;
0116             <span class="keyword">else</span>
0117                 ub = 1000;
0118             <span class="keyword">end</span>
0119             model.lb(indexes(j)) = lb;
0120             model.ub(indexes(j)) = ub;
0121         <span class="keyword">end</span>
0122     <span class="keyword">end</span>
0123 <span class="keyword">end</span>
0124 <span class="keyword">end</span></pre></div>
<hr><address>Generated by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>
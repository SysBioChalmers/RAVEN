<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of setParam</title>
  <meta name="keywords" content="setParam">
  <meta name="description" content="setParam">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../index.html">Home</a> &gt;  <a href="index.html">core</a> &gt; setParam.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../index.html"><img alt="<" border="0" src="../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for core&nbsp;<img alt=">" border="0" src="../right.png"></a></td></tr></table>-->

<h1>setParam
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>setParam</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function model=setParam(model, paramType, rxnList, params, var) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> setParam
   Sets parameters for reactions

 Input:
   model       a model structure
   paramType   the type of parameter to set:
               'lb'    lower bound
               'ub'    upper bound
               'eq'    both upper and lower bound (equality constraint)
               'obj'   objective coefficient
               'rev'   reversibility (only changes the model.rev fields,
                       does not affect model.lb and model.ub) 
               'var'   variance around measured bound
               'unc'   unconstrained, set lower and upper bound to the
                       default values (-1000 and 1000, or any other values
                       that are defined in model.annotation.defaultLB and
                       .defaultUB)
   rxnList     a cell array of reaction IDs or a vector with their
               corresponding indexes
   params      a vector of the corresponding values
   var         percentage of variance around measured value, if 'var' is
               set as paramType. Defining 'var' as 5 results in lb and ub
               at 97.5% and 102.5% of the provide params value (if params
               value is negative, then lb and ub are 102.5% and 97.5%).

 Output:
   model       an updated model structure

 Usage: model = setParam(model, paramType, rxnList, params, var)</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="convertCharArray.html" class="code" title="function inputConverted = convertCharArray(funcInput)">convertCharArray</a>	convertCharArray</li><li><a href="dispEM.html" class="code" title="function dispEM(string,throwErrors,toList,trimWarnings)">dispEM</a>	dispEM</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="FSEOF.html" class="code" title="function targets=FSEOF(model,biomassRxn,targetRxn,iterations,coefficient,outputFile)">FSEOF</a>	FSEOF</li><li><a href="checkRxn.html" class="code" title="function report=checkRxn(model,rxn,cutoff,revDir,printReport)">checkRxn</a>	checkRxn</li><li><a href="checkTasks.html" class="code" title="function [taskReport, essentialRxns, taskStructure, essentialFluxes]=checkTasks(model,inputFile,printOutput,printOnlyFailed,getEssential,taskStructure)">checkTasks</a>	checkTasks</li><li><a href="consumeSomething.html" class="code" title="function [solution, metabolite]=consumeSomething(model,ignoreMets,isNames,minNrFluxes,params,ignoreIntBounds)">consumeSomething</a>	consumeSomething</li><li><a href="fitTasks.html" class="code" title="function [outModel, addedRxns]=fitTasks(model,refModel,inputFile,printOutput,rxnScores,taskStructure)">fitTasks</a>	fitTasks</li><li><a href="getEssentialRxns.html" class="code" title="function [essentialRxns, essentialRxnsIndexes]=getEssentialRxns(model,ignoreRxns)">getEssentialRxns</a>	getEssentialRxns</li><li><a href="makeSomething.html" class="code" title="function [solution, metabolite]=makeSomething(model,ignoreMets,isNames,minNrFluxes,allowExcretion,params,ignoreIntBounds)">makeSomething</a>	makeSomething</li><li><a href="randomSampling.html" class="code" title="function [solutions, goodRxns]=randomSampling(model,nSamples,replaceBoundsWithInf,supressErrors,runParallel,goodRxns,minFlux)">randomSampling</a>	randomSampling</li><li><a href="runPhenotypePhasePlane.html" class="code" title="function [growthRates, shadowPrices1, shadowPrices2] = runPhenotypePhasePlane(model, controlRxn1, controlRxn2, nPts, range1, range2)">runPhenotypePhasePlane</a>	runPhenotypePhasePlane</li><li><a href="runProductionEnvelope.html" class="code" title="function [biomassValues, targetValues] = runProductionEnvelope(model, targetRxn, biomassRxn, nPts)">runProductionEnvelope</a>	runProductionEnvelope</li><li><a href="runRobustnessAnalysis.html" class="code" title="function [controlFlux, objFlux] = runRobustnessAnalysis(model, controlRxn, nPoints, objRxn, plotRedCost)">runRobustnessAnalysis</a>	runRobustnessAnalysis</li><li><a href="runSimpleOptKnock.html" class="code" title="function out = runSimpleOptKnock(model, targetRxn, biomassRxn, deletions, genesOrRxns, maxNumKO, minGrowth)">runSimpleOptKnock</a>	runSimpleOptKnock</li><li><a href="setExchangeBounds.html" class="code" title="function [exchModel,unusedMets] = setExchangeBounds(model,mets,lb,ub,closeOthers,mediaOnly)">setExchangeBounds</a>	setExchangeBounds</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function model=setParam(model, paramType, rxnList, params, var)</a>
0002 <span class="comment">% setParam</span>
0003 <span class="comment">%   Sets parameters for reactions</span>
0004 <span class="comment">%</span>
0005 <span class="comment">% Input:</span>
0006 <span class="comment">%   model       a model structure</span>
0007 <span class="comment">%   paramType   the type of parameter to set:</span>
0008 <span class="comment">%               'lb'    lower bound</span>
0009 <span class="comment">%               'ub'    upper bound</span>
0010 <span class="comment">%               'eq'    both upper and lower bound (equality constraint)</span>
0011 <span class="comment">%               'obj'   objective coefficient</span>
0012 <span class="comment">%               'rev'   reversibility (only changes the model.rev fields,</span>
0013 <span class="comment">%                       does not affect model.lb and model.ub)</span>
0014 <span class="comment">%               'var'   variance around measured bound</span>
0015 <span class="comment">%               'unc'   unconstrained, set lower and upper bound to the</span>
0016 <span class="comment">%                       default values (-1000 and 1000, or any other values</span>
0017 <span class="comment">%                       that are defined in model.annotation.defaultLB and</span>
0018 <span class="comment">%                       .defaultUB)</span>
0019 <span class="comment">%   rxnList     a cell array of reaction IDs or a vector with their</span>
0020 <span class="comment">%               corresponding indexes</span>
0021 <span class="comment">%   params      a vector of the corresponding values</span>
0022 <span class="comment">%   var         percentage of variance around measured value, if 'var' is</span>
0023 <span class="comment">%               set as paramType. Defining 'var' as 5 results in lb and ub</span>
0024 <span class="comment">%               at 97.5% and 102.5% of the provide params value (if params</span>
0025 <span class="comment">%               value is negative, then lb and ub are 102.5% and 97.5%).</span>
0026 <span class="comment">%</span>
0027 <span class="comment">% Output:</span>
0028 <span class="comment">%   model       an updated model structure</span>
0029 <span class="comment">%</span>
0030 <span class="comment">% Usage: model = setParam(model, paramType, rxnList, params, var)</span>
0031 
0032 paramType=<a href="convertCharArray.html" class="code" title="function inputConverted = convertCharArray(funcInput)">convertCharArray</a>(paramType);
0033 <span class="keyword">if</span> ~any(strcmpi(paramType,{<span class="string">'lb'</span>,<span class="string">'ub'</span>,<span class="string">'eq'</span>,<span class="string">'obj'</span>,<span class="string">'rev'</span>,<span class="string">'var'</span>,<span class="string">'unc'</span>}))
0034     EM=[<span class="string">'Incorrect parameter type: &quot;'</span> paramType{1} <span class="string">'&quot;'</span>];
0035     <a href="dispEM.html" class="code" title="function dispEM(string,throwErrors,toList,trimWarnings)">dispEM</a>(EM);
0036 <span class="keyword">end</span>
0037 <span class="keyword">if</span> isnumeric(rxnList) || islogical(rxnList)
0038     rxnList=model.rxns(rxnList);
0039 <span class="keyword">else</span>
0040     rxnList=<a href="convertCharArray.html" class="code" title="function inputConverted = convertCharArray(funcInput)">convertCharArray</a>(rxnList);
0041 <span class="keyword">end</span>
0042 
0043 <span class="comment">%Allow to set several parameters to the same value</span>
0044 <span class="keyword">if</span> numel(rxnList)~=numel(params) &amp;&amp; numel(params)~=1
0045     EM=<span class="string">'The number of parameter values and the number of reactions must be the same'</span>;
0046     <a href="dispEM.html" class="code" title="function dispEM(string,throwErrors,toList,trimWarnings)">dispEM</a>(EM);
0047 <span class="keyword">end</span>
0048 
0049 <span class="keyword">if</span> length(rxnList)&gt;1
0050     <span class="keyword">if</span> length(paramType)==1
0051         paramType(1:length(rxnList))=paramType;
0052     <span class="keyword">end</span>
0053     <span class="keyword">if</span> length(params)==1
0054         params(1:length(rxnList))=params;
0055     <span class="keyword">end</span>
0056 <span class="keyword">end</span>
0057 
0058 <span class="comment">%Find the indexes for the reactions in rxnList. Do not use getIndexes</span>
0059 <span class="comment">%as we do not want to throw errors if matches fail</span>
0060 indexes=zeros(numel(rxnList),1);
0061 
0062 <span class="keyword">for</span> i=1:numel(rxnList)
0063     index=find(strcmp(rxnList{i},model.rxns),1);
0064     <span class="keyword">if</span> ~isempty(index)
0065         indexes(i)=index;
0066     <span class="keyword">else</span>
0067         indexes(i)=-1;
0068         EM=[<span class="string">'Reaction '</span> rxnList{i} <span class="string">' is not present in the reaction list'</span>];
0069         <a href="dispEM.html" class="code" title="function dispEM(string,throwErrors,toList,trimWarnings)">dispEM</a>(EM,false);
0070     <span class="keyword">end</span>
0071 <span class="keyword">end</span>
0072 
0073 <span class="comment">%Remove the reactions that were not found</span>
0074 params(indexes==-1)=[];
0075 indexes(indexes==-1)=[];
0076 paramType(indexes==-1)=[];
0077 <span class="comment">%Change the parameters</span>
0078 
0079 <span class="keyword">if</span> ~isempty(indexes)
0080     <span class="keyword">if</span> contains(paramType,<span class="string">'obj'</span>)
0081         model.c=zeros(numel(model.c),1); <span class="comment">% parameter is changed, not added</span>
0082     <span class="keyword">end</span>
0083     <span class="keyword">for</span> j=1:length(paramType)
0084         <span class="keyword">if</span> strcmpi(paramType{j},<span class="string">'eq'</span>)
0085             model.lb(indexes(j))=params(j);
0086             model.ub(indexes(j))=params(j);
0087         <span class="keyword">end</span>
0088         <span class="keyword">if</span> strcmpi(paramType{j},<span class="string">'lb'</span>)
0089             model.lb(indexes(j))=params(j);
0090         <span class="keyword">end</span>
0091         <span class="keyword">if</span> strcmpi(paramType{j},<span class="string">'ub'</span>)
0092             model.ub(indexes(j))=params(j);
0093         <span class="keyword">end</span>
0094         <span class="keyword">if</span> strcmpi(paramType{j},<span class="string">'obj'</span>)
0095             model.c(indexes(j))=params(j);
0096         <span class="keyword">end</span>
0097         <span class="keyword">if</span> strcmpi(paramType{j},<span class="string">'rev'</span>)
0098             <span class="comment">%Non-zero values are interpreted as reversible</span>
0099             model.rev(indexes(j))=params(j)~=0;
0100         <span class="keyword">end</span>
0101         <span class="keyword">if</span> strcmpi(paramType{j},<span class="string">'var'</span>)
0102             <span class="keyword">if</span> params(j) &lt; 0
0103                 model.lb(indexes(j)) = params(j) * (1+var/200);
0104                 model.ub(indexes(j)) = params(j) * (1-var/200);
0105             <span class="keyword">else</span>
0106                 model.lb(indexes(j)) = params(j) * (1-var/200);
0107                 model.ub(indexes(j)) = params(j) * (1+var/200);
0108             <span class="keyword">end</span>
0109         <span class="keyword">end</span>
0110         <span class="keyword">if</span> strcmpi(paramType{j},<span class="string">'unc'</span>)
0111             <span class="keyword">if</span> isfield(model.annotation,<span class="string">'defaultLB'</span>)
0112                 lb = model.annotation.defaultLB;
0113             <span class="keyword">else</span>
0114                 lb = -1000;
0115             <span class="keyword">end</span>
0116             <span class="keyword">if</span> isfield(model.annotation,<span class="string">'defaultUB'</span>)
0117                 ub = model.annotation.defaultUB;
0118             <span class="keyword">else</span>
0119                 ub = 1000;
0120             <span class="keyword">end</span>
0121             model.lb(indexes(j)) = lb;
0122             model.ub(indexes(j)) = ub;
0123         <span class="keyword">end</span>
0124     <span class="keyword">end</span>
0125 <span class="keyword">end</span>
0126 <span class="keyword">if</span> any(ismember(paramType,{<span class="string">'lb'</span>,<span class="string">'ub'</span>,<span class="string">'unc'</span>}))
0127     invalidBound = model.lb(indexes) &gt; model.ub(indexes);
0128     <span class="keyword">if</span> any(invalidBound)
0129         error([<span class="string">'Invalid set of bounds for reaction(s): '</span>, strjoin(model.rxns(indexes(invalidBound)),<span class="string">', '</span>), <span class="string">'.'</span>])
0130     <span class="keyword">end</span>
0131 <span class="keyword">end</span></pre></div>
<hr><address>Generated by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>
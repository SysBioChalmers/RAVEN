<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of removeReactions</title>
  <meta name="keywords" content="removeReactions">
  <meta name="description" content="removeReactions">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../index.html">Home</a> &gt;  <a href="index.html">core</a> &gt; removeReactions.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../index.html"><img alt="<" border="0" src="../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for core&nbsp;<img alt=">" border="0" src="../right.png"></a></td></tr></table>-->

<h1>removeReactions
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>removeReactions</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function reducedModel=removeReactions(model,rxnsToRemove,removeUnusedMets,removeUnusedGenes,removeUnusedComps) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> removeReactions
   Deletes a set of reactions from a model

   model             a model structure
   rxnsToRemove      either a cell array of reaction IDs, a logical vector
                     with the same number of elements as reactions in the model,
                     or a vector of indexes to remove
   removeUnusedMets  remove metabolites that are no longer in use (opt,
                     default false)
   removeUnusedGenes remove genes that are no longer in use (opt, default
                     false)
   removeUnusedComps remove compartments that are no longer in use (opt,
                     default false)

   reducedModel      an updated model structure

   Usage: reducedModel=removeReactions(model,rxnsToRemove,removeUnusedMets,...
           removeUnusedGenes,removeUnusedComps)</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="convertCharArray.html" class="code" title="function inputConverted = convertCharArray(funcInput)">convertCharArray</a>	convertCharArray</li><li><a href="getIndexes.html" class="code" title="function indexes=getIndexes(model, objects, type, returnLogical)">getIndexes</a>	getIndexes</li><li><a href="removeMets.html" class="code" title="function reducedModel=removeMets(model,metsToRemove,isNames,removeUnusedRxns,removeUnusedGenes,removeUnusedComps)">removeMets</a>	removeMets</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="changeRxns.html" class="code" title="function model=changeRxns(model,rxns,equations,eqnType,compartment,allowNewMets)">changeRxns</a>	changeRxns</li><li><a href="contractModel.html" class="code" title="function [reducedModel, removedRxns, indexedDuplicateRxns]=contractModel(model,distReverse,mets)">contractModel</a>	contractModel</li><li><a href="copyToComps.html" class="code" title="function model=copyToComps(model,toComps,rxns,deleteOriginal,compNames,compOutside)">copyToComps</a>	copyToComps</li><li><a href="fillGaps.html" class="code" title="function [newConnected, cannotConnect, addedRxns, newModel, exitFlag]=fillGaps(model,models,allowNetProduction,useModelConstraints,supressWarnings,rxnScores,params)">fillGaps</a>	fillGaps</li><li><a href="findGeneDeletions.html" class="code" title="function [genes, fluxes, originalGenes, details, grRatioMuts]=findGeneDeletions(model,testType,analysisType,refModel,oeFactor)">findGeneDeletions</a>	findGeneDeletions</li><li><a href="fitTasks.html" class="code" title="function [outModel, addedRxns]=fitTasks(model,refModel,inputFile,printOutput,rxnScores,taskStructure,params)">fitTasks</a>	fitTasks</li><li><a href="gapReport.html" class="code" title="function [noFluxRxns, noFluxRxnsRelaxed, subGraphs, notProducedMets, minToConnect,neededForProductionMat, canProduceWithoutInput, canConsumeWithoutOutput,connectedFromTemplates, addedFromTemplates]=gapReport(model, templateModels)">gapReport</a>	gapReport</li><li><a href="getElementalBalance.html" class="code" title="function balanceStructure=getElementalBalance(model,rxns,printUnbalanced,printUnparsable)">getElementalBalance</a>	getElementalBalance</li><li><a href="getModelFromHomology.html" class="code" title="function [draftModel, hitGenes]=getModelFromHomology(models,blastStructure,getModelFor,preferredOrder,strictness,onlyGenesInModels,maxE,minLen,minIde,mapNewGenesToOld)">getModelFromHomology</a>	getModelFromHomology</li><li><a href="mergeCompartments.html" class="code" title="function [model, deletedRxns, duplicateRxns]=mergeCompartments(model,keepUnconstrained,deleteRxnsWithOneMet,distReverse)">mergeCompartments</a>	mergeCompartments</li><li><a href="predictLocalization.html" class="code" title="function [outModel, geneLocalization, transportStruct, scores,removedRxns] = predictLocalization(model, GSS,defaultCompartment, transportCost, maxTime, plotResults)">predictLocalization</a>	predictLocalization</li><li><a href="printFluxes.html" class="code" title="function printFluxes(model, fluxes, onlyExchange, cutOffFlux, outputFile,outputString,metaboliteList)">printFluxes</a>	printFluxes</li><li><a href="removeBadRxns.html" class="code" title="function [newModel, removedRxns]=removeBadRxns(model,rxnRules,ignoreMets,isNames,balanceElements,refModel,ignoreIntBounds,printReport)">removeBadRxns</a>	removeBadRxns</li><li><a href="removeGenes.html" class="code" title="function reducedModel = removeGenes(model,genesToRemove,removeUnusedMets,removeBlockedRxns,standardizeRules)">removeGenes</a>	removeGenes</li><li><a href="removeMets.html" class="code" title="function reducedModel=removeMets(model,metsToRemove,isNames,removeUnusedRxns,removeUnusedGenes,removeUnusedComps)">removeMets</a>	removeMets</li><li><a href="simplifyModel.html" class="code" title="function [reducedModel, deletedReactions, deletedMetabolites]=simplifyModel(model,deleteUnconstrained, deleteDuplicates, deleteZeroInterval, deleteInaccessible, deleteMinMax, groupLinear, constrainReversible, reservedRxns, suppressWarnings)">simplifyModel</a>	simplifyModel</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function reducedModel=removeReactions(model,rxnsToRemove,removeUnusedMets,removeUnusedGenes,removeUnusedComps)</a>
0002 <span class="comment">% removeReactions</span>
0003 <span class="comment">%   Deletes a set of reactions from a model</span>
0004 <span class="comment">%</span>
0005 <span class="comment">%   model             a model structure</span>
0006 <span class="comment">%   rxnsToRemove      either a cell array of reaction IDs, a logical vector</span>
0007 <span class="comment">%                     with the same number of elements as reactions in the model,</span>
0008 <span class="comment">%                     or a vector of indexes to remove</span>
0009 <span class="comment">%   removeUnusedMets  remove metabolites that are no longer in use (opt,</span>
0010 <span class="comment">%                     default false)</span>
0011 <span class="comment">%   removeUnusedGenes remove genes that are no longer in use (opt, default</span>
0012 <span class="comment">%                     false)</span>
0013 <span class="comment">%   removeUnusedComps remove compartments that are no longer in use (opt,</span>
0014 <span class="comment">%                     default false)</span>
0015 <span class="comment">%</span>
0016 <span class="comment">%   reducedModel      an updated model structure</span>
0017 <span class="comment">%</span>
0018 <span class="comment">%   Usage: reducedModel=removeReactions(model,rxnsToRemove,removeUnusedMets,...</span>
0019 <span class="comment">%           removeUnusedGenes,removeUnusedComps)</span>
0020 
0021 <span class="keyword">if</span> nargin&lt;3
0022     removeUnusedMets=false;
0023 <span class="keyword">end</span>
0024 <span class="keyword">if</span> nargin&lt;4
0025     removeUnusedGenes=false;
0026 <span class="keyword">end</span>
0027 <span class="keyword">if</span> nargin&lt;5
0028     removeUnusedComps=false;
0029 <span class="keyword">end</span>
0030 <span class="keyword">if</span> ~islogical(rxnsToRemove) &amp;&amp; ~isnumeric(rxnsToRemove)
0031     rxnsToRemove=<a href="convertCharArray.html" class="code" title="function inputConverted = convertCharArray(funcInput)">convertCharArray</a>(rxnsToRemove);
0032 <span class="keyword">end</span>
0033 
0034 reducedModel=model;
0035 
0036 <span class="keyword">if</span> ~isempty(rxnsToRemove) || removeUnusedMets || removeUnusedGenes
0037     indexesToDelete=<a href="getIndexes.html" class="code" title="function indexes=getIndexes(model, objects, type, returnLogical)">getIndexes</a>(model,rxnsToRemove,<span class="string">'rxns'</span>);
0038     
0039     <span class="comment">%Remove reactions</span>
0040     <span class="keyword">if</span> ~isempty(indexesToDelete)
0041         reducedModel.rxns(indexesToDelete)=[];
0042         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'lb'</span>)
0043             reducedModel.lb(indexesToDelete)=[];
0044         <span class="keyword">end</span>
0045         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'ub'</span>)
0046             reducedModel.ub(indexesToDelete)=[];
0047         <span class="keyword">end</span>
0048         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'rev'</span>)
0049             reducedModel.rev(indexesToDelete)=[];
0050         <span class="keyword">end</span>
0051         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'c'</span>)
0052             reducedModel.c(indexesToDelete)=[];
0053         <span class="keyword">end</span>
0054         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'S'</span>)
0055             reducedModel.S(:,indexesToDelete)=[];
0056         <span class="keyword">end</span>
0057         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'rxnNames'</span>)
0058             reducedModel.rxnNames(indexesToDelete)=[];
0059         <span class="keyword">end</span>
0060         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'rxnGeneMat'</span>)
0061             reducedModel.rxnGeneMat(indexesToDelete,:)=[];
0062         <span class="keyword">end</span>
0063         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'grRules'</span>)
0064             reducedModel.grRules(indexesToDelete,:)=[];
0065         <span class="keyword">end</span>
0066         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'subSystems'</span>)
0067             reducedModel.subSystems(indexesToDelete,:)=[];
0068         <span class="keyword">end</span>
0069         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'eccodes'</span>)
0070             reducedModel.eccodes(indexesToDelete,:)=[];
0071         <span class="keyword">end</span>
0072         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'equations'</span>)
0073             reducedModel.equations(indexesToDelete,:)=[];
0074         <span class="keyword">end</span>
0075         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'rxnMiriams'</span>)
0076             reducedModel.rxnMiriams(indexesToDelete,:)=[];
0077         <span class="keyword">end</span>
0078         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'rxnComps'</span>)
0079             reducedModel.rxnComps(indexesToDelete,:)=[];
0080         <span class="keyword">end</span>
0081         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'rxnFrom'</span>)
0082             reducedModel.rxnFrom(indexesToDelete,:)=[];
0083         <span class="keyword">end</span>
0084         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'rxnScores'</span>)
0085             reducedModel.rxnScores(indexesToDelete,:)=[];
0086         <span class="keyword">end</span>
0087         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'rxnNotes'</span>)
0088             reducedModel.rxnNotes(indexesToDelete,:)=[];
0089         <span class="keyword">end</span>
0090         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'rxnReferences'</span>)
0091             reducedModel.rxnReferences(indexesToDelete,:)=[];
0092         <span class="keyword">end</span>
0093         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'rxnConfidenceScores'</span>)
0094             reducedModel.rxnConfidenceScores(indexesToDelete,:)=[];
0095         <span class="keyword">end</span>
0096         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'rxnDeltaG'</span>)
0097             reducedModel.rxnDeltaG(indexesToDelete,:)=[];
0098         <span class="keyword">end</span>
0099         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'pwys'</span>)
0100             reducedModel.pwys(indexesToDelete,:)=[];
0101         <span class="keyword">end</span>
0102         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'spontaneous'</span>)
0103             reducedModel.spontaneous(indexesToDelete)=[];
0104         <span class="keyword">end</span>
0105     <span class="keyword">end</span>
0106     
0107     <span class="comment">%Remove unused metabolites</span>
0108     <span class="keyword">if</span> removeUnusedMets==true
0109         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'S'</span>)
0110             [usedMets, ~]=find(reducedModel.S);
0111             unUsedMets=true(numel(reducedModel.mets),1);
0112             unUsedMets(usedMets)=false;
0113             reducedModel=<a href="removeMets.html" class="code" title="function reducedModel=removeMets(model,metsToRemove,isNames,removeUnusedRxns,removeUnusedGenes,removeUnusedComps)">removeMets</a>(reducedModel,unUsedMets,false,false,false,removeUnusedComps);
0114         <span class="keyword">end</span>
0115     <span class="keyword">end</span>
0116     
0117     <span class="comment">%Remove unused genes</span>
0118     <span class="keyword">if</span> removeUnusedGenes==true &amp;&amp; isfield(reducedModel,<span class="string">'rxnGeneMat'</span>)
0119         <span class="comment">%Find all genes that are not used</span>
0120         [~, b]=find(reducedModel.rxnGeneMat);
0121         toKeep=false(numel(reducedModel.genes),1);
0122         toKeep(b)=true;
0123         
0124         reducedModel.genes=reducedModel.genes(toKeep);
0125         reducedModel.rxnGeneMat=reducedModel.rxnGeneMat(:,toKeep);
0126         
0127         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'geneShortNames'</span>)
0128             reducedModel.geneShortNames=reducedModel.geneShortNames(toKeep);
0129         <span class="keyword">end</span>
0130         
0131         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'geneMiriams'</span>)
0132             reducedModel.geneMiriams=reducedModel.geneMiriams(toKeep);
0133         <span class="keyword">end</span>
0134         
0135         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'geneFrom'</span>)
0136             reducedModel.geneFrom=reducedModel.geneFrom(toKeep);
0137         <span class="keyword">end</span>
0138         
0139         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'geneComps'</span>)
0140             reducedModel.geneComps=reducedModel.geneComps(toKeep);
0141         <span class="keyword">end</span>
0142     <span class="keyword">end</span>
0143 <span class="keyword">else</span>
0144     reducedModel=model;
0145 <span class="keyword">end</span>
0146 <span class="keyword">end</span></pre></div>
<hr><address>Generated by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of removeReactions</title>
  <meta name="keywords" content="removeReactions">
  <meta name="description" content="removeReactions">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../index.html">Home</a> &gt;  <a href="index.html">core</a> &gt; removeReactions.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../index.html"><img alt="<" border="0" src="../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for core&nbsp;<img alt=">" border="0" src="../right.png"></a></td></tr></table>-->

<h1>removeReactions
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>removeReactions</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function reducedModel=removeReactions(model,rxnsToRemove,removeUnusedMets,removeUnusedGenes,removeUnusedComps) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> removeReactions
   Deletes a set of reactions from a model

   model             a model structure
   rxnsToRemove      either a cell array of reaction IDs, a logical vector
                     with the same number of elements as reactions in the model,
                     or a vector of indexes to remove
   removeUnusedMets  remove metabolites that are no longer in use (opt,
                     default false)
   removeUnusedGenes remove genes that are no longer in use (opt, default
                     false)
   removeUnusedComps remove compartments that are no longer in use (opt,
                     default false)

   reducedModel      an updated model structure

   Usage: reducedModel=removeReactions(model,rxnsToRemove,removeUnusedMets,...
           removeUnusedGenes,removeUnusedComps)

   Simonas Marcisauskas, 2017-08-25</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="getIndexes.html" class="code" title="function indexes=getIndexes(model, objects, type, returnLogical)">getIndexes</a>	getIndexes</li><li><a href="removeMets.html" class="code" title="function reducedModel=removeMets(model,metsToRemove,isNames,removeUnusedRxns,removeUnusedGenes,removeUnusedComps)">removeMets</a>	removeMets</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="changeRxns.html" class="code" title="function model=changeRxns(model,rxns,equations,eqnType,compartment,allowNewMets)">changeRxns</a>	changeRxns</li><li><a href="contractModel.html" class="code" title="function [reducedModel, removedRxns]=contractModel(model,distReverse)">contractModel</a>	contractModel</li><li><a href="copyToComps.html" class="code" title="function model=copyToComps(model,toComps,rxns,deleteOriginal,compNames,compOutside)">copyToComps</a>	copyToComps</li><li><a href="fillGaps.html" class="code" title="function [newConnected, cannotConnect, addedRxns, newModel, exitFlag]=fillGaps(model,models,allowNetProduction,useModelConstraints,supressWarnings,rxnScores,params)">fillGaps</a>	fillGaps</li><li><a href="findGeneDeletions.html" class="code" title="function [genes, fluxes, originalGenes, details]=findGeneDeletions(model,testType,analysisType,refModel,oeFactor)">findGeneDeletions</a>	findGeneDeletions</li><li><a href="fitTasks.html" class="code" title="function [outModel, addedRxns]=fitTasks(model,refModel,inputFile,printOutput,rxnScores,taskStructure,params)">fitTasks</a>	fitTasks</li><li><a href="gapReport.html" class="code" title="function [noFluxRxns, noFluxRxnsRelaxed, subGraphs, notProducedMets, minToConnect,neededForProductionMat, canProduceWithoutInput, canConsumeWithoutOutput,connectedFromTemplates, addedFromTemplates]=gapReport(model, templateModels)">gapReport</a>	gapReport</li><li><a href="getElementalBalance.html" class="code" title="function balanceStructure=getElementalBalance(model,rxns,printUnbalanced,printUnparsable)">getElementalBalance</a>	getElementalBalance</li><li><a href="getModelFromHomology.html" class="code" title="function draftModel=getModelFromHomology(models,blastStructure,getModelFor,preferredOrder,strictness,onlyGenesInModels,maxE,minLen,minSim,mapNewGenesToOld)">getModelFromHomology</a>	getModelFromHomology</li><li><a href="mergeCompartments.html" class="code" title="function [model, deletedRxns, duplicateRxns]=mergeCompartments(model,keepUnconstrained,deleteRxnsWithOneMet,distReverse)">mergeCompartments</a>	mergeCompartments</li><li><a href="predictLocalization.html" class="code" title="function [outModel, geneLocalization, transportStruct, scores, removedRxns]=predictLocalization(model,GSS,defaultCompartment,transportCost,maxTime,plotResults)">predictLocalization</a>	predictLocalization</li><li><a href="printFluxes.html" class="code" title="function printFluxes(model, fluxes, onlyExchange, cutOffFlux, outputFile,outputString,metaboliteList)">printFluxes</a>	printFluxes</li><li><a href="removeBadRxns.html" class="code" title="function [newModel, removedRxns]=removeBadRxns(model,rxnRules,ignoreMets,isNames,balanceElements,refModel,ignoreIntBounds,printReport)">removeBadRxns</a>	removeBadRxns</li><li><a href="removeGenes.html" class="code" title="function [reducedModel,notDeleted]=removeGenes(model,genesToRemove, removeUnusedMets, removeRxnsWithComplexes)">removeGenes</a>	removeGenes</li><li><a href="removeMets.html" class="code" title="function reducedModel=removeMets(model,metsToRemove,isNames,removeUnusedRxns,removeUnusedGenes,removeUnusedComps)">removeMets</a>	removeMets</li><li><a href="simplifyModel.html" class="code" title="function [reducedModel, deletedReactions, deletedMetabolites]=simplifyModel(model,deleteUnconstrained, deleteDuplicates, deleteZeroInterval, deleteInaccessible, deleteMinMax, groupLinear, constrainReversible, reservedRxns, suppressWarnings)">simplifyModel</a>	simplifyModel</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function reducedModel=removeReactions(model,rxnsToRemove,removeUnusedMets,removeUnusedGenes,removeUnusedComps)</a>
0002 <span class="comment">% removeReactions</span>
0003 <span class="comment">%   Deletes a set of reactions from a model</span>
0004 <span class="comment">%</span>
0005 <span class="comment">%   model             a model structure</span>
0006 <span class="comment">%   rxnsToRemove      either a cell array of reaction IDs, a logical vector</span>
0007 <span class="comment">%                     with the same number of elements as reactions in the model,</span>
0008 <span class="comment">%                     or a vector of indexes to remove</span>
0009 <span class="comment">%   removeUnusedMets  remove metabolites that are no longer in use (opt,</span>
0010 <span class="comment">%                     default false)</span>
0011 <span class="comment">%   removeUnusedGenes remove genes that are no longer in use (opt, default</span>
0012 <span class="comment">%                     false)</span>
0013 <span class="comment">%   removeUnusedComps remove compartments that are no longer in use (opt,</span>
0014 <span class="comment">%                     default false)</span>
0015 <span class="comment">%</span>
0016 <span class="comment">%   reducedModel      an updated model structure</span>
0017 <span class="comment">%</span>
0018 <span class="comment">%   Usage: reducedModel=removeReactions(model,rxnsToRemove,removeUnusedMets,...</span>
0019 <span class="comment">%           removeUnusedGenes,removeUnusedComps)</span>
0020 <span class="comment">%</span>
0021 <span class="comment">%   Simonas Marcisauskas, 2017-08-25</span>
0022 <span class="comment">%</span>
0023 
0024 <span class="keyword">if</span> nargin&lt;3
0025     removeUnusedMets=false;
0026 <span class="keyword">end</span>
0027 <span class="keyword">if</span> nargin&lt;4
0028     removeUnusedGenes=false;
0029 <span class="keyword">end</span>
0030 <span class="keyword">if</span> nargin&lt;5
0031     removeUnusedComps=false;
0032 <span class="keyword">end</span>
0033 
0034 <span class="keyword">if</span> ischar(rxnsToRemove)
0035     rxnsToRemove={rxnsToRemove};
0036 <span class="keyword">end</span>
0037 
0038 reducedModel=model;
0039 
0040 <span class="keyword">if</span> ~isempty(rxnsToRemove) || removeUnusedMets || removeUnusedGenes
0041     indexesToDelete=<a href="getIndexes.html" class="code" title="function indexes=getIndexes(model, objects, type, returnLogical)">getIndexes</a>(model,rxnsToRemove,<span class="string">'rxns'</span>);
0042 
0043     <span class="comment">%Remove reactions</span>
0044     <span class="keyword">if</span> ~isempty(indexesToDelete)
0045         reducedModel.rxns(indexesToDelete)=[];
0046         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'lb'</span>)
0047             reducedModel.lb(indexesToDelete)=[];
0048         <span class="keyword">end</span>
0049         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'ub'</span>)
0050             reducedModel.ub(indexesToDelete)=[];
0051         <span class="keyword">end</span>
0052         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'rev'</span>)
0053             reducedModel.rev(indexesToDelete)=[];
0054         <span class="keyword">end</span>
0055         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'c'</span>)
0056             reducedModel.c(indexesToDelete)=[];
0057         <span class="keyword">end</span>
0058         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'S'</span>)
0059             reducedModel.S(:,indexesToDelete)=[];
0060         <span class="keyword">end</span>
0061         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'rxnNames'</span>)
0062             reducedModel.rxnNames(indexesToDelete)=[];
0063         <span class="keyword">end</span>
0064         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'rxnGeneMat'</span>)
0065             reducedModel.rxnGeneMat(indexesToDelete,:)=[];
0066         <span class="keyword">end</span>
0067         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'grRules'</span>)
0068             reducedModel.grRules(indexesToDelete,:)=[];
0069         <span class="keyword">end</span>
0070         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'subSystems'</span>)
0071             reducedModel.subSystems(indexesToDelete,:)=[];
0072         <span class="keyword">end</span>
0073         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'eccodes'</span>)
0074             reducedModel.eccodes(indexesToDelete,:)=[];
0075         <span class="keyword">end</span>
0076         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'equations'</span>)
0077             reducedModel.equations(indexesToDelete,:)=[];
0078         <span class="keyword">end</span>
0079         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'rxnMiriams'</span>)
0080             reducedModel.rxnMiriams(indexesToDelete,:)=[];
0081         <span class="keyword">end</span>
0082         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'rxnComps'</span>)
0083             reducedModel.rxnComps(indexesToDelete,:)=[];
0084         <span class="keyword">end</span>
0085         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'rxnFrom'</span>)
0086             reducedModel.rxnFrom(indexesToDelete,:)=[];
0087         <span class="keyword">end</span>
0088         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'rxnScores'</span>)
0089             reducedModel.rxnScores(indexesToDelete,:)=[];
0090         <span class="keyword">end</span>
0091         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'rxnNotes'</span>)
0092             reducedModel.rxnNotes(indexesToDelete,:)=[];
0093         <span class="keyword">end</span>
0094         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'rxnReferences'</span>)
0095             reducedModel.rxnReferences(indexesToDelete,:)=[];
0096         <span class="keyword">end</span>
0097         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'rxnConfidenceScores'</span>)
0098             reducedModel.rxnConfidenceScores(indexesToDelete,:)=[];
0099         <span class="keyword">end</span>
0100         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'pwys'</span>)
0101             reducedModel.pwys(indexesToDelete,:)=[];
0102         <span class="keyword">end</span>
0103         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'spontaneous'</span>)
0104             reducedModel.spontaneous(indexesToDelete)=[];
0105         <span class="keyword">end</span>
0106     <span class="keyword">end</span>
0107 
0108     <span class="comment">%Remove unused metabolites</span>
0109     <span class="keyword">if</span> removeUnusedMets==true
0110         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'S'</span>)
0111             [usedMets, ~]=find(reducedModel.S);
0112             unUsedMets=true(numel(reducedModel.mets),1);
0113             unUsedMets(usedMets)=false;
0114             reducedModel=<a href="removeMets.html" class="code" title="function reducedModel=removeMets(model,metsToRemove,isNames,removeUnusedRxns,removeUnusedGenes,removeUnusedComps)">removeMets</a>(reducedModel,unUsedMets,false,false,false,removeUnusedComps);
0115         <span class="keyword">end</span>
0116     <span class="keyword">end</span>
0117 
0118     <span class="comment">%Remove unused genes</span>
0119     <span class="keyword">if</span> removeUnusedGenes==true &amp;&amp; isfield(reducedModel,<span class="string">'rxnGeneMat'</span>)
0120         <span class="comment">%Find all genes that are not used</span>
0121         [~, b]=find(reducedModel.rxnGeneMat);
0122         toKeep=false(numel(reducedModel.genes),1);
0123         toKeep(b)=true;
0124 
0125         reducedModel.genes=reducedModel.genes(toKeep);
0126         reducedModel.rxnGeneMat=reducedModel.rxnGeneMat(:,toKeep);
0127 
0128         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'geneShortNames'</span>)
0129            reducedModel.geneShortNames=reducedModel.geneShortNames(toKeep);
0130         <span class="keyword">end</span>
0131 
0132         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'geneMiriams'</span>)
0133            reducedModel.geneMiriams=reducedModel.geneMiriams(toKeep);
0134         <span class="keyword">end</span>
0135 
0136         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'geneFrom'</span>)
0137            reducedModel.geneFrom=reducedModel.geneFrom(toKeep);
0138         <span class="keyword">end</span>
0139 
0140         <span class="keyword">if</span> isfield(reducedModel,<span class="string">'geneComps'</span>)
0141            reducedModel.geneComps=reducedModel.geneComps(toKeep);
0142         <span class="keyword">end</span>
0143     <span class="keyword">end</span>
0144 <span class="keyword">else</span>
0145     reducedModel=model;
0146 <span class="keyword">end</span>
0147 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Wed 14-Mar-2018 21:08:28 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>
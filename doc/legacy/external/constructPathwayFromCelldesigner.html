<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of constructPathwayFromCelldesigner</title>
  <meta name="keywords" content="constructPathwayFromCelldesigner">
  <meta name="description" content="constructPathwayFromCelldesigner">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="#">legacy</a> &gt; <a href="index.html">external</a> &gt; constructPathwayFromCelldesigner.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for legacy\external&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>constructPathwayFromCelldesigner
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>constructPathwayFromCelldesigner</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function pathway = constructPathwayFromCelldesigner(inputFile) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> constructPathwayFromCelldesigner
    Constructs a pathway structure from a CellDesigner XML file.

    inputFile   string representing the pathway of the Celldesigner XML 
               file

    pathway
       listOfCompartments      structure with information on the compartments
                               in the Celldesigner file
           x                   the x position
           y                   the y position
           h                   the height
           w                   the width
           compartment         string representing the compartment
           id                  alias of the compartment. Used if there are
                               several instances of the same compartment
           name                the name of the compartment
       listOfSpecies           structure with information on each species in
                               the Celldesigner file. Both metabolites and
                               enzymes are species
           x                   the x position
           y                   the y position
           h                   the height
           w                   the width
           species             string representing the species
           alias               alias of the species. Used if the species is
                               present in several places in the map
           name                the name of the species
           type                the type of the species. At the moment only
                               'SIMPLE_MOLECULE' (for metabolites) and
                               'PROTEIN' (for enzymes) are supported
           note                string that can be used on enzymes to link them
                               to the corresponding reaction in a model
       listOfReactions         structure with information on each of the
                               reactions in the Celldesigner file
           reversible          true if the reaction is reversible
           middlePoint         vector with the x and y points of the middle
                               point of the reaction. All reactions are
                               defines as having one reactant and one product.
                               They may also have a number of modifiers (such
                               as cofactors or enzymes). Each of these
                               modifiers are drawn as being connected to the
                               middle point. The middle point is calculated
                               from the positions of the reactant and the
                               product
           componentList       structure with information on the reactant,
                               product, and modifiers of the reaction
               alias           string representing the alias of the
                               species. Corresponds to the alias in
                               listOfSpecies
               species         string representing the species.
                               Corresponds to the species in listOfSpecies
               anchor          vector with the x and y points of the
                               connecting point of the species
               baseReaction    true if the species is the base reactant
               baseProduct     true if the species is the base product
               toArrow         true if the line connecting the species
                               to the middle point should start with an
                               arrow
               fromArrow       true if the line connecting the species
                               to the middle point should end with an
                               arrow
               type            'METABOLITE' or 'ENZYME'

    Usage: pathway = constructPathwayFromCelldesigner(inputFile)</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function [x,y]=getBindingPos(pathway,speciesAlias,bindingSite)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function pathway = constructPathwayFromCelldesigner(inputFile)</a>
0002 <span class="comment">% constructPathwayFromCelldesigner</span>
0003 <span class="comment">%    Constructs a pathway structure from a CellDesigner XML file.</span>
0004 <span class="comment">%</span>
0005 <span class="comment">%    inputFile   string representing the pathway of the Celldesigner XML</span>
0006 <span class="comment">%               file</span>
0007 <span class="comment">%</span>
0008 <span class="comment">%    pathway</span>
0009 <span class="comment">%       listOfCompartments      structure with information on the compartments</span>
0010 <span class="comment">%                               in the Celldesigner file</span>
0011 <span class="comment">%           x                   the x position</span>
0012 <span class="comment">%           y                   the y position</span>
0013 <span class="comment">%           h                   the height</span>
0014 <span class="comment">%           w                   the width</span>
0015 <span class="comment">%           compartment         string representing the compartment</span>
0016 <span class="comment">%           id                  alias of the compartment. Used if there are</span>
0017 <span class="comment">%                               several instances of the same compartment</span>
0018 <span class="comment">%           name                the name of the compartment</span>
0019 <span class="comment">%       listOfSpecies           structure with information on each species in</span>
0020 <span class="comment">%                               the Celldesigner file. Both metabolites and</span>
0021 <span class="comment">%                               enzymes are species</span>
0022 <span class="comment">%           x                   the x position</span>
0023 <span class="comment">%           y                   the y position</span>
0024 <span class="comment">%           h                   the height</span>
0025 <span class="comment">%           w                   the width</span>
0026 <span class="comment">%           species             string representing the species</span>
0027 <span class="comment">%           alias               alias of the species. Used if the species is</span>
0028 <span class="comment">%                               present in several places in the map</span>
0029 <span class="comment">%           name                the name of the species</span>
0030 <span class="comment">%           type                the type of the species. At the moment only</span>
0031 <span class="comment">%                               'SIMPLE_MOLECULE' (for metabolites) and</span>
0032 <span class="comment">%                               'PROTEIN' (for enzymes) are supported</span>
0033 <span class="comment">%           note                string that can be used on enzymes to link them</span>
0034 <span class="comment">%                               to the corresponding reaction in a model</span>
0035 <span class="comment">%       listOfReactions         structure with information on each of the</span>
0036 <span class="comment">%                               reactions in the Celldesigner file</span>
0037 <span class="comment">%           reversible          true if the reaction is reversible</span>
0038 <span class="comment">%           middlePoint         vector with the x and y points of the middle</span>
0039 <span class="comment">%                               point of the reaction. All reactions are</span>
0040 <span class="comment">%                               defines as having one reactant and one product.</span>
0041 <span class="comment">%                               They may also have a number of modifiers (such</span>
0042 <span class="comment">%                               as cofactors or enzymes). Each of these</span>
0043 <span class="comment">%                               modifiers are drawn as being connected to the</span>
0044 <span class="comment">%                               middle point. The middle point is calculated</span>
0045 <span class="comment">%                               from the positions of the reactant and the</span>
0046 <span class="comment">%                               product</span>
0047 <span class="comment">%           componentList       structure with information on the reactant,</span>
0048 <span class="comment">%                               product, and modifiers of the reaction</span>
0049 <span class="comment">%               alias           string representing the alias of the</span>
0050 <span class="comment">%                               species. Corresponds to the alias in</span>
0051 <span class="comment">%                               listOfSpecies</span>
0052 <span class="comment">%               species         string representing the species.</span>
0053 <span class="comment">%                               Corresponds to the species in listOfSpecies</span>
0054 <span class="comment">%               anchor          vector with the x and y points of the</span>
0055 <span class="comment">%                               connecting point of the species</span>
0056 <span class="comment">%               baseReaction    true if the species is the base reactant</span>
0057 <span class="comment">%               baseProduct     true if the species is the base product</span>
0058 <span class="comment">%               toArrow         true if the line connecting the species</span>
0059 <span class="comment">%                               to the middle point should start with an</span>
0060 <span class="comment">%                               arrow</span>
0061 <span class="comment">%               fromArrow       true if the line connecting the species</span>
0062 <span class="comment">%                               to the middle point should end with an</span>
0063 <span class="comment">%                               arrow</span>
0064 <span class="comment">%               type            'METABOLITE' or 'ENZYME'</span>
0065 <span class="comment">%</span>
0066 <span class="comment">%    Usage: pathway = constructPathwayFromCelldesigner(inputFile)</span>
0067 
0068 <span class="comment">%Loads the specified xml file using XML Toolbox</span>
0069 [ST, I]=dbstack(<span class="string">'-completenames'</span>);
0070 ravenPath=fileparts(fileparts(ST(I).file));
0071 
0072 <span class="comment">%Current path and xml toolbox path</span>
0073 cp=pwd;
0074 xt=fullfile(ravenPath,<span class="string">'software'</span>,<span class="string">'xml_toolbox'</span>);
0075 
0076 <span class="comment">%Change path, run the script and change back</span>
0077 cd(xt);
0078 v = xml_parseany(fileread(inputFile));
0079 cd(cp);
0080 
0081 <span class="comment">%Saves information on each compartment</span>
0082 <span class="keyword">for</span> i=1:length(v.model{1,1}.annotation{1,1}.listOfCompartmentAliases{1,1}.compartmentAlias)
0083     pathway.listOfCompartments(i).x=str2double(v.model{1,1}.annotation{1,1}.listOfCompartmentAliases{1,1}<span class="keyword">...</span>
0084         .compartmentAlias{1,i}.bounds{1,1}.ATTRIBUTE.x);
0085     pathway.listOfCompartments(i).y=str2double(v.model{1,1}.annotation{1,1}.listOfCompartmentAliases{1,1}<span class="keyword">...</span>
0086         .compartmentAlias{1,i}.bounds{1,1}.ATTRIBUTE.y);
0087     pathway.listOfCompartments(i).h=str2double(v.model{1,1}.annotation{1,1}.listOfCompartmentAliases{1,1}<span class="keyword">...</span>
0088         .compartmentAlias{1,i}.bounds{1,1}.ATTRIBUTE.h);
0089     pathway.listOfCompartments(i).w=str2double(v.model{1,1}.annotation{1,1}.listOfCompartmentAliases{1,1}<span class="keyword">...</span>
0090         .compartmentAlias{1,i}.bounds{1,1}.ATTRIBUTE.w);
0091     pathway.listOfCompartments(i).compartment=v.model{1,1}.annotation{1,1}.listOfCompartmentAliases{1,1}<span class="keyword">...</span>
0092         .compartmentAlias{1,i}.ATTRIBUTE.compartment;
0093     pathway.listOfCompartments(i).id=v.model{1,1}.annotation{1,1}.listOfCompartmentAliases{1,1}<span class="keyword">...</span>
0094         .compartmentAlias{1,i}.ATTRIBUTE.id;
0095     
0096     <span class="comment">%Finds the name of the compartment</span>
0097     <span class="keyword">for</span> j=1:length(v.model{1,1}.listOfCompartments{1,1}.compartment)
0098         <span class="keyword">if</span> strcmpi(v.model{1,1}.listOfCompartments{1,1}.compartment{1,j}.ATTRIBUTE.id,<span class="keyword">...</span>
0099                 pathway.listOfCompartments(i).compartment)
0100             pathway.listOfCompartments(i).name=v.model{1,1}.listOfCompartments{1,1}.compartment{1,j}.ATTRIBUTE.name;
0101             <span class="keyword">break</span>;
0102         <span class="keyword">end</span>
0103     <span class="keyword">end</span>
0104 <span class="keyword">end</span>
0105 
0106 <span class="comment">%Saves information on each species and enzyme</span>
0107 <span class="keyword">for</span> i=1:length(v.model{1,1}.annotation{1,1}.listOfSpeciesAliases{1,1}.speciesAlias)
0108     pathway.listOfSpecies(i).x=str2double(v.model{1,1}.annotation{1,1}.listOfSpeciesAliases{1,1}<span class="keyword">...</span>
0109         .speciesAlias{1,i}.bounds{1,1}.ATTRIBUTE.x);
0110     pathway.listOfSpecies(i).y=str2double(v.model{1,1}.annotation{1,1}.listOfSpeciesAliases{1,1}<span class="keyword">...</span>
0111         .speciesAlias{1,i}.bounds{1,1}.ATTRIBUTE.y);
0112     pathway.listOfSpecies(i).h=str2double(v.model{1,1}.annotation{1,1}.listOfSpeciesAliases{1,1}<span class="keyword">...</span>
0113         .speciesAlias{1,i}.bounds{1,1}.ATTRIBUTE.h);
0114     pathway.listOfSpecies(i).w=str2double(v.model{1,1}.annotation{1,1}.listOfSpeciesAliases{1,1}<span class="keyword">...</span>
0115         .speciesAlias{1,i}.bounds{1,1}.ATTRIBUTE.w);
0116     pathway.listOfSpecies(i).alias=v.model{1,1}.annotation{1,1}.listOfSpeciesAliases{1,1}<span class="keyword">...</span>
0117         .speciesAlias{1,i}.ATTRIBUTE.id;
0118     pathway.listOfSpecies(i).species=v.model{1,1}.annotation{1,1}.listOfSpeciesAliases{1,1}<span class="keyword">...</span>
0119         .speciesAlias{1,i}.ATTRIBUTE.species;
0120     <span class="comment">%Find the name and type of the species/enzyme</span>
0121     <span class="keyword">for</span> j=1:length(v.model{1,1}.listOfSpecies{1,1}.species)
0122         <span class="keyword">if</span> strcmpi(v.model{1,1}.listOfSpecies{1,1}.species{1,j}.ATTRIBUTE.id,<span class="keyword">...</span>
0123                 pathway.listOfSpecies(i).species)
0124             pathway.listOfSpecies(i).name=v.model{1,1}.listOfSpecies{1,1}.species{1,j}.ATTRIBUTE.name;
0125             pathway.listOfSpecies(i).type=v.model{1,1}.listOfSpecies{1,1}.species{1,j}.annotation{1,1}<span class="keyword">...</span>
0126                 .speciesIdentity{1,1}.class{1,1}.CONTENT;
0127             
0128             <span class="comment">%The Celldesigner chart can be linked to a model (e.g. for</span>
0129             <span class="comment">%visualization of fluxes) by making a note in Celldesigner for</span>
0130             <span class="comment">%the protein in interest (this can only be done for proteins at</span>
0131             <span class="comment">%the moment). The note (not protein note!) should only contain</span>
0132             <span class="comment">%the reaction id in the model which corresponds to the protein</span>
0133             <span class="comment">%in Celldesigner.</span>
0134             <span class="keyword">if</span> strcmpi(pathway.listOfSpecies(i).type,<span class="string">'PROTEIN'</span>)
0135                 <span class="keyword">if</span> isfield(v.model{1,1}.listOfSpecies{1,1}.species{1,j},<span class="string">'notes'</span>)
0136                     pathway.listOfSpecies(i).note=cellstr(strtrim(v.model{1,1}.listOfSpecies{1,1}.species{1,j}<span class="keyword">...</span>
0137                         .notes{1,1}.html{1,1}.body{1,1}.CONTENT));
0138                 <span class="keyword">end</span>
0139             <span class="keyword">end</span>
0140             <span class="keyword">break</span>;
0141         <span class="keyword">end</span>
0142     <span class="keyword">end</span>
0143 <span class="keyword">end</span>
0144 
0145 <span class="comment">%Saves information on each reaction</span>
0146 <span class="keyword">for</span> i=1:length(v.model{1,1}.listOfReactions{1,1}.reaction)
0147     <span class="comment">%This is because it is standard for a reaction to be defined as</span>
0148     <span class="comment">%reversible</span>
0149     <span class="keyword">if</span> isfield(v.model{1,1}.listOfReactions{1,1}.reaction{1,i}.ATTRIBUTE,<span class="string">'reversible'</span>)
0150         pathway.listOfReactions(i).reversible=v.model{1,1}.listOfReactions{1,1}<span class="keyword">...</span>
0151             .reaction{1,i}.ATTRIBUTE.reversible;
0152     <span class="keyword">else</span>
0153         pathway.listOfReactions(i).reversible=<span class="string">'true'</span>;
0154     <span class="keyword">end</span>
0155     
0156     <span class="comment">%NOTE: As far as I know there can only be one base reactant/product per</span>
0157     <span class="comment">%reaction. This method is written with that assumption.</span>
0158     
0159     <span class="comment">%Finds the alias of the base reactant</span>
0160     baseReactant=v.model{1,1}.listOfReactions{1,1}<span class="keyword">...</span>
0161         .reaction{1,i}.annotation{1,1}.baseReactants{1,1}.baseReactant{1,1}<span class="keyword">...</span>
0162         .ATTRIBUTE.alias;
0163     
0164     <span class="comment">%Finds the alias of the base product</span>
0165     baseProduct=v.model{1,1}.listOfReactions{1,1}<span class="keyword">...</span>
0166         .reaction{1,i}.annotation{1,1}.baseProducts{1,1}.baseProduct{1,1}<span class="keyword">...</span>
0167         .ATTRIBUTE.alias;
0168     
0169     <span class="comment">%Saves the middle point</span>
0170     [x1,y1]=<a href="#_sub1" class="code" title="subfunction [x,y]=getBindingPos(pathway,speciesAlias,bindingSite)">getBindingPos</a>(pathway,baseReactant,<span class="keyword">...</span>
0171         v.model{1,1}.listOfReactions{1,1}.reaction{1,i}.annotation{1,1}<span class="keyword">...</span>
0172         .baseReactants{1,1}.baseReactant{1,1}.linkAnchor{1,1}.ATTRIBUTE.position);
0173     [x2,y2]=<a href="#_sub1" class="code" title="subfunction [x,y]=getBindingPos(pathway,speciesAlias,bindingSite)">getBindingPos</a>(pathway,baseProduct,<span class="keyword">...</span>
0174         v.model{1,1}.listOfReactions{1,1}.reaction{1,i}.annotation{1,1}<span class="keyword">...</span>
0175         .baseProducts{1,1}.baseProduct{1,1}.linkAnchor{1,1}.ATTRIBUTE.position);
0176     pathway.listOfReactions(i).middlePoint(1)=x1+(x2-x1)/2;
0177     pathway.listOfReactions(i).middlePoint(2)=y1+(y2-y1)/2;
0178     
0179     <span class="comment">%Saves information on each of the components</span>
0180     counter=1; <span class="comment">%Keeps track of where in componentList to add a component</span>
0181     
0182     <span class="comment">%Adds the base reactant</span>
0183     pathway.listOfReactions(i).componentList(counter).alias=v.model{1,1}<span class="keyword">...</span>
0184         .listOfReactions{1,1}.reaction{1,i}.annotation{1,1}.baseReactants{1,1}<span class="keyword">...</span>
0185         .baseReactant{1,1}.ATTRIBUTE.alias;
0186     pathway.listOfReactions(i).componentList(counter).species=v.model{1,1}<span class="keyword">...</span>
0187         .listOfReactions{1,1}.reaction{1,i}.annotation{1,1}.baseReactants{1,1}<span class="keyword">...</span>
0188         .baseReactant{1,1}.ATTRIBUTE.species;
0189     [x,y]=<a href="#_sub1" class="code" title="subfunction [x,y]=getBindingPos(pathway,speciesAlias,bindingSite)">getBindingPos</a>(pathway,baseReactant,v.model{1,1}.listOfReactions{1,1}<span class="keyword">...</span>
0190         .reaction{1,i}.annotation{1,1}.baseReactants{1,1}.baseReactant{1,1}<span class="keyword">...</span>
0191         .linkAnchor{1,1}.ATTRIBUTE.position);
0192     pathway.listOfReactions(i).componentList(counter).anchor(1)=x;
0193     pathway.listOfReactions(i).componentList(counter).anchor(2)=y;
0194     pathway.listOfReactions(i).componentList(counter).baseReactant=<span class="string">'true'</span>;
0195     pathway.listOfReactions(i).componentList(counter).baseProduct=<span class="string">'false'</span>;
0196     
0197     <span class="comment">%toArrow should be true if the reaction is reversible</span>
0198     pathway.listOfReactions(i).componentList(counter).toArrow=<span class="keyword">...</span>
0199         pathway.listOfReactions(i).reversible;
0200     pathway.listOfReactions(i).componentList(counter).fromArrow=<span class="string">'false'</span>;
0201     pathway.listOfReactions(i).componentList(counter).type=<span class="string">'METABOLITE'</span>;
0202     counter=counter+1;
0203     
0204     <span class="comment">%Adds the base product</span>
0205     pathway.listOfReactions(i).componentList(counter).alias=v.model{1,1}<span class="keyword">...</span>
0206         .listOfReactions{1,1}.reaction{1,i}.annotation{1,1}.baseProducts{1,1}<span class="keyword">...</span>
0207         .baseProduct{1,1}.ATTRIBUTE.alias;
0208     pathway.listOfReactions(i).componentList(counter).species=v.model{1,1}<span class="keyword">...</span>
0209         .listOfReactions{1,1}.reaction{1,i}.annotation{1,1}.baseProducts{1,1}<span class="keyword">...</span>
0210         .baseProduct{1,1}.ATTRIBUTE.species;
0211     [x,y]=<a href="#_sub1" class="code" title="subfunction [x,y]=getBindingPos(pathway,speciesAlias,bindingSite)">getBindingPos</a>(pathway,baseProduct,v.model{1,1}.listOfReactions{1,1}<span class="keyword">...</span>
0212         .reaction{1,i}.annotation{1,1}.baseProducts{1,1}.baseProduct{1,1}<span class="keyword">...</span>
0213         .linkAnchor{1,1}.ATTRIBUTE.position);
0214     pathway.listOfReactions(i).componentList(counter).anchor(1)=x;
0215     pathway.listOfReactions(i).componentList(counter).anchor(2)=y;
0216     pathway.listOfReactions(i).componentList(counter).baseReactant=<span class="string">'false'</span>;
0217     pathway.listOfReactions(i).componentList(counter).baseProduct=<span class="string">'true'</span>;
0218     pathway.listOfReactions(i).componentList(counter).toArrow=<span class="string">'true'</span>;
0219     pathway.listOfReactions(i).componentList(counter).fromArrow=<span class="string">'false'</span>;
0220     pathway.listOfReactions(i).componentList(counter).type=<span class="string">'METABOLITE'</span>;
0221     counter=counter+1;
0222     
0223     <span class="comment">%Adds the non-base reactants Not all reactions have any non-base</span>
0224     <span class="comment">%reactants</span>
0225     <span class="keyword">if</span> isfield(v.model{1,1}.listOfReactions{1,1}.reaction{1,i}.annotation{1,1}<span class="keyword">...</span>
0226             ,<span class="string">'listOfReactantLinks'</span>)
0227         <span class="keyword">for</span> j=1:length(v.model{1,1}.listOfReactions{1,1}.reaction{1,i}.annotation{1,1}<span class="keyword">...</span>
0228                 .listOfReactantLinks{1,1}.reactantLink)
0229             pathway.listOfReactions(i).componentList(counter).alias=v.model{1,1}<span class="keyword">...</span>
0230                 .listOfReactions{1,1}.reaction{1,i}.annotation{1,1}<span class="keyword">...</span>
0231                 .listOfReactantLinks{1,1}.reactantLink{1,j}.ATTRIBUTE.alias;
0232             pathway.listOfReactions(i).componentList(counter).species=v.model{1,1}<span class="keyword">...</span>
0233                 .listOfReactions{1,1}.reaction{1,i}.annotation{1,1}<span class="keyword">...</span>
0234                 .listOfReactantLinks{1,1}.reactantLink{1,j}.ATTRIBUTE.reactant;
0235             [x,y]=<a href="#_sub1" class="code" title="subfunction [x,y]=getBindingPos(pathway,speciesAlias,bindingSite)">getBindingPos</a>(pathway,pathway.listOfReactions(i).componentList(counter).alias<span class="keyword">...</span>
0236                 ,v.model{1,1}.listOfReactions{1,1}.reaction{1,i}.annotation{1,1}<span class="keyword">...</span>
0237                 .listOfReactantLinks{1,1}.reactantLink{1,j}.linkAnchor{1,1}<span class="keyword">...</span>
0238                 .ATTRIBUTE.position);
0239             pathway.listOfReactions(i).componentList(counter).anchor(1)=x;
0240             pathway.listOfReactions(i).componentList(counter).anchor(2)=y;
0241             pathway.listOfReactions(i).componentList(counter).baseReactant=<span class="string">'false'</span>;
0242             pathway.listOfReactions(i).componentList(counter).baseProduct=<span class="string">'false'</span>;
0243             pathway.listOfReactions(i).componentList(counter).toArrow=<span class="string">'false'</span>;
0244             pathway.listOfReactions(i).componentList(counter).fromArrow=<span class="string">'false'</span>;
0245             pathway.listOfReactions(i).componentList(counter).type=<span class="string">'METABOLITE'</span>;
0246             counter=counter+1;
0247         <span class="keyword">end</span>
0248     <span class="keyword">end</span>
0249     
0250     <span class="comment">%Adds the non-base products Not all reactions have any non-base</span>
0251     <span class="comment">%products</span>
0252     <span class="keyword">if</span> isfield(v.model{1,1}.listOfReactions{1,1}.reaction{1,i}.annotation{1,1}<span class="keyword">...</span>
0253             ,<span class="string">'listOfProductLinks'</span>)
0254         <span class="keyword">for</span> j=1:length(v.model{1,1}.listOfReactions{1,1}.reaction{1,i}.annotation{1,1}<span class="keyword">...</span>
0255                 .listOfProductLinks{1,1}.productLink)
0256             pathway.listOfReactions(i).componentList(counter).alias=v.model{1,1}<span class="keyword">...</span>
0257                 .listOfReactions{1,1}.reaction{1,i}.annotation{1,1}<span class="keyword">...</span>
0258                 .listOfProductLinks{1,1}.productLink{1,j}.ATTRIBUTE.alias;
0259             pathway.listOfReactions(i).componentList(counter).species=v.model{1,1}<span class="keyword">...</span>
0260                 .listOfReactions{1,1}.reaction{1,i}.annotation{1,1}<span class="keyword">...</span>
0261                 .listOfProductLinks{1,1}.productLink{1,j}.ATTRIBUTE.product;
0262             [x,y]=<a href="#_sub1" class="code" title="subfunction [x,y]=getBindingPos(pathway,speciesAlias,bindingSite)">getBindingPos</a>(pathway,pathway.listOfReactions(i).componentList(counter).alias<span class="keyword">...</span>
0263                 ,v.model{1,1}.listOfReactions{1,1}.reaction{1,i}.annotation{1,1}<span class="keyword">...</span>
0264                 .listOfProductLinks{1,1}.productLink{1,j}.linkAnchor{1,1}<span class="keyword">...</span>
0265                 .ATTRIBUTE.position);
0266             pathway.listOfReactions(i).componentList(counter).anchor(1)=x;
0267             pathway.listOfReactions(i).componentList(counter).anchor(2)=y;
0268             pathway.listOfReactions(i).componentList(counter).baseReactant=<span class="string">'false'</span>;
0269             pathway.listOfReactions(i).componentList(counter).baseProduct=<span class="string">'false'</span>;
0270             pathway.listOfReactions(i).componentList(counter).toArrow=<span class="string">'true'</span>;
0271             pathway.listOfReactions(i).componentList(counter).fromArrow=<span class="string">'false'</span>;
0272             pathway.listOfReactions(i).componentList(counter).type=<span class="string">'METABOLITE'</span>;
0273             counter=counter+1;
0274         <span class="keyword">end</span>
0275     <span class="keyword">end</span>
0276     
0277     <span class="comment">%Adds the modifiers (enzymes) Not all reactions have any modifiers</span>
0278     <span class="keyword">if</span> isfield(v.model{1,1}.listOfReactions{1,1}.reaction{1,i}.annotation{1,1}<span class="keyword">...</span>
0279             ,<span class="string">'listOfModification'</span>)
0280         <span class="keyword">for</span> j=1:length(v.model{1,1}.listOfReactions{1,1}.reaction{1,i}.annotation{1,1}<span class="keyword">...</span>
0281                 .listOfModification{1,1}.modification)
0282             pathway.listOfReactions(i).componentList(counter).alias=v.model{1,1}<span class="keyword">...</span>
0283                 .listOfReactions{1,1}.reaction{1,i}.annotation{1,1}.listOfModification{1,1}<span class="keyword">...</span>
0284                 .modification{1,j}.linkTarget{1,1}.ATTRIBUTE.alias;
0285             pathway.listOfReactions(i).componentList(counter).species=v.model{1,1}<span class="keyword">...</span>
0286                 .listOfReactions{1,1}.reaction{1,i}.annotation{1,1}.listOfModification{1,1}<span class="keyword">...</span>
0287                 .modification{1,j}.linkTarget{1,1}.ATTRIBUTE.species;
0288             [x,y]=<a href="#_sub1" class="code" title="subfunction [x,y]=getBindingPos(pathway,speciesAlias,bindingSite)">getBindingPos</a>(pathway,pathway.listOfReactions(i).componentList(counter).alias<span class="keyword">...</span>
0289                 ,v.model{1,1}.listOfReactions{1,1}.reaction{1,i}.annotation{1,1}<span class="keyword">...</span>
0290                 .listOfModification{1,1}.modification{1,j}.linkTarget{1,1}<span class="keyword">...</span>
0291                 .linkAnchor{1,1}.ATTRIBUTE.position);
0292             pathway.listOfReactions(i).componentList(counter).anchor(1)=x;
0293             pathway.listOfReactions(i).componentList(counter).anchor(2)=y;
0294             pathway.listOfReactions(i).componentList(counter).baseReactant=<span class="string">'false'</span>;
0295             pathway.listOfReactions(i).componentList(counter).baseProduct=<span class="string">'false'</span>;
0296             pathway.listOfReactions(i).componentList(counter).toArrow=<span class="string">'false'</span>;
0297             pathway.listOfReactions(i).componentList(counter).fromArrow=<span class="string">'false'</span>;
0298             pathway.listOfReactions(i).componentList(counter).type=<span class="string">'ENZYME'</span>;
0299             counter=counter+1;
0300         <span class="keyword">end</span>
0301     <span class="keyword">end</span>
0302 <span class="keyword">end</span>
0303 <span class="keyword">end</span>
0304 
0305 <a name="_sub1" href="#_subfunctions" class="code">function [x,y]=getBindingPos(pathway,speciesAlias,bindingSite)</a>
0306 <span class="comment">% getBindingPos</span>
0307 <span class="comment">%   Calculates the position of a given binding site for a specified species</span>
0308 <span class="comment">%</span>
0309 <span class="comment">%   pathway         the pathway structure which should be modified</span>
0310 <span class="comment">%   speciesAlias    the alias of the species bindingSite     The binding</span>
0311 <span class="comment">%   site in Celldesigner is a string of up to</span>
0312 <span class="comment">%                   three letters that defines which of the 16 bindings</span>
0313 <span class="comment">%                   sites on each species to use. They are written as N</span>
0314 <span class="comment">%                   (north), NNW (north north west) and so on</span>
0315 <span class="comment">%</span>
0316 <span class="comment">%   [x, y]          The position of the binding site for the species</span>
0317 <span class="comment">%</span>
0318 <span class="comment">%   Usage: [x,y]=getBindingPos(pathway,speciesAlias,bindingSite)</span>
0319 
0320 <span class="comment">%Find the species</span>
0321 <span class="keyword">for</span> i=1:length(pathway.listOfSpecies)
0322     <span class="keyword">if</span> strcmpi(pathway.listOfSpecies(i).alias,speciesAlias)
0323         xpos=pathway.listOfSpecies(i).x;
0324         ypos=pathway.listOfSpecies(i).y;
0325         h=pathway.listOfSpecies(i).h;
0326         w=pathway.listOfSpecies(i).w;
0327         
0328         <span class="comment">%Species marked as &quot;PROTEIN&quot; should be drawn as rectangles. There</span>
0329         <span class="comment">%is one binding site in each corner and three in between on each</span>
0330         <span class="comment">%side.</span>
0331         <span class="keyword">if</span> strcmpi(pathway.listOfSpecies(i).type,<span class="string">'PROTEIN'</span>)
0332             <span class="comment">%The binding sites clockwise from the top position</span>
0333             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'N'</span>)
0334                 x=xpos+0.5*w;
0335                 y=ypos;
0336                 <span class="keyword">break</span>;
0337             <span class="keyword">end</span>
0338             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'NNE'</span>)
0339                 x=xpos+0.75*w;
0340                 y=ypos;
0341                 <span class="keyword">break</span>;
0342             <span class="keyword">end</span>
0343             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'NE'</span>)
0344                 x=xpos+w;
0345                 y=ypos;
0346                 <span class="keyword">break</span>;
0347             <span class="keyword">end</span>
0348             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'ENE'</span>)
0349                 x=xpos+w;
0350                 y=ypos+0.25*h;
0351                 <span class="keyword">break</span>;
0352             <span class="keyword">end</span>
0353             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'E'</span>)
0354                 x=xpos+w;
0355                 y=ypos+0.5*h;
0356                 <span class="keyword">break</span>;
0357             <span class="keyword">end</span>
0358             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'ESE'</span>)
0359                 x=xpos+w;
0360                 y=ypos+0.75*h;
0361                 <span class="keyword">break</span>;
0362             <span class="keyword">end</span>
0363             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'SE'</span>)
0364                 x=xpos+w;
0365                 y=ypos+h;
0366                 <span class="keyword">break</span>;
0367             <span class="keyword">end</span>
0368             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'SSE'</span>)
0369                 x=xpos+0.75*w;
0370                 y=ypos+h;
0371                 <span class="keyword">break</span>;
0372             <span class="keyword">end</span>
0373             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'S'</span>)
0374                 x=xpos+0.5*w;
0375                 y=ypos+h;
0376                 <span class="keyword">break</span>;
0377             <span class="keyword">end</span>
0378             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'SSW'</span>)
0379                 x=xpos+0.25*w;
0380                 y=ypos+h;
0381                 <span class="keyword">break</span>;
0382             <span class="keyword">end</span>
0383             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'SW'</span>)
0384                 x=xpos;
0385                 y=ypos+h;
0386                 <span class="keyword">break</span>;
0387             <span class="keyword">end</span>
0388             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'WSW'</span>)
0389                 x=xpos;
0390                 y=ypos+0.75*h;
0391                 <span class="keyword">break</span>;
0392             <span class="keyword">end</span>
0393             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'W'</span>)
0394                 x=xpos;
0395                 y=ypos+0.5*h;
0396                 <span class="keyword">break</span>;
0397             <span class="keyword">end</span>
0398             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'WNW'</span>)
0399                 x=xpos;
0400                 y=ypos+0.25*h;
0401                 <span class="keyword">break</span>;
0402             <span class="keyword">end</span>
0403             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'NW'</span>)
0404                 x=xpos;
0405                 y=ypos;
0406                 <span class="keyword">break</span>;
0407             <span class="keyword">end</span>
0408             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'NNW'</span>)
0409                 x=xpos+0.25*w;
0410                 y=ypos;
0411                 <span class="keyword">break</span>;
0412             <span class="keyword">end</span>
0413         <span class="keyword">end</span>
0414         
0415         <span class="comment">%Species marked as &quot;SIMPLE_MOLECULE&quot; should be drawn as ellipses.</span>
0416         <span class="comment">%There is one binding site in each extreme point and three in</span>
0417         <span class="comment">%between on each side</span>
0418         <span class="keyword">if</span> strcmpi(pathway.listOfSpecies(i).type,<span class="string">'SIMPLE_MOLECULE'</span>)
0419             <span class="comment">%Find the center of the ellipse</span>
0420             centerX=xpos+0.5*w;
0421             centerY=ypos+0.5*h;
0422             
0423             <span class="comment">%The binding sites clockwise from the top position</span>
0424             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'N'</span>)
0425                 angle=(4/8)*pi;
0426             <span class="keyword">end</span>
0427             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'NNE'</span>)
0428                 angle=(5/8)*pi;
0429             <span class="keyword">end</span>
0430             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'NE'</span>)
0431                 angle=(6/8)*pi;
0432             <span class="keyword">end</span>
0433             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'ENE'</span>)
0434                 angle=(7/8)*pi;
0435             <span class="keyword">end</span>
0436             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'E'</span>)
0437                 angle=(8/8)*pi;
0438             <span class="keyword">end</span>
0439             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'ESE'</span>)
0440                 angle=(9/8)*pi;
0441             <span class="keyword">end</span>
0442             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'SE'</span>)
0443                 angle=(10/8)*pi;
0444             <span class="keyword">end</span>
0445             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'SSE'</span>)
0446                 angle=(11/8)*pi;
0447             <span class="keyword">end</span>
0448             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'S'</span>)
0449                 angle=(12/8)*pi;
0450             <span class="keyword">end</span>
0451             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'SSW'</span>)
0452                 angle=(13/8)*pi;
0453             <span class="keyword">end</span>
0454             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'SW'</span>)
0455                 angle=(14/8)*pi;
0456             <span class="keyword">end</span>
0457             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'WSW'</span>)
0458                 angle=(15/8)*pi;
0459             <span class="keyword">end</span>
0460             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'W'</span>)
0461                 angle=(16/8)*pi;
0462             <span class="keyword">end</span>
0463             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'WNW'</span>)
0464                 angle=(1/8)*pi;
0465             <span class="keyword">end</span>
0466             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'NW'</span>)
0467                 angle=(2/8)*pi;
0468             <span class="keyword">end</span>
0469             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'NNW'</span>)
0470                 angle=(3/8)*pi;
0471             <span class="keyword">end</span>
0472             x=centerX-(0.5*w)*cos(angle);
0473             y=centerY-(0.5*h)*sin(angle);
0474             <span class="keyword">break</span>;
0475         <span class="keyword">end</span>
0476     <span class="keyword">end</span>
0477 <span class="keyword">end</span>
0478 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Wed 13-Jan-2021 21:53:20 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>
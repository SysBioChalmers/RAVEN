<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of constructPathwayFromCelldesigner</title>
  <meta name="keywords" content="constructPathwayFromCelldesigner">
  <meta name="description" content="constructPathwayFromCelldesigner">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="#">legacy</a> &gt; <a href="index.html">external</a> &gt; constructPathwayFromCelldesigner.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for legacy/external&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>constructPathwayFromCelldesigner
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>constructPathwayFromCelldesigner</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function pathway = constructPathwayFromCelldesigner(inputFile) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> constructPathwayFromCelldesigner
    Constructs a pathway structure from a CellDesigner XML file.

    inputFile   string representing the pathway of the Celldesigner XML 
               file

    pathway
       listOfCompartments      structure with information on the compartments
                               in the Celldesigner file
           x                   the x position
           y                   the y position
           h                   the height
           w                   the width
           compartment         string representing the compartment
           id                  alias of the compartment. Used if there are
                               several instances of the same compartment
           name                the name of the compartment
       listOfSpecies           structure with information on each species in
                               the Celldesigner file. Both metabolites and
                               enzymes are species
           x                   the x position
           y                   the y position
           h                   the height
           w                   the width
           species             string representing the species
           alias               alias of the species. Used if the species is
                               present in several places in the map
           name                the name of the species
           type                the type of the species. At the moment only
                               'SIMPLE_MOLECULE' (for metabolites) and
                               'PROTEIN' (for enzymes) are supported
           note                string that can be used on enzymes to link them
                               to the corresponding reaction in a model
       listOfReactions         structure with information on each of the
                               reactions in the Celldesigner file
           reversible          true if the reaction is reversible
           middlePoint         vector with the x and y points of the middle
                               point of the reaction. All reactions are
                               defines as having one reactant and one product.
                               They may also have a number of modifiers (such
                               as cofactors or enzymes). Each of these
                               modifiers are drawn as being connected to the
                               middle point. The middle point is calculated
                               from the positions of the reactant and the
                               product
           componentList       structure with information on the reactant,
                               product, and modifiers of the reaction
               alias           string representing the alias of the
                               species. Corresponds to the alias in
                               listOfSpecies
               species         string representing the species.
                               Corresponds to the species in listOfSpecies
               anchor          vector with the x and y points of the
                               connecting point of the species
               baseReaction    true if the species is the base reactant
               baseProduct     true if the species is the base product
               toArrow         true if the line connecting the species
                               to the middle point should start with an
                               arrow
               fromArrow       true if the line connecting the species
                               to the middle point should end with an
                               arrow
               type            'METABOLITE' or 'ENZYME'

    Usage: pathway = constructPathwayFromCelldesigner(inputFile)</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function [x,y]=getBindingPos(pathway,speciesAlias,bindingSite)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function pathway = constructPathwayFromCelldesigner(inputFile)</a>
0002 <span class="comment">% constructPathwayFromCelldesigner</span>
0003 <span class="comment">%    Constructs a pathway structure from a CellDesigner XML file.</span>
0004 <span class="comment">%</span>
0005 <span class="comment">%    inputFile   string representing the pathway of the Celldesigner XML</span>
0006 <span class="comment">%               file</span>
0007 <span class="comment">%</span>
0008 <span class="comment">%    pathway</span>
0009 <span class="comment">%       listOfCompartments      structure with information on the compartments</span>
0010 <span class="comment">%                               in the Celldesigner file</span>
0011 <span class="comment">%           x                   the x position</span>
0012 <span class="comment">%           y                   the y position</span>
0013 <span class="comment">%           h                   the height</span>
0014 <span class="comment">%           w                   the width</span>
0015 <span class="comment">%           compartment         string representing the compartment</span>
0016 <span class="comment">%           id                  alias of the compartment. Used if there are</span>
0017 <span class="comment">%                               several instances of the same compartment</span>
0018 <span class="comment">%           name                the name of the compartment</span>
0019 <span class="comment">%       listOfSpecies           structure with information on each species in</span>
0020 <span class="comment">%                               the Celldesigner file. Both metabolites and</span>
0021 <span class="comment">%                               enzymes are species</span>
0022 <span class="comment">%           x                   the x position</span>
0023 <span class="comment">%           y                   the y position</span>
0024 <span class="comment">%           h                   the height</span>
0025 <span class="comment">%           w                   the width</span>
0026 <span class="comment">%           species             string representing the species</span>
0027 <span class="comment">%           alias               alias of the species. Used if the species is</span>
0028 <span class="comment">%                               present in several places in the map</span>
0029 <span class="comment">%           name                the name of the species</span>
0030 <span class="comment">%           type                the type of the species. At the moment only</span>
0031 <span class="comment">%                               'SIMPLE_MOLECULE' (for metabolites) and</span>
0032 <span class="comment">%                               'PROTEIN' (for enzymes) are supported</span>
0033 <span class="comment">%           note                string that can be used on enzymes to link them</span>
0034 <span class="comment">%                               to the corresponding reaction in a model</span>
0035 <span class="comment">%       listOfReactions         structure with information on each of the</span>
0036 <span class="comment">%                               reactions in the Celldesigner file</span>
0037 <span class="comment">%           reversible          true if the reaction is reversible</span>
0038 <span class="comment">%           middlePoint         vector with the x and y points of the middle</span>
0039 <span class="comment">%                               point of the reaction. All reactions are</span>
0040 <span class="comment">%                               defines as having one reactant and one product.</span>
0041 <span class="comment">%                               They may also have a number of modifiers (such</span>
0042 <span class="comment">%                               as cofactors or enzymes). Each of these</span>
0043 <span class="comment">%                               modifiers are drawn as being connected to the</span>
0044 <span class="comment">%                               middle point. The middle point is calculated</span>
0045 <span class="comment">%                               from the positions of the reactant and the</span>
0046 <span class="comment">%                               product</span>
0047 <span class="comment">%           componentList       structure with information on the reactant,</span>
0048 <span class="comment">%                               product, and modifiers of the reaction</span>
0049 <span class="comment">%               alias           string representing the alias of the</span>
0050 <span class="comment">%                               species. Corresponds to the alias in</span>
0051 <span class="comment">%                               listOfSpecies</span>
0052 <span class="comment">%               species         string representing the species.</span>
0053 <span class="comment">%                               Corresponds to the species in listOfSpecies</span>
0054 <span class="comment">%               anchor          vector with the x and y points of the</span>
0055 <span class="comment">%                               connecting point of the species</span>
0056 <span class="comment">%               baseReaction    true if the species is the base reactant</span>
0057 <span class="comment">%               baseProduct     true if the species is the base product</span>
0058 <span class="comment">%               toArrow         true if the line connecting the species</span>
0059 <span class="comment">%                               to the middle point should start with an</span>
0060 <span class="comment">%                               arrow</span>
0061 <span class="comment">%               fromArrow       true if the line connecting the species</span>
0062 <span class="comment">%                               to the middle point should end with an</span>
0063 <span class="comment">%                               arrow</span>
0064 <span class="comment">%               type            'METABOLITE' or 'ENZYME'</span>
0065 <span class="comment">%</span>
0066 <span class="comment">%    Usage: pathway = constructPathwayFromCelldesigner(inputFile)</span>
0067 
0068 <span class="comment">%Loads the specified xml file using XML Toolbox</span>
0069 ravenPath=findRAVENroot();
0070 
0071 <span class="comment">%Current path and xml toolbox path</span>
0072 cp=pwd;
0073 xt=fullfile(ravenPath,<span class="string">'software'</span>,<span class="string">'xml_toolbox'</span>);
0074 
0075 <span class="comment">%Change path, run the script and change back</span>
0076 cd(xt);
0077 v = xml_parseany(fileread(inputFile));
0078 cd(cp);
0079 
0080 <span class="comment">%Saves information on each compartment</span>
0081 <span class="keyword">for</span> i=1:length(v.model{1,1}.annotation{1,1}.listOfCompartmentAliases{1,1}.compartmentAlias)
0082     pathway.listOfCompartments(i).x=str2double(v.model{1,1}.annotation{1,1}.listOfCompartmentAliases{1,1}<span class="keyword">...</span>
0083         .compartmentAlias{1,i}.bounds{1,1}.ATTRIBUTE.x);
0084     pathway.listOfCompartments(i).y=str2double(v.model{1,1}.annotation{1,1}.listOfCompartmentAliases{1,1}<span class="keyword">...</span>
0085         .compartmentAlias{1,i}.bounds{1,1}.ATTRIBUTE.y);
0086     pathway.listOfCompartments(i).h=str2double(v.model{1,1}.annotation{1,1}.listOfCompartmentAliases{1,1}<span class="keyword">...</span>
0087         .compartmentAlias{1,i}.bounds{1,1}.ATTRIBUTE.h);
0088     pathway.listOfCompartments(i).w=str2double(v.model{1,1}.annotation{1,1}.listOfCompartmentAliases{1,1}<span class="keyword">...</span>
0089         .compartmentAlias{1,i}.bounds{1,1}.ATTRIBUTE.w);
0090     pathway.listOfCompartments(i).compartment=v.model{1,1}.annotation{1,1}.listOfCompartmentAliases{1,1}<span class="keyword">...</span>
0091         .compartmentAlias{1,i}.ATTRIBUTE.compartment;
0092     pathway.listOfCompartments(i).id=v.model{1,1}.annotation{1,1}.listOfCompartmentAliases{1,1}<span class="keyword">...</span>
0093         .compartmentAlias{1,i}.ATTRIBUTE.id;
0094     
0095     <span class="comment">%Finds the name of the compartment</span>
0096     <span class="keyword">for</span> j=1:length(v.model{1,1}.listOfCompartments{1,1}.compartment)
0097         <span class="keyword">if</span> strcmpi(v.model{1,1}.listOfCompartments{1,1}.compartment{1,j}.ATTRIBUTE.id,<span class="keyword">...</span>
0098                 pathway.listOfCompartments(i).compartment)
0099             pathway.listOfCompartments(i).name=v.model{1,1}.listOfCompartments{1,1}.compartment{1,j}.ATTRIBUTE.name;
0100             <span class="keyword">break</span>;
0101         <span class="keyword">end</span>
0102     <span class="keyword">end</span>
0103 <span class="keyword">end</span>
0104 
0105 <span class="comment">%Saves information on each species and enzyme</span>
0106 <span class="keyword">for</span> i=1:length(v.model{1,1}.annotation{1,1}.listOfSpeciesAliases{1,1}.speciesAlias)
0107     pathway.listOfSpecies(i).x=str2double(v.model{1,1}.annotation{1,1}.listOfSpeciesAliases{1,1}<span class="keyword">...</span>
0108         .speciesAlias{1,i}.bounds{1,1}.ATTRIBUTE.x);
0109     pathway.listOfSpecies(i).y=str2double(v.model{1,1}.annotation{1,1}.listOfSpeciesAliases{1,1}<span class="keyword">...</span>
0110         .speciesAlias{1,i}.bounds{1,1}.ATTRIBUTE.y);
0111     pathway.listOfSpecies(i).h=str2double(v.model{1,1}.annotation{1,1}.listOfSpeciesAliases{1,1}<span class="keyword">...</span>
0112         .speciesAlias{1,i}.bounds{1,1}.ATTRIBUTE.h);
0113     pathway.listOfSpecies(i).w=str2double(v.model{1,1}.annotation{1,1}.listOfSpeciesAliases{1,1}<span class="keyword">...</span>
0114         .speciesAlias{1,i}.bounds{1,1}.ATTRIBUTE.w);
0115     pathway.listOfSpecies(i).alias=v.model{1,1}.annotation{1,1}.listOfSpeciesAliases{1,1}<span class="keyword">...</span>
0116         .speciesAlias{1,i}.ATTRIBUTE.id;
0117     pathway.listOfSpecies(i).species=v.model{1,1}.annotation{1,1}.listOfSpeciesAliases{1,1}<span class="keyword">...</span>
0118         .speciesAlias{1,i}.ATTRIBUTE.species;
0119     <span class="comment">%Find the name and type of the species/enzyme</span>
0120     <span class="keyword">for</span> j=1:length(v.model{1,1}.listOfSpecies{1,1}.species)
0121         <span class="keyword">if</span> strcmpi(v.model{1,1}.listOfSpecies{1,1}.species{1,j}.ATTRIBUTE.id,<span class="keyword">...</span>
0122                 pathway.listOfSpecies(i).species)
0123             pathway.listOfSpecies(i).name=v.model{1,1}.listOfSpecies{1,1}.species{1,j}.ATTRIBUTE.name;
0124             pathway.listOfSpecies(i).type=v.model{1,1}.listOfSpecies{1,1}.species{1,j}.annotation{1,1}<span class="keyword">...</span>
0125                 .speciesIdentity{1,1}.class{1,1}.CONTENT;
0126             
0127             <span class="comment">%The Celldesigner chart can be linked to a model (e.g. for</span>
0128             <span class="comment">%visualization of fluxes) by making a note in Celldesigner for</span>
0129             <span class="comment">%the protein in interest (this can only be done for proteins at</span>
0130             <span class="comment">%the moment). The note (not protein note!) should only contain</span>
0131             <span class="comment">%the reaction id in the model which corresponds to the protein</span>
0132             <span class="comment">%in Celldesigner.</span>
0133             <span class="keyword">if</span> strcmpi(pathway.listOfSpecies(i).type,<span class="string">'PROTEIN'</span>)
0134                 <span class="keyword">if</span> isfield(v.model{1,1}.listOfSpecies{1,1}.species{1,j},<span class="string">'notes'</span>)
0135                     pathway.listOfSpecies(i).note=cellstr(strtrim(v.model{1,1}.listOfSpecies{1,1}.species{1,j}<span class="keyword">...</span>
0136                         .notes{1,1}.html{1,1}.body{1,1}.CONTENT));
0137                 <span class="keyword">end</span>
0138             <span class="keyword">end</span>
0139             <span class="keyword">break</span>;
0140         <span class="keyword">end</span>
0141     <span class="keyword">end</span>
0142 <span class="keyword">end</span>
0143 
0144 <span class="comment">%Saves information on each reaction</span>
0145 <span class="keyword">for</span> i=1:length(v.model{1,1}.listOfReactions{1,1}.reaction)
0146     <span class="comment">%This is because it is standard for a reaction to be defined as</span>
0147     <span class="comment">%reversible</span>
0148     <span class="keyword">if</span> isfield(v.model{1,1}.listOfReactions{1,1}.reaction{1,i}.ATTRIBUTE,<span class="string">'reversible'</span>)
0149         pathway.listOfReactions(i).reversible=v.model{1,1}.listOfReactions{1,1}<span class="keyword">...</span>
0150             .reaction{1,i}.ATTRIBUTE.reversible;
0151     <span class="keyword">else</span>
0152         pathway.listOfReactions(i).reversible=<span class="string">'true'</span>;
0153     <span class="keyword">end</span>
0154     
0155     <span class="comment">%NOTE: As far as I know there can only be one base reactant/product per</span>
0156     <span class="comment">%reaction. This method is written with that assumption.</span>
0157     
0158     <span class="comment">%Finds the alias of the base reactant</span>
0159     baseReactant=v.model{1,1}.listOfReactions{1,1}<span class="keyword">...</span>
0160         .reaction{1,i}.annotation{1,1}.baseReactants{1,1}.baseReactant{1,1}<span class="keyword">...</span>
0161         .ATTRIBUTE.alias;
0162     
0163     <span class="comment">%Finds the alias of the base product</span>
0164     baseProduct=v.model{1,1}.listOfReactions{1,1}<span class="keyword">...</span>
0165         .reaction{1,i}.annotation{1,1}.baseProducts{1,1}.baseProduct{1,1}<span class="keyword">...</span>
0166         .ATTRIBUTE.alias;
0167     
0168     <span class="comment">%Saves the middle point</span>
0169     [x1,y1]=<a href="#_sub1" class="code" title="subfunction [x,y]=getBindingPos(pathway,speciesAlias,bindingSite)">getBindingPos</a>(pathway,baseReactant,<span class="keyword">...</span>
0170         v.model{1,1}.listOfReactions{1,1}.reaction{1,i}.annotation{1,1}<span class="keyword">...</span>
0171         .baseReactants{1,1}.baseReactant{1,1}.linkAnchor{1,1}.ATTRIBUTE.position);
0172     [x2,y2]=<a href="#_sub1" class="code" title="subfunction [x,y]=getBindingPos(pathway,speciesAlias,bindingSite)">getBindingPos</a>(pathway,baseProduct,<span class="keyword">...</span>
0173         v.model{1,1}.listOfReactions{1,1}.reaction{1,i}.annotation{1,1}<span class="keyword">...</span>
0174         .baseProducts{1,1}.baseProduct{1,1}.linkAnchor{1,1}.ATTRIBUTE.position);
0175     pathway.listOfReactions(i).middlePoint(1)=x1+(x2-x1)/2;
0176     pathway.listOfReactions(i).middlePoint(2)=y1+(y2-y1)/2;
0177     
0178     <span class="comment">%Saves information on each of the components</span>
0179     counter=1; <span class="comment">%Keeps track of where in componentList to add a component</span>
0180     
0181     <span class="comment">%Adds the base reactant</span>
0182     pathway.listOfReactions(i).componentList(counter).alias=v.model{1,1}<span class="keyword">...</span>
0183         .listOfReactions{1,1}.reaction{1,i}.annotation{1,1}.baseReactants{1,1}<span class="keyword">...</span>
0184         .baseReactant{1,1}.ATTRIBUTE.alias;
0185     pathway.listOfReactions(i).componentList(counter).species=v.model{1,1}<span class="keyword">...</span>
0186         .listOfReactions{1,1}.reaction{1,i}.annotation{1,1}.baseReactants{1,1}<span class="keyword">...</span>
0187         .baseReactant{1,1}.ATTRIBUTE.species;
0188     [x,y]=<a href="#_sub1" class="code" title="subfunction [x,y]=getBindingPos(pathway,speciesAlias,bindingSite)">getBindingPos</a>(pathway,baseReactant,v.model{1,1}.listOfReactions{1,1}<span class="keyword">...</span>
0189         .reaction{1,i}.annotation{1,1}.baseReactants{1,1}.baseReactant{1,1}<span class="keyword">...</span>
0190         .linkAnchor{1,1}.ATTRIBUTE.position);
0191     pathway.listOfReactions(i).componentList(counter).anchor(1)=x;
0192     pathway.listOfReactions(i).componentList(counter).anchor(2)=y;
0193     pathway.listOfReactions(i).componentList(counter).baseReactant=<span class="string">'true'</span>;
0194     pathway.listOfReactions(i).componentList(counter).baseProduct=<span class="string">'false'</span>;
0195     
0196     <span class="comment">%toArrow should be true if the reaction is reversible</span>
0197     pathway.listOfReactions(i).componentList(counter).toArrow=<span class="keyword">...</span>
0198         pathway.listOfReactions(i).reversible;
0199     pathway.listOfReactions(i).componentList(counter).fromArrow=<span class="string">'false'</span>;
0200     pathway.listOfReactions(i).componentList(counter).type=<span class="string">'METABOLITE'</span>;
0201     counter=counter+1;
0202     
0203     <span class="comment">%Adds the base product</span>
0204     pathway.listOfReactions(i).componentList(counter).alias=v.model{1,1}<span class="keyword">...</span>
0205         .listOfReactions{1,1}.reaction{1,i}.annotation{1,1}.baseProducts{1,1}<span class="keyword">...</span>
0206         .baseProduct{1,1}.ATTRIBUTE.alias;
0207     pathway.listOfReactions(i).componentList(counter).species=v.model{1,1}<span class="keyword">...</span>
0208         .listOfReactions{1,1}.reaction{1,i}.annotation{1,1}.baseProducts{1,1}<span class="keyword">...</span>
0209         .baseProduct{1,1}.ATTRIBUTE.species;
0210     [x,y]=<a href="#_sub1" class="code" title="subfunction [x,y]=getBindingPos(pathway,speciesAlias,bindingSite)">getBindingPos</a>(pathway,baseProduct,v.model{1,1}.listOfReactions{1,1}<span class="keyword">...</span>
0211         .reaction{1,i}.annotation{1,1}.baseProducts{1,1}.baseProduct{1,1}<span class="keyword">...</span>
0212         .linkAnchor{1,1}.ATTRIBUTE.position);
0213     pathway.listOfReactions(i).componentList(counter).anchor(1)=x;
0214     pathway.listOfReactions(i).componentList(counter).anchor(2)=y;
0215     pathway.listOfReactions(i).componentList(counter).baseReactant=<span class="string">'false'</span>;
0216     pathway.listOfReactions(i).componentList(counter).baseProduct=<span class="string">'true'</span>;
0217     pathway.listOfReactions(i).componentList(counter).toArrow=<span class="string">'true'</span>;
0218     pathway.listOfReactions(i).componentList(counter).fromArrow=<span class="string">'false'</span>;
0219     pathway.listOfReactions(i).componentList(counter).type=<span class="string">'METABOLITE'</span>;
0220     counter=counter+1;
0221     
0222     <span class="comment">%Adds the non-base reactants Not all reactions have any non-base</span>
0223     <span class="comment">%reactants</span>
0224     <span class="keyword">if</span> isfield(v.model{1,1}.listOfReactions{1,1}.reaction{1,i}.annotation{1,1}<span class="keyword">...</span>
0225             ,<span class="string">'listOfReactantLinks'</span>)
0226         <span class="keyword">for</span> j=1:length(v.model{1,1}.listOfReactions{1,1}.reaction{1,i}.annotation{1,1}<span class="keyword">...</span>
0227                 .listOfReactantLinks{1,1}.reactantLink)
0228             pathway.listOfReactions(i).componentList(counter).alias=v.model{1,1}<span class="keyword">...</span>
0229                 .listOfReactions{1,1}.reaction{1,i}.annotation{1,1}<span class="keyword">...</span>
0230                 .listOfReactantLinks{1,1}.reactantLink{1,j}.ATTRIBUTE.alias;
0231             pathway.listOfReactions(i).componentList(counter).species=v.model{1,1}<span class="keyword">...</span>
0232                 .listOfReactions{1,1}.reaction{1,i}.annotation{1,1}<span class="keyword">...</span>
0233                 .listOfReactantLinks{1,1}.reactantLink{1,j}.ATTRIBUTE.reactant;
0234             [x,y]=<a href="#_sub1" class="code" title="subfunction [x,y]=getBindingPos(pathway,speciesAlias,bindingSite)">getBindingPos</a>(pathway,pathway.listOfReactions(i).componentList(counter).alias<span class="keyword">...</span>
0235                 ,v.model{1,1}.listOfReactions{1,1}.reaction{1,i}.annotation{1,1}<span class="keyword">...</span>
0236                 .listOfReactantLinks{1,1}.reactantLink{1,j}.linkAnchor{1,1}<span class="keyword">...</span>
0237                 .ATTRIBUTE.position);
0238             pathway.listOfReactions(i).componentList(counter).anchor(1)=x;
0239             pathway.listOfReactions(i).componentList(counter).anchor(2)=y;
0240             pathway.listOfReactions(i).componentList(counter).baseReactant=<span class="string">'false'</span>;
0241             pathway.listOfReactions(i).componentList(counter).baseProduct=<span class="string">'false'</span>;
0242             pathway.listOfReactions(i).componentList(counter).toArrow=<span class="string">'false'</span>;
0243             pathway.listOfReactions(i).componentList(counter).fromArrow=<span class="string">'false'</span>;
0244             pathway.listOfReactions(i).componentList(counter).type=<span class="string">'METABOLITE'</span>;
0245             counter=counter+1;
0246         <span class="keyword">end</span>
0247     <span class="keyword">end</span>
0248     
0249     <span class="comment">%Adds the non-base products Not all reactions have any non-base</span>
0250     <span class="comment">%products</span>
0251     <span class="keyword">if</span> isfield(v.model{1,1}.listOfReactions{1,1}.reaction{1,i}.annotation{1,1}<span class="keyword">...</span>
0252             ,<span class="string">'listOfProductLinks'</span>)
0253         <span class="keyword">for</span> j=1:length(v.model{1,1}.listOfReactions{1,1}.reaction{1,i}.annotation{1,1}<span class="keyword">...</span>
0254                 .listOfProductLinks{1,1}.productLink)
0255             pathway.listOfReactions(i).componentList(counter).alias=v.model{1,1}<span class="keyword">...</span>
0256                 .listOfReactions{1,1}.reaction{1,i}.annotation{1,1}<span class="keyword">...</span>
0257                 .listOfProductLinks{1,1}.productLink{1,j}.ATTRIBUTE.alias;
0258             pathway.listOfReactions(i).componentList(counter).species=v.model{1,1}<span class="keyword">...</span>
0259                 .listOfReactions{1,1}.reaction{1,i}.annotation{1,1}<span class="keyword">...</span>
0260                 .listOfProductLinks{1,1}.productLink{1,j}.ATTRIBUTE.product;
0261             [x,y]=<a href="#_sub1" class="code" title="subfunction [x,y]=getBindingPos(pathway,speciesAlias,bindingSite)">getBindingPos</a>(pathway,pathway.listOfReactions(i).componentList(counter).alias<span class="keyword">...</span>
0262                 ,v.model{1,1}.listOfReactions{1,1}.reaction{1,i}.annotation{1,1}<span class="keyword">...</span>
0263                 .listOfProductLinks{1,1}.productLink{1,j}.linkAnchor{1,1}<span class="keyword">...</span>
0264                 .ATTRIBUTE.position);
0265             pathway.listOfReactions(i).componentList(counter).anchor(1)=x;
0266             pathway.listOfReactions(i).componentList(counter).anchor(2)=y;
0267             pathway.listOfReactions(i).componentList(counter).baseReactant=<span class="string">'false'</span>;
0268             pathway.listOfReactions(i).componentList(counter).baseProduct=<span class="string">'false'</span>;
0269             pathway.listOfReactions(i).componentList(counter).toArrow=<span class="string">'true'</span>;
0270             pathway.listOfReactions(i).componentList(counter).fromArrow=<span class="string">'false'</span>;
0271             pathway.listOfReactions(i).componentList(counter).type=<span class="string">'METABOLITE'</span>;
0272             counter=counter+1;
0273         <span class="keyword">end</span>
0274     <span class="keyword">end</span>
0275     
0276     <span class="comment">%Adds the modifiers (enzymes) Not all reactions have any modifiers</span>
0277     <span class="keyword">if</span> isfield(v.model{1,1}.listOfReactions{1,1}.reaction{1,i}.annotation{1,1}<span class="keyword">...</span>
0278             ,<span class="string">'listOfModification'</span>)
0279         <span class="keyword">for</span> j=1:length(v.model{1,1}.listOfReactions{1,1}.reaction{1,i}.annotation{1,1}<span class="keyword">...</span>
0280                 .listOfModification{1,1}.modification)
0281             pathway.listOfReactions(i).componentList(counter).alias=v.model{1,1}<span class="keyword">...</span>
0282                 .listOfReactions{1,1}.reaction{1,i}.annotation{1,1}.listOfModification{1,1}<span class="keyword">...</span>
0283                 .modification{1,j}.linkTarget{1,1}.ATTRIBUTE.alias;
0284             pathway.listOfReactions(i).componentList(counter).species=v.model{1,1}<span class="keyword">...</span>
0285                 .listOfReactions{1,1}.reaction{1,i}.annotation{1,1}.listOfModification{1,1}<span class="keyword">...</span>
0286                 .modification{1,j}.linkTarget{1,1}.ATTRIBUTE.species;
0287             [x,y]=<a href="#_sub1" class="code" title="subfunction [x,y]=getBindingPos(pathway,speciesAlias,bindingSite)">getBindingPos</a>(pathway,pathway.listOfReactions(i).componentList(counter).alias<span class="keyword">...</span>
0288                 ,v.model{1,1}.listOfReactions{1,1}.reaction{1,i}.annotation{1,1}<span class="keyword">...</span>
0289                 .listOfModification{1,1}.modification{1,j}.linkTarget{1,1}<span class="keyword">...</span>
0290                 .linkAnchor{1,1}.ATTRIBUTE.position);
0291             pathway.listOfReactions(i).componentList(counter).anchor(1)=x;
0292             pathway.listOfReactions(i).componentList(counter).anchor(2)=y;
0293             pathway.listOfReactions(i).componentList(counter).baseReactant=<span class="string">'false'</span>;
0294             pathway.listOfReactions(i).componentList(counter).baseProduct=<span class="string">'false'</span>;
0295             pathway.listOfReactions(i).componentList(counter).toArrow=<span class="string">'false'</span>;
0296             pathway.listOfReactions(i).componentList(counter).fromArrow=<span class="string">'false'</span>;
0297             pathway.listOfReactions(i).componentList(counter).type=<span class="string">'ENZYME'</span>;
0298             counter=counter+1;
0299         <span class="keyword">end</span>
0300     <span class="keyword">end</span>
0301 <span class="keyword">end</span>
0302 <span class="keyword">end</span>
0303 
0304 <a name="_sub1" href="#_subfunctions" class="code">function [x,y]=getBindingPos(pathway,speciesAlias,bindingSite)</a>
0305 <span class="comment">% getBindingPos</span>
0306 <span class="comment">%   Calculates the position of a given binding site for a specified species</span>
0307 <span class="comment">%</span>
0308 <span class="comment">%   pathway         the pathway structure which should be modified</span>
0309 <span class="comment">%   speciesAlias    the alias of the species bindingSite     The binding</span>
0310 <span class="comment">%   site in Celldesigner is a string of up to</span>
0311 <span class="comment">%                   three letters that defines which of the 16 bindings</span>
0312 <span class="comment">%                   sites on each species to use. They are written as N</span>
0313 <span class="comment">%                   (north), NNW (north north west) and so on</span>
0314 <span class="comment">%</span>
0315 <span class="comment">%   [x, y]          The position of the binding site for the species</span>
0316 <span class="comment">%</span>
0317 <span class="comment">%   Usage: [x,y]=getBindingPos(pathway,speciesAlias,bindingSite)</span>
0318 
0319 <span class="comment">%Find the species</span>
0320 <span class="keyword">for</span> i=1:length(pathway.listOfSpecies)
0321     <span class="keyword">if</span> strcmpi(pathway.listOfSpecies(i).alias,speciesAlias)
0322         xpos=pathway.listOfSpecies(i).x;
0323         ypos=pathway.listOfSpecies(i).y;
0324         h=pathway.listOfSpecies(i).h;
0325         w=pathway.listOfSpecies(i).w;
0326         
0327         <span class="comment">%Species marked as &quot;PROTEIN&quot; should be drawn as rectangles. There</span>
0328         <span class="comment">%is one binding site in each corner and three in between on each</span>
0329         <span class="comment">%side.</span>
0330         <span class="keyword">if</span> strcmpi(pathway.listOfSpecies(i).type,<span class="string">'PROTEIN'</span>)
0331             <span class="comment">%The binding sites clockwise from the top position</span>
0332             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'N'</span>)
0333                 x=xpos+0.5*w;
0334                 y=ypos;
0335                 <span class="keyword">break</span>;
0336             <span class="keyword">end</span>
0337             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'NNE'</span>)
0338                 x=xpos+0.75*w;
0339                 y=ypos;
0340                 <span class="keyword">break</span>;
0341             <span class="keyword">end</span>
0342             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'NE'</span>)
0343                 x=xpos+w;
0344                 y=ypos;
0345                 <span class="keyword">break</span>;
0346             <span class="keyword">end</span>
0347             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'ENE'</span>)
0348                 x=xpos+w;
0349                 y=ypos+0.25*h;
0350                 <span class="keyword">break</span>;
0351             <span class="keyword">end</span>
0352             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'E'</span>)
0353                 x=xpos+w;
0354                 y=ypos+0.5*h;
0355                 <span class="keyword">break</span>;
0356             <span class="keyword">end</span>
0357             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'ESE'</span>)
0358                 x=xpos+w;
0359                 y=ypos+0.75*h;
0360                 <span class="keyword">break</span>;
0361             <span class="keyword">end</span>
0362             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'SE'</span>)
0363                 x=xpos+w;
0364                 y=ypos+h;
0365                 <span class="keyword">break</span>;
0366             <span class="keyword">end</span>
0367             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'SSE'</span>)
0368                 x=xpos+0.75*w;
0369                 y=ypos+h;
0370                 <span class="keyword">break</span>;
0371             <span class="keyword">end</span>
0372             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'S'</span>)
0373                 x=xpos+0.5*w;
0374                 y=ypos+h;
0375                 <span class="keyword">break</span>;
0376             <span class="keyword">end</span>
0377             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'SSW'</span>)
0378                 x=xpos+0.25*w;
0379                 y=ypos+h;
0380                 <span class="keyword">break</span>;
0381             <span class="keyword">end</span>
0382             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'SW'</span>)
0383                 x=xpos;
0384                 y=ypos+h;
0385                 <span class="keyword">break</span>;
0386             <span class="keyword">end</span>
0387             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'WSW'</span>)
0388                 x=xpos;
0389                 y=ypos+0.75*h;
0390                 <span class="keyword">break</span>;
0391             <span class="keyword">end</span>
0392             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'W'</span>)
0393                 x=xpos;
0394                 y=ypos+0.5*h;
0395                 <span class="keyword">break</span>;
0396             <span class="keyword">end</span>
0397             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'WNW'</span>)
0398                 x=xpos;
0399                 y=ypos+0.25*h;
0400                 <span class="keyword">break</span>;
0401             <span class="keyword">end</span>
0402             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'NW'</span>)
0403                 x=xpos;
0404                 y=ypos;
0405                 <span class="keyword">break</span>;
0406             <span class="keyword">end</span>
0407             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'NNW'</span>)
0408                 x=xpos+0.25*w;
0409                 y=ypos;
0410                 <span class="keyword">break</span>;
0411             <span class="keyword">end</span>
0412         <span class="keyword">end</span>
0413         
0414         <span class="comment">%Species marked as &quot;SIMPLE_MOLECULE&quot; should be drawn as ellipses.</span>
0415         <span class="comment">%There is one binding site in each extreme point and three in</span>
0416         <span class="comment">%between on each side</span>
0417         <span class="keyword">if</span> strcmpi(pathway.listOfSpecies(i).type,<span class="string">'SIMPLE_MOLECULE'</span>)
0418             <span class="comment">%Find the center of the ellipse</span>
0419             centerX=xpos+0.5*w;
0420             centerY=ypos+0.5*h;
0421             
0422             <span class="comment">%The binding sites clockwise from the top position</span>
0423             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'N'</span>)
0424                 angle=(4/8)*pi;
0425             <span class="keyword">end</span>
0426             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'NNE'</span>)
0427                 angle=(5/8)*pi;
0428             <span class="keyword">end</span>
0429             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'NE'</span>)
0430                 angle=(6/8)*pi;
0431             <span class="keyword">end</span>
0432             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'ENE'</span>)
0433                 angle=(7/8)*pi;
0434             <span class="keyword">end</span>
0435             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'E'</span>)
0436                 angle=(8/8)*pi;
0437             <span class="keyword">end</span>
0438             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'ESE'</span>)
0439                 angle=(9/8)*pi;
0440             <span class="keyword">end</span>
0441             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'SE'</span>)
0442                 angle=(10/8)*pi;
0443             <span class="keyword">end</span>
0444             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'SSE'</span>)
0445                 angle=(11/8)*pi;
0446             <span class="keyword">end</span>
0447             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'S'</span>)
0448                 angle=(12/8)*pi;
0449             <span class="keyword">end</span>
0450             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'SSW'</span>)
0451                 angle=(13/8)*pi;
0452             <span class="keyword">end</span>
0453             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'SW'</span>)
0454                 angle=(14/8)*pi;
0455             <span class="keyword">end</span>
0456             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'WSW'</span>)
0457                 angle=(15/8)*pi;
0458             <span class="keyword">end</span>
0459             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'W'</span>)
0460                 angle=(16/8)*pi;
0461             <span class="keyword">end</span>
0462             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'WNW'</span>)
0463                 angle=(1/8)*pi;
0464             <span class="keyword">end</span>
0465             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'NW'</span>)
0466                 angle=(2/8)*pi;
0467             <span class="keyword">end</span>
0468             <span class="keyword">if</span> strcmpi(bindingSite,<span class="string">'NNW'</span>)
0469                 angle=(3/8)*pi;
0470             <span class="keyword">end</span>
0471             x=centerX-(0.5*w)*cos(angle);
0472             y=centerY-(0.5*h)*sin(angle);
0473             <span class="keyword">break</span>;
0474         <span class="keyword">end</span>
0475     <span class="keyword">end</span>
0476 <span class="keyword">end</span>
0477 <span class="keyword">end</span></pre></div>
<hr><address>Generated by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>
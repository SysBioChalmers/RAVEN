<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of getFluxZ</title>
  <meta name="keywords" content="getFluxZ">
  <meta name="description" content="getFluxZ">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../index.html">Home</a> &gt;  <a href="index.html">RAVEN</a> &gt; getFluxZ.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../index.html"><img alt="<" border="0" src="../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for RAVEN&nbsp;<img alt=">" border="0" src="../right.png"></a></td></tr></table>-->

<h1>getFluxZ
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>getFluxZ</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function Z=getFluxZ(solutionsA, solutionsB) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> getFluxZ
   Calculates the Z scores between two sets of random flux distributions.

   solutionsA      random solutions for the reference condition (as
                   generated by randomSampling)
   solutionsB      random solutions for the test condition (as generated
                   by randomSampling)

   Z               a vector with Z-scores that tells you for each reaction
                   how likely it is for its flux to have increased (positive sign) 
                   or decreased (negative sign) in the second condition with
                   respect to the first.

   Usage: Z=getFluxZ(solutionsA, solutionsB)

   Rasmus Agren, 2013-08-01</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="dispEM.html" class="code" title="function dispEM(string,throwErrors,toList,trimWarnings)">dispEM</a>	dispEM</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="analyzeSampling.html" class="code" title="function scores=analyzeSampling(Tex, df, solutionsA, solutionsB, printResults)">analyzeSampling</a>	analyzeSampling</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function Z=getFluxZ(solutionsA, solutionsB)</a>
0002 <span class="comment">% getFluxZ</span>
0003 <span class="comment">%   Calculates the Z scores between two sets of random flux distributions.</span>
0004 <span class="comment">%</span>
0005 <span class="comment">%   solutionsA      random solutions for the reference condition (as</span>
0006 <span class="comment">%                   generated by randomSampling)</span>
0007 <span class="comment">%   solutionsB      random solutions for the test condition (as generated</span>
0008 <span class="comment">%                   by randomSampling)</span>
0009 <span class="comment">%</span>
0010 <span class="comment">%   Z               a vector with Z-scores that tells you for each reaction</span>
0011 <span class="comment">%                   how likely it is for its flux to have increased (positive sign)</span>
0012 <span class="comment">%                   or decreased (negative sign) in the second condition with</span>
0013 <span class="comment">%                   respect to the first.</span>
0014 <span class="comment">%</span>
0015 <span class="comment">%   Usage: Z=getFluxZ(solutionsA, solutionsB)</span>
0016 <span class="comment">%</span>
0017 <span class="comment">%   Rasmus Agren, 2013-08-01</span>
0018 <span class="comment">%</span>
0019 
0020 nRxns=size(solutionsA,1);
0021 
0022 <span class="comment">%Check that the number of reactions is the same in both cases</span>
0023 <span class="keyword">if</span> nRxns~=size(solutionsB,1)
0024     <a href="dispEM.html" class="code" title="function dispEM(string,throwErrors,toList,trimWarnings)">dispEM</a>(<span class="string">'The number of reactions must be the same in solutionsA as in solutionsB'</span>); 
0025 <span class="keyword">end</span>
0026 
0027 Z=zeros(nRxns,1);
0028 
0029 <span class="comment">%Calculate the mean and standard deviation for the two cases</span>
0030 mA=mean(solutionsA,2);
0031 mB=mean(solutionsB,2);
0032 
0033 <span class="comment">%This can lead to OUT OF MEMORY, so do it in segments of 500 reactions</span>
0034 varA=zeros(size(solutionsA,1),1);
0035 <span class="keyword">for</span> i=1:500:size(solutionsA,1)
0036     varA(i:min(i+499,size(solutionsA,1)))=var(solutionsA(i:min(i+499,size(solutionsA,1)),:),0,2);
0037 <span class="keyword">end</span>
0038 varB=zeros(size(solutionsB,1),1);
0039 <span class="keyword">for</span> i=1:500:size(solutionsB,1)
0040     varB(i:min(i+499,size(solutionsB,1)))=var(solutionsB(i:min(i+499,size(solutionsB,1)),:),0,2);
0041 <span class="keyword">end</span>
0042 
0043 <span class="comment">%If the mean of both solutions are the same then the Z-score is zero</span>
0044 toCheck=mA~=mB;
0045     
0046 <span class="comment">%If the variance is zero in both cases, then put a very large or very small</span>
0047 <span class="comment">%Z-score for the corresponding reactions</span>
0048 I=find(varA==0 &amp; varB==0 &amp; toCheck==true);
0049 toCheck(I)=false;
0050 J=mA(I)&gt;mB(I);
0051 Z(I(J))=100;
0052 Z(I(~J))=-100;
0053 toCheck=find(toCheck);
0054 
0055 <span class="keyword">for</span> i=1:numel(toCheck)
0056     Z(toCheck(i))=(mB(toCheck(i))-mA(toCheck(i)))/sqrt(varA(toCheck(i))+varB(toCheck(i)));
0057 <span class="keyword">end</span>
0058 
0059 <span class="comment">%Shrink very large values</span>
0060 Z=min(Z,100);
0061 Z=max(Z,-100);
0062 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Mon 06-Jan-2014 14:58:12 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>
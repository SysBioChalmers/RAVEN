<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of getEnzymesFromMetaCyc</title>
  <meta name="keywords" content="getEnzymesFromMetaCyc">
  <meta name="description" content="getEnzymesFromMetaCyc">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="../index.html">external</a> &gt; <a href="index.html">metacyc</a> &gt; getEnzymesFromMetaCyc.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for external\metacyc&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>getEnzymesFromMetaCyc
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>getEnzymesFromMetaCyc</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function metaCycEnzymes=getEnzymesFromMetaCyc(metacycPath) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> getEnzymesFromMetaCyc
    Retrieves all enzymes and reaction-enzyme association information in MetaCyc

   Input:
    metacycPath  if metaCycEnzymes.mat is not in the RAVEN\external\metacyc
                directory, this function will attempt to build it by reading
                info from a local dump of MetaCyc database, and metacycPath
                is the path to the MetaCyc data files

   Output:
    model        a model structure generated from the database. The following
                fields are filled
                id:             'MetaCyc'
                name:    'Automatically generated from MetaCyc database'
                rxns:           Reaction id
                rxnNames:       Reaction name
                enzymes:        Enzyme id
                enzrxns:        Enzymatic-reaction id
                cplxs:          Enzyme complexes
                cplxComp:       Subunit components of enzyme complexes
                rxnEnzymeMat    A binary matrix that indicates association of a
                                specific enzyme to the reactions it catalyze
                version:        MetaCyc database version

    If the file metaCycEnzymes.mat is in the RAVEN\external\metacyc directory
    it will be loaded. Otherwise, it will be generated by parsing the MetaCyc
    database files. In general, this metaCycEnzymes.mat file should be removed
    and rebuilt when a newer version of MetaCyc is released.

    Usage: model=getEnzymesFromMetaCyc(metacycPath)

NOTE: This is how one entry looks in the files</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="getModelFromMetaCyc.html" class="code" title="function metaCycModel=getModelFromMetaCyc(metacycPath,keepTransportRxns,keepUnbalanced,keepUndetermined)">getModelFromMetaCyc</a>	getModelFromMetaCyc</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function metaCycEnzymes=getEnzymesFromMetaCyc(metacycPath)</a>
0002 <span class="comment">% getEnzymesFromMetaCyc</span>
0003 <span class="comment">%    Retrieves all enzymes and reaction-enzyme association information in MetaCyc</span>
0004 <span class="comment">%</span>
0005 <span class="comment">%   Input:</span>
0006 <span class="comment">%    metacycPath  if metaCycEnzymes.mat is not in the RAVEN\external\metacyc</span>
0007 <span class="comment">%                directory, this function will attempt to build it by reading</span>
0008 <span class="comment">%                info from a local dump of MetaCyc database, and metacycPath</span>
0009 <span class="comment">%                is the path to the MetaCyc data files</span>
0010 <span class="comment">%</span>
0011 <span class="comment">%   Output:</span>
0012 <span class="comment">%    model        a model structure generated from the database. The following</span>
0013 <span class="comment">%                fields are filled</span>
0014 <span class="comment">%                id:             'MetaCyc'</span>
0015 <span class="comment">%                name:    'Automatically generated from MetaCyc database'</span>
0016 <span class="comment">%                rxns:           Reaction id</span>
0017 <span class="comment">%                rxnNames:       Reaction name</span>
0018 <span class="comment">%                enzymes:        Enzyme id</span>
0019 <span class="comment">%                enzrxns:        Enzymatic-reaction id</span>
0020 <span class="comment">%                cplxs:          Enzyme complexes</span>
0021 <span class="comment">%                cplxComp:       Subunit components of enzyme complexes</span>
0022 <span class="comment">%                rxnEnzymeMat    A binary matrix that indicates association of a</span>
0023 <span class="comment">%                                specific enzyme to the reactions it catalyze</span>
0024 <span class="comment">%                version:        MetaCyc database version</span>
0025 <span class="comment">%</span>
0026 <span class="comment">%    If the file metaCycEnzymes.mat is in the RAVEN\external\metacyc directory</span>
0027 <span class="comment">%    it will be loaded. Otherwise, it will be generated by parsing the MetaCyc</span>
0028 <span class="comment">%    database files. In general, this metaCycEnzymes.mat file should be removed</span>
0029 <span class="comment">%    and rebuilt when a newer version of MetaCyc is released.</span>
0030 <span class="comment">%</span>
0031 <span class="comment">%    Usage: model=getEnzymesFromMetaCyc(metacycPath)</span>
0032 <span class="comment">%</span>
0033 <span class="comment">%NOTE: This is how one entry looks in the files</span>
0034 
0035 <span class="comment">%proteins.dat</span>
0036 <span class="comment">% UNIQUE-ID - MONOMER-8570</span>
0037 <span class="comment">% TYPES - Polypeptides</span>
0038 <span class="comment">% COMMON-NAME - D-carnitine dehydrogenase subunit</span>
0039 <span class="comment">% COMPONENT-OF - CPLX-5143</span>
0040 <span class="comment">% MOLECULAR-WEIGHT-EXP - 23</span>
0041 <span class="comment">% MOLECULAR-WEIGHT-KD - 23</span>
0042 <span class="comment">% SPECIES - ORG-6256</span>
0043 <span class="comment">% //</span>
0044 
0045 <span class="comment">%enzrxns.dat</span>
0046 <span class="comment">% UNIQUE-ID - ENZRXN-14974</span>
0047 <span class="comment">% TYPES - Enzymatic-Reactions</span>
0048 <span class="comment">% COMMON-NAME - (1S,4R)-iso-dihydrocarvone monooxygenase</span>
0049 <span class="comment">% BASIS-FOR-ASSIGNMENT - :MANUAL</span>
0050 <span class="comment">% CITATIONS - 10769172:EV-EXP-IDA-PURIFIED-PROTEIN:3419689584:caspi</span>
0051 <span class="comment">% COFACTORS - FAD</span>
0052 <span class="comment">% ENZYME - MONOMER-13964</span>
0053 <span class="comment">% PHYSIOLOGICALLY-RELEVANT? - T</span>
0054 <span class="comment">% REACTION - RXN-9435</span>
0055 <span class="comment">% REGULATED-BY - REG-12241</span>
0056 <span class="comment">% REGULATED-BY - REG-12240</span>
0057 <span class="comment">% TEMPERATURE-OPT - 35</span>
0058 
0059 <span class="comment">% A line that contains only '//' separates each object.</span>
0060 
0061 <span class="keyword">if</span> nargin&lt;1
0062     ravenPath=findRAVENroot();
0063     metacycPath=fullfile(ravenPath,<span class="string">'external'</span>,<span class="string">'metacyc'</span>);
0064 <span class="keyword">else</span>
0065     metacycPath=char(metacycPath);
0066 <span class="keyword">end</span>
0067 
0068 <span class="comment">%Check if the enzymatic proteins have been parsed before and saved. If so,</span>
0069 <span class="comment">%load the model.</span>
0070 enzymesFile=fullfile(metacycPath,<span class="string">'metaCycEnzymes.mat'</span>);
0071 metaCycProteinFile=<span class="string">'proteins.dat'</span>;
0072 metaCycEnzrxnsFile=<span class="string">'enzrxns.dat'</span>;
0073 
0074 <span class="keyword">try</span>
0075     ([<span class="string">'Importing MetaCyc enzymes and reaction-enzyme association from '</span> strrep(enzymesFile,<span class="string">'\'</span>,<span class="string">'/'</span>) <span class="string">'... '</span>]);
0076     load(enzymesFile);
0077     fprintf(<span class="string">'done\n'</span>);
0078 <span class="keyword">catch</span>
0079     fprintf([<span class="string">'Cannot locate '</span> strrep(enzymesFile,<span class="string">'\'</span>,<span class="string">'/'</span>) <span class="string">'\nNow try to generate it from local MetaCyc data files...\n'</span>]);
0080     <span class="keyword">if</span> ~exist(fullfile(metacycPath,metaCycProteinFile),<span class="string">'file'</span>) || ~exist(fullfile(metacycPath,metaCycEnzrxnsFile),<span class="string">'file'</span>)
0081         EM=fprintf([<span class="string">'The files of enzymes or proteins cannot be located, and should be downloaded from MetaCyc.\n'</span>]);
0082         dispEM(EM);
0083     <span class="keyword">else</span>
0084         metaCycEnzymes.id=<span class="string">'MetaCyc'</span>;
0085         metaCycEnzymes.name=<span class="string">'Automatically generated from MetaCyc database'</span>;
0086         
0087         <span class="comment">%Reserve space for 10000 enzyme complexs</span>
0088         metaCycEnzymes.cplxs=cell(10000,1);
0089         metaCycEnzymes.cplxComp=cell(10000,1);
0090         metaCycEnzymes.enzymes=cell(50000,1);
0091         
0092         <span class="comment">%Get the information of protein complexes and their components</span>
0093         nCplx=0;
0094         enzymeCounter=0;
0095         
0096         fid = fopen(fullfile(metacycPath,metaCycProteinFile), <span class="string">'r'</span>);
0097         <span class="comment">%Loop through the file</span>
0098         <span class="keyword">while</span> 1
0099             tline = fgetl(fid);
0100             
0101             <span class="comment">%Abort at end of file</span>
0102             <span class="keyword">if</span> ~ischar(tline)
0103                 <span class="keyword">break</span>;
0104             <span class="keyword">end</span>
0105             
0106             <span class="comment">%Add Enzyme id</span>
0107             <span class="keyword">if</span> numel(tline)&gt;12 &amp;&amp; strcmp(tline(1:12),<span class="string">'UNIQUE-ID - '</span>)
0108                 enzymeCounter=enzymeCounter+1;
0109                 addMe=false;
0110                 enzymeID=tline(13:end);
0111                 metaCycEnzymes.enzymes{enzymeCounter}=enzymeID;
0112             <span class="keyword">end</span>
0113             
0114             <span class="comment">%Check if enzyme complexes</span>
0115             <span class="keyword">if</span> strcmp(tline(1:end),<span class="string">'TYPES - Protein-Complexes'</span>)
0116                 nCplx=nCplx+1;
0117                 nComp=0;
0118                 
0119                 <span class="comment">%Reserve 100 subunits for each enzyme complex</span>
0120                 Comp.subunit=cell(100,1);
0121                 metaCycEnzymes.cplxs{nCplx}=enzymeID;
0122                 
0123                 addMe=true;
0124             <span class="keyword">end</span>
0125             
0126             <span class="keyword">if</span> numel(tline)&gt;13 &amp;&amp; strcmp(tline(1:13),<span class="string">'COMPONENTS - '</span>)
0127                 <span class="keyword">if</span> addMe
0128                     nComp=nComp+1;
0129                     Comp.subunit{nComp}=tline(14:end);
0130                 <span class="keyword">end</span>
0131             <span class="keyword">end</span>
0132             
0133             <span class="keyword">if</span> strcmp(tline(1:end),<span class="string">'//'</span>)
0134                 <span class="keyword">if</span> addMe
0135                     Comp.subunit=Comp.subunit(1:nComp);
0136                     metaCycEnzymes.cplxComp{nCplx}=Comp;
0137                     addMe=false;
0138                 <span class="keyword">end</span>
0139             <span class="keyword">end</span>
0140         <span class="keyword">end</span>
0141         <span class="comment">%Close the file</span>
0142         fclose(fid);
0143         
0144         <span class="comment">%If too much space was allocated, shrink the model</span>
0145         metaCycEnzymes.cplxs=metaCycEnzymes.cplxs(1:nCplx);
0146         metaCycEnzymes.cplxComp=metaCycEnzymes.cplxComp(1:nCplx);
0147         metaCycEnzymes.enzymes=metaCycEnzymes.enzymes(1:enzymeCounter);
0148         
0149         <span class="comment">% Iteratively go through the components of each complex</span>
0150         <span class="keyword">for</span> i=1:numel(metaCycEnzymes.cplxComp)
0151             
0152             <span class="comment">%replace all complex-type components with their subunits</span>
0153             checkCplx=true;
0154             <span class="keyword">while</span> checkCplx
0155                 x=0;
0156                 mat=[]; <span class="comment">%Matrix for component of protein-complexs</span>
0157                 <span class="keyword">for</span> j=1:numel(metaCycEnzymes.cplxComp{i}.subunit)
0158                     [a, b]=ismember(metaCycEnzymes.cplxComp{i}.subunit{j},metaCycEnzymes.cplxs);
0159                     <span class="keyword">if</span> a
0160                         x=x+1;   <span class="comment">%record this value j, and the cplx id b</span>
0161                         mat(x,:)=[j b];
0162                     <span class="keyword">end</span>
0163                 <span class="keyword">end</span>
0164                 
0165                 <span class="keyword">if</span> isempty(mat)
0166                     checkCplx=false; <span class="comment">% No complexs found among components</span>
0167                 <span class="keyword">else</span>
0168                     <span class="comment">%go through matrix JB</span>
0169                     <span class="keyword">for</span> k=1:x
0170                         <span class="comment">%disp(metaCycEnzymes.cplxComp{i}.subunit{mat(k,1)});</span>
0171                         metaCycEnzymes.cplxComp{i}.subunit(mat(k,1))=[];
0172                         metaCycEnzymes.cplxComp{i}.subunit=[metaCycEnzymes.cplxComp{i}.subunit; metaCycEnzymes.cplxComp{mat(k,2)}.subunit];
0173                     <span class="keyword">end</span>
0174                 <span class="keyword">end</span>
0175                 
0176             <span class="keyword">end</span>
0177             
0178             <span class="comment">% make sure the subunits are all included in the enzyme list</span>
0179             <span class="comment">% since in one case subunit was not found in enzyme dump file</span>
0180             [a, b] = ismember(metaCycEnzymes.cplxComp{i}.subunit,metaCycEnzymes.enzymes);
0181             <span class="keyword">if</span> ~all(a)
0182                 metaCycEnzymes.cplxComp{i}.subunit = metaCycEnzymes.enzymes(b(find(a)));
0183             <span class="keyword">end</span>
0184         <span class="keyword">end</span>
0185         
0186         <span class="comment">%Preallocate space for 500000 enzymatic reactions</span>
0187         metaCycEnzymes.enzrxns=cell(50000,1);
0188         metaCycEnzymes.rxns=cell(50000,1);
0189         metaCycEnzymes.rxnNames=cell(50000,1);
0190         metaCycEnzymes.commoname=cell(50000,1);
0191         metaCycEnzymes.rxnEnzymeMat=sparse(50000,enzymeCounter); <span class="comment">% row: rxn, column: enzymes</span>
0192         
0193         <span class="comment">%Load enzyme and reaction association information</span>
0194         fid = fopen(fullfile(metacycPath,metaCycEnzrxnsFile), <span class="string">'r'</span>);
0195         
0196         <span class="comment">%Keeps track of how many enzymes and reactions have been added</span>
0197         enzrxnCounter=0;
0198         nRxn=0;
0199         
0200         <span class="comment">%These contain the mapping between Reactions and Enzymes Loop</span>
0201         <span class="comment">%through the file</span>
0202         <span class="keyword">while</span> 1
0203             tline = fgetl(fid);
0204             
0205             <span class="comment">%Abort at end of file</span>
0206             <span class="keyword">if</span> ~ischar(tline)
0207                 <span class="keyword">break</span>;
0208             <span class="keyword">end</span>
0209 
0210             <span class="comment">% Get the version of MetaCyc database</span>
0211             <span class="keyword">if</span> numel(tline)&gt;11 &amp;&amp; strcmp(tline(1:11),<span class="string">'# Version: '</span>)
0212                 metaCycEnzymes.version=tline(12:end);
0213             <span class="keyword">end</span>
0214 
0215             <span class="comment">%Check if it is a new enzymatic reaction</span>
0216             <span class="keyword">if</span> numel(tline)&gt;12 &amp;&amp; strcmp(tline(1:12),<span class="string">'UNIQUE-ID - '</span>)
0217                 enzrxnCounter=enzrxnCounter+1;
0218                 metaCycEnzymes.enzrxns{enzrxnCounter}=tline(13:end);
0219                 metaCycEnzymes.commoname{enzrxnCounter}=<span class="string">''</span>;
0220             <span class="keyword">end</span>
0221             
0222             <span class="comment">%Add common name of enzymatic reactions</span>
0223             <span class="keyword">if</span> numel(tline)&gt;14 &amp;&amp; strcmp(tline(1:14),<span class="string">'COMMON-NAME - '</span>)
0224                 metaCycEnzymes.commoname{enzrxnCounter}=tline(15:end);
0225                 
0226                 <span class="comment">%Remove HTML symobls</span>
0227                 metaCycEnzymes.commoname{enzrxnCounter}=regexprep(metaCycEnzymes.commoname{enzrxnCounter},<span class="string">'&lt;(\w+)&gt;'</span>,<span class="string">''</span>);
0228                 metaCycEnzymes.commoname{enzrxnCounter}=regexprep(metaCycEnzymes.commoname{enzrxnCounter},<span class="string">'&lt;/(\w+)&gt;'</span>,<span class="string">''</span>);
0229                 metaCycEnzymes.commoname{enzrxnCounter}=regexprep(metaCycEnzymes.commoname{enzrxnCounter},<span class="string">'[&amp;;]'</span>,<span class="string">''</span>);
0230             <span class="keyword">end</span>
0231             
0232             <span class="comment">% I add one cell array rxns for checking existing ones by</span>
0233             <span class="comment">% ismember because I cannot manage field rxns in this function</span>
0234             
0235             <span class="comment">%Add enzyme name</span>
0236             <span class="keyword">if</span> numel(tline)&gt;9 &amp;&amp; strcmp(tline(1:9),<span class="string">'ENZYME - '</span>)
0237                 
0238                 <span class="comment">%Save the index in enzymes field to nEnzyme</span>
0239                 [x, nEnzyme]=ismember(tline(10:end),metaCycEnzymes.enzymes);
0240                 <span class="keyword">if</span> ~x
0241                     <span class="comment">%disp(tline(10:end));</span>
0242                 <span class="keyword">end</span>
0243             <span class="keyword">end</span>
0244             
0245             <span class="comment">%Add reaction id, and rxnNames by concatenating unique common</span>
0246             <span class="comment">%names</span>
0247             <span class="keyword">if</span> numel(tline)&gt;11 &amp;&amp; strcmp(tline(1:11),<span class="string">'REACTION - '</span>)
0248                 nRxn=nRxn+1;
0249                 rxns{nRxn}=<span class="string">''</span>;
0250                 rxnID=tline(12:end);
0251                 [c, d]=ismember(rxnID,rxns);
0252                 <span class="keyword">if</span> c
0253                     nRxn=nRxn-1;
0254                     
0255                     <span class="comment">%Check if this common name has been included by</span>
0256                     <span class="comment">%rxnNames</span>
0257                     k=strfind(metaCycEnzymes.rxnNames{d},metaCycEnzymes.commoname{enzrxnCounter});
0258                     <span class="keyword">if</span> isempty(k)
0259                         metaCycEnzymes.rxnNames{d}=strcat(metaCycEnzymes.rxnNames{d},<span class="string">';'</span>,metaCycEnzymes.commoname{enzrxnCounter});
0260                     <span class="keyword">end</span>
0261                     metaCycEnzymes.rxnEnzymeMat(d,nEnzyme)=1;
0262                 <span class="keyword">else</span>
0263                     metaCycEnzymes.rxns{nRxn}=rxnID;
0264                     metaCycEnzymes.rxnNames{nRxn}=metaCycEnzymes.commoname{enzrxnCounter};
0265                     rxns{nRxn}=rxnID;
0266                     metaCycEnzymes.rxnEnzymeMat(nRxn,nEnzyme)=1;
0267                 <span class="keyword">end</span>
0268             <span class="keyword">end</span>
0269             
0270         <span class="keyword">end</span>
0271         
0272         <span class="comment">%Close the file</span>
0273         fclose(fid);
0274         
0275         <span class="comment">%Shrink the sizes</span>
0276         metaCycEnzymes.enzrxns=metaCycEnzymes.enzrxns(1:enzrxnCounter);
0277         metaCycEnzymes.commoname=metaCycEnzymes.commoname(1:enzrxnCounter);
0278         metaCycEnzymes.rxns=metaCycEnzymes.rxns(1:nRxn);
0279         metaCycEnzymes.rxnNames=metaCycEnzymes.rxnNames(1:nRxn);
0280         metaCycEnzymes.rxnEnzymeMat=metaCycEnzymes.rxnEnzymeMat(1:nRxn,:);
0281         
0282         <span class="comment">%Save the model structure</span>
0283         save(enzymesFile,<span class="string">'metaCycEnzymes'</span>);
0284         fprintf([<span class="string">'New metaCycEnzymes.mat has been successfully updated!\n\n'</span>]);
0285     <span class="keyword">end</span>
0286     
0287 <span class="keyword">end</span>
0288 <span class="keyword">end</span></pre></div>
<hr><address>Generated by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>
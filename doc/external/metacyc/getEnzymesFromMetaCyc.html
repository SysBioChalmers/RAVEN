<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of getEnzymesFromMetaCyc</title>
  <meta name="keywords" content="getEnzymesFromMetaCyc">
  <meta name="description" content="getEnzymesFromMetaCyc">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="../index.html">external</a> &gt; <a href="index.html">metacyc</a> &gt; getEnzymesFromMetaCyc.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for external\metacyc&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>getEnzymesFromMetaCyc
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>getEnzymesFromMetaCyc</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function metaCycEnzymes=getEnzymesFromMetaCyc(metacycPath) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> getEnzymesFromMetaCyc
   Retrieves all enzymes and reaction-enzyme association information in MetaCyc

   metacycPath  if metaCycEnzymes.mat is not in the RAVEN\external\metacyc
                directory, this function will attempt to read data from a local
                dump of the MetaCyc database. metacycPath is the path to the
                root of this database

   model        a model structure generated from the database. The following
                fields are filled
                id:             'MetaCyc'
                description:    'Automatically generated from MetaCyc database'
                rxns:           Reaction id
                rxnNames:       Reaction name
                enzymes:        Enzyme id
                enzrxns:        Enzymatic-reaction id
                cplxs:          Enzyme complexes
                cplxComp:       Subunit components of enzyme complexes
                rxnEnzymeMat    A binary matrix that indicates association of a
                                specific enzyme to the reactions it catalyze

   If the file metaCycEnzymes.mat is in the RAVEN\external\metacyc directory
   it will be loaded. Otherwise, it will be generated by parsing the MetaCyc
   database files. In general, this metaCycEnzymes.mat file should be removed
   and rebuilt when a newer version of MetaCyc is released.

   Usage: model=getEnzymesFromMetaCyc(metacycPath)

   Hao Wang, 2017-06-17</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="getModelFromMetaCyc.html" class="code" title="function metaCycModel=getModelFromMetaCyc(metacycPath,keepTransportRxns,keepUnbalanced,keepUndetermined)">getModelFromMetaCyc</a>	getModelFromMetaCyc</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function metaCycEnzymes=getEnzymesFromMetaCyc(metacycPath)</a>
0002 <span class="comment">% getEnzymesFromMetaCyc</span>
0003 <span class="comment">%   Retrieves all enzymes and reaction-enzyme association information in MetaCyc</span>
0004 <span class="comment">%</span>
0005 <span class="comment">%   metacycPath  if metaCycEnzymes.mat is not in the RAVEN\external\metacyc</span>
0006 <span class="comment">%                directory, this function will attempt to read data from a local</span>
0007 <span class="comment">%                dump of the MetaCyc database. metacycPath is the path to the</span>
0008 <span class="comment">%                root of this database</span>
0009 <span class="comment">%</span>
0010 <span class="comment">%   model        a model structure generated from the database. The following</span>
0011 <span class="comment">%                fields are filled</span>
0012 <span class="comment">%                id:             'MetaCyc'</span>
0013 <span class="comment">%                description:    'Automatically generated from MetaCyc database'</span>
0014 <span class="comment">%                rxns:           Reaction id</span>
0015 <span class="comment">%                rxnNames:       Reaction name</span>
0016 <span class="comment">%                enzymes:        Enzyme id</span>
0017 <span class="comment">%                enzrxns:        Enzymatic-reaction id</span>
0018 <span class="comment">%                cplxs:          Enzyme complexes</span>
0019 <span class="comment">%                cplxComp:       Subunit components of enzyme complexes</span>
0020 <span class="comment">%                rxnEnzymeMat    A binary matrix that indicates association of a</span>
0021 <span class="comment">%                                specific enzyme to the reactions it catalyze</span>
0022 <span class="comment">%</span>
0023 <span class="comment">%   If the file metaCycEnzymes.mat is in the RAVEN\external\metacyc directory</span>
0024 <span class="comment">%   it will be loaded. Otherwise, it will be generated by parsing the MetaCyc</span>
0025 <span class="comment">%   database files. In general, this metaCycEnzymes.mat file should be removed</span>
0026 <span class="comment">%   and rebuilt when a newer version of MetaCyc is released.</span>
0027 <span class="comment">%</span>
0028 <span class="comment">%   Usage: model=getEnzymesFromMetaCyc(metacycPath)</span>
0029 <span class="comment">%</span>
0030 <span class="comment">%   Hao Wang, 2017-06-17</span>
0031 <span class="comment">%</span>
0032 
0033 <span class="comment">%NOTE: This is how one entry looks in the files</span>
0034 
0035 <span class="comment">%proteins.dat</span>
0036 <span class="comment">% UNIQUE-ID - MONOMER-8570</span>
0037 <span class="comment">% TYPES - Polypeptides</span>
0038 <span class="comment">% COMMON-NAME - D-carnitine dehydrogenase subunit</span>
0039 <span class="comment">% COMPONENT-OF - CPLX-5143</span>
0040 <span class="comment">% MOLECULAR-WEIGHT-EXP - 23</span>
0041 <span class="comment">% MOLECULAR-WEIGHT-KD - 23</span>
0042 <span class="comment">% SPECIES - ORG-6256</span>
0043 <span class="comment">% //</span>
0044 
0045 <span class="comment">%enzrxns.dat</span>
0046 <span class="comment">% UNIQUE-ID - ENZRXN-14974</span>
0047 <span class="comment">% TYPES - Enzymatic-Reactions</span>
0048 <span class="comment">% COMMON-NAME - (1S,4R)-iso-dihydrocarvone monooxygenase</span>
0049 <span class="comment">% BASIS-FOR-ASSIGNMENT - :MANUAL</span>
0050 <span class="comment">% CITATIONS - 10769172:EV-EXP-IDA-PURIFIED-PROTEIN:3419689584:caspi</span>
0051 <span class="comment">% COFACTORS - FAD</span>
0052 <span class="comment">% ENZYME - MONOMER-13964</span>
0053 <span class="comment">% PHYSIOLOGICALLY-RELEVANT? - T</span>
0054 <span class="comment">% REACTION - RXN-9435</span>
0055 <span class="comment">% REGULATED-BY - REG-12241</span>
0056 <span class="comment">% REGULATED-BY - REG-12240</span>
0057 <span class="comment">% TEMPERATURE-OPT - 35</span>
0058 
0059 <span class="comment">% A line that contains only '//' separates each object.</span>
0060 
0061 <span class="comment">%Check if the enzymatic proteins have been parsed before and saved. If so,</span>
0062 <span class="comment">%load the model.</span>
0063 [ST, I]=dbstack(<span class="string">'-completenames'</span>);
0064 ravenPath=fileparts(fileparts(fileparts(ST(I).file)));
0065 enzymesFile=fullfile(ravenPath,<span class="string">'external'</span>,<span class="string">'metacyc'</span>,<span class="string">'metaCycEnzymes.mat'</span>);
0066 metaCycProteinFile=<span class="string">'proteins.dat'</span>;
0067 metaCycEnzrxnsFile=<span class="string">'enzrxns.dat'</span>;
0068 
0069 <span class="keyword">if</span> exist(enzymesFile, <span class="string">'file'</span>)
0070     fprintf([<span class="string">'NOTE: Importing MetaCyc enzymes and reaction-enzyme association from '</span> strrep(enzymesFile,<span class="string">'\'</span>,<span class="string">'/'</span>) <span class="string">'.\n'</span>]);
0071     load(enzymesFile);
0072 <span class="keyword">else</span>
0073     fprintf([<span class="string">'Cannot locate '</span> strrep(genesFile,<span class="string">'\'</span>,<span class="string">'/'</span>) <span class="string">' and will try to generate it from the local MetaCyc database files.\n'</span>]);
0074     <span class="keyword">if</span> ~exist(fullfile(metacycPath,metaCycProteinFile),<span class="string">'file'</span>) || ~exist(fullfile(metacycPath,metaCycEnzrxnsFile),<span class="string">'file'</span>)
0075         EM=fprintf([<span class="string">'The files of enzymes or proteins cannot be located, and should be downloaded from MetaCyc.\n'</span>]);
0076         dispEM(EM);
0077     <span class="keyword">else</span>
0078         metaCycEnzymes.id=<span class="string">'MetaCyc'</span>;
0079         metaCycEnzymes.description=<span class="string">'Automatically generated from MetaCyc database'</span>;
0080            
0081                 <span class="comment">%Reserve space for 10000 enzyme complexs</span>
0082         metaCycEnzymes.cplxs=cell(10000,1);
0083         metaCycEnzymes.cplxComp=cell(10000,1);
0084         metaCycEnzymes.enzymes=cell(50000,1);
0085 
0086         <span class="comment">%Get the information of protein complexes and their components</span>
0087         nCplx=0;
0088         enzymeCounter=0;
0089 
0090         fid = fopen(fullfile(metacycPath,metaCycProteinFile), <span class="string">'r'</span>);
0091         <span class="comment">%Loop through the file</span>
0092         <span class="keyword">while</span> 1
0093           tline = fgetl(fid);
0094    
0095           <span class="comment">%Abort at end of file</span>
0096           <span class="keyword">if</span> ~ischar(tline)
0097               <span class="keyword">break</span>;
0098           <span class="keyword">end</span>
0099    
0100           <span class="comment">%Add Enzyme id</span>
0101           <span class="keyword">if</span> numel(tline)&gt;12 &amp;&amp; strcmp(tline(1:12),<span class="string">'UNIQUE-ID - '</span>)
0102               enzymeCounter=enzymeCounter+1;
0103               addMe=false;
0104               enzymeID=tline(13:end);
0105               metaCycEnzymes.enzymes{enzymeCounter}=enzymeID;
0106           <span class="keyword">end</span>
0107 
0108           <span class="comment">%Check if enzyme complexes</span>
0109           <span class="keyword">if</span> strcmp(tline(1:end),<span class="string">'TYPES - Protein-Complexes'</span>)
0110               nCplx=nCplx+1;
0111               nComp=0;
0112               
0113               <span class="comment">%Reserve 100 subunits for each enzyme complex</span>
0114               Comp.subunit=cell(100,1);
0115               metaCycEnzymes.cplxs{nCplx}=enzymeID;
0116                         
0117             addMe=true;
0118           <span class="keyword">end</span>         
0119           
0120           <span class="keyword">if</span> numel(tline)&gt;13 &amp;&amp; strcmp(tline(1:13),<span class="string">'COMPONENTS - '</span>)
0121                         nComp=nComp+1;
0122                         Comp.subunit{nComp}=tline(14:end);
0123           <span class="keyword">end</span>
0124 
0125           <span class="keyword">if</span> strcmp(tline(1:end),<span class="string">'//'</span>)
0126               <span class="keyword">if</span> addMe
0127                   Comp.subunit=Comp.subunit(1:nComp);
0128                   metaCycEnzymes.cplxComp{nCplx}=Comp;
0129               <span class="keyword">end</span>
0130               addMe=false;
0131           <span class="keyword">end</span>             
0132         <span class="keyword">end</span>
0133         <span class="comment">%Close the file</span>
0134         fclose(fid);
0135   
0136         <span class="comment">%If too much space was allocated, shrink the model</span>
0137         metaCycEnzymes.cplxs=metaCycEnzymes.cplxs(1:nCplx);
0138         metaCycEnzymes.cplxComp=metaCycEnzymes.cplxComp(1:nCplx);
0139         metaCycEnzymes.enzymes=metaCycEnzymes.enzymes(1:enzymeCounter);
0140        
0141            <span class="comment">% Iteratively replace all components of complexes into polypeptide subunits</span>
0142         <span class="keyword">for</span> i=1:numel(metaCycEnzymes.cplxComp)
0143             checkCplx=true;
0144             <span class="keyword">while</span> checkCplx
0145                    x=0;
0146                 mat=[]; <span class="comment">%Matrix for component of protein-complexs</span>
0147                 <span class="keyword">for</span> j=1:numel(metaCycEnzymes.cplxComp{i}.subunit)
0148                     [a, b]=ismember(metaCycEnzymes.cplxComp{i}.subunit{j},metaCycEnzymes.cplxs);
0149                     <span class="keyword">if</span> a
0150                         x=x+1;   <span class="comment">%record this value j, and the cplx id b</span>
0151                                 mat(x,:)=[j b];
0152                             <span class="keyword">end</span>
0153                         <span class="keyword">end</span>
0154 
0155                         <span class="keyword">if</span> isempty(mat)
0156                             checkCplx=false; <span class="comment">% No complexs found among components</span>
0157                         <span class="keyword">else</span>                                    
0158                     <span class="comment">%go through matrix JB</span>
0159                     <span class="keyword">for</span> k=1:x
0160                         <span class="comment">%disp(metaCycEnzymes.cplxComp{i}.subunit{mat(k,1)});</span>
0161                             metaCycEnzymes.cplxComp{i}.subunit(mat(k,1))=[];
0162                         metaCycEnzymes.cplxComp{i}.subunit=[metaCycEnzymes.cplxComp{i}.subunit; metaCycEnzymes.cplxComp{mat(k,2)}.subunit];
0163                     <span class="keyword">end</span>
0164                 <span class="keyword">end</span>
0165                 
0166             <span class="keyword">end</span>
0167           <span class="keyword">end</span>
0168 
0169         <span class="comment">%Preallocate space for 500000 enzymatic reactions</span>
0170         metaCycEnzymes.enzrxns=cell(50000,1);
0171         metaCycEnzymes.rxns=cell(50000,1);
0172         metaCycEnzymes.rxnNames=cell(50000,1);
0173         metaCycEnzymes.commoname=cell(50000,1);
0174         <span class="comment">%metaCycEnzymes.enzymes=cell(50000,1);</span>
0175         metaCycEnzymes.rxnEnzymeMat=sparse(50000,enzymeCounter); <span class="comment">% row: rxn, column: enzymes</span>
0176 
0177         <span class="comment">%Load enzyme and reaction association information</span>
0178         fid = fopen(fullfile(metacycPath,metaCycEnzrxnsFile), <span class="string">'r'</span>);
0179    
0180         <span class="comment">%Keeps track of how many enzymes and reactions have been added</span>
0181         enzrxnCounter=0;
0182         nRxn=0;
0183    
0184         <span class="comment">%These contain the mapping between Reactions and Enzymes</span>
0185         <span class="comment">%Loop through the file</span>
0186         <span class="keyword">while</span> 1
0187           tline = fgetl(fid);
0188    
0189           <span class="comment">%Abort at end of file</span>
0190           <span class="keyword">if</span> ~ischar(tline)
0191               <span class="keyword">break</span>;
0192           <span class="keyword">end</span>
0193 
0194           <span class="comment">%Check if it is a new enzymatic reaction</span>
0195           <span class="keyword">if</span> numel(tline)&gt;12 &amp;&amp; strcmp(tline(1:12),<span class="string">'UNIQUE-ID - '</span>)
0196               enzrxnCounter=enzrxnCounter+1;
0197               metaCycEnzymes.enzrxns{enzrxnCounter}=tline(13:end);
0198               metaCycEnzymes.commoname{enzrxnCounter}=<span class="string">''</span>;
0199           <span class="keyword">end</span>
0200                     
0201           <span class="comment">%Add common name of enzymatic reactions</span>
0202           <span class="keyword">if</span> numel(tline)&gt;14 &amp;&amp; strcmp(tline(1:14),<span class="string">'COMMON-NAME - '</span>)
0203                             metaCycEnzymes.commoname{enzrxnCounter}=tline(15:end);
0204                             
0205                             <span class="comment">%Remove HTML symobls</span>
0206                             metaCycEnzymes.commoname{enzrxnCounter}=regexprep(metaCycEnzymes.commoname{enzrxnCounter},<span class="string">'&lt;(\w+)&gt;'</span>,<span class="string">''</span>);
0207                             metaCycEnzymes.commoname{enzrxnCounter}=regexprep(metaCycEnzymes.commoname{enzrxnCounter},<span class="string">'&lt;/(\w+)&gt;'</span>,<span class="string">''</span>);
0208                             metaCycEnzymes.commoname{enzrxnCounter}=regexprep(metaCycEnzymes.commoname{enzrxnCounter},<span class="string">'[&amp;;]'</span>,<span class="string">''</span>);
0209           <span class="keyword">end</span>
0210 
0211                     <span class="comment">% I add one cell array rxns for checking existing ones by ismember</span>
0212                     <span class="comment">% because I cannot manage field rxns in this function</span>
0213 
0214           <span class="comment">%Add enzyme name</span>
0215           <span class="keyword">if</span> numel(tline)&gt;9 &amp;&amp; strcmp(tline(1:9),<span class="string">'ENZYME - '</span>)
0216                   
0217                   <span class="comment">%Save the index in enzymes field to nEnzyme</span>
0218                   [x, nEnzyme]=ismember(tline(10:end),metaCycEnzymes.enzymes);
0219                   <span class="keyword">if</span> ~x
0220                       <span class="comment">%disp(tline(10:end));</span>
0221                 <span class="keyword">end</span>
0222           <span class="keyword">end</span>
0223    
0224           <span class="comment">%Add reaction id, and rxnNames by concatenating unique common names</span>
0225           <span class="keyword">if</span> numel(tline)&gt;11 &amp;&amp; strcmp(tline(1:11),<span class="string">'REACTION - '</span>)
0226                   nRxn=nRxn+1;
0227                   rxns{nRxn}=<span class="string">''</span>;
0228                   rxnID=tline(12:end);
0229                   [c, d]=ismember(rxnID,rxns);
0230                   <span class="keyword">if</span> c
0231                       nRxn=nRxn-1;
0232                       
0233                       <span class="comment">%Check if this common name has been included by rxnNames</span>
0234                       k=strfind(metaCycEnzymes.rxnNames{d},metaCycEnzymes.commoname{enzrxnCounter});
0235                       <span class="keyword">if</span> isempty(k)
0236                           metaCycEnzymes.rxnNames{d}=strcat(metaCycEnzymes.rxnNames{d},<span class="string">';'</span>,metaCycEnzymes.commoname{enzrxnCounter});
0237                       <span class="keyword">end</span>
0238                       metaCycEnzymes.rxnEnzymeMat(d,nEnzyme)=1;
0239                   <span class="keyword">else</span>
0240                   metaCycEnzymes.rxns{nRxn}=rxnID;
0241                                 metaCycEnzymes.rxnNames{nRxn}=metaCycEnzymes.commoname{enzrxnCounter};
0242                   rxns{nRxn}=rxnID;
0243                       metaCycEnzymes.rxnEnzymeMat(nRxn,nEnzyme)=1;
0244                 <span class="keyword">end</span>
0245           <span class="keyword">end</span>
0246              
0247         <span class="keyword">end</span>
0248         
0249         <span class="comment">%Close the file</span>
0250         fclose(fid);
0251  
0252         <span class="comment">%Shrink the sizes</span>
0253         metaCycEnzymes.enzrxns=metaCycEnzymes.enzrxns(1:enzrxnCounter);
0254         metaCycEnzymes.commoname=metaCycEnzymes.commoname(1:enzrxnCounter);
0255         metaCycEnzymes.rxns=metaCycEnzymes.rxns(1:nRxn);
0256         metaCycEnzymes.rxnNames=metaCycEnzymes.rxnNames(1:nRxn);
0257         metaCycEnzymes.rxnEnzymeMat=metaCycEnzymes.rxnEnzymeMat(1:nRxn,:);
0258               
0259         <span class="comment">%Save the model structure</span>
0260         save(enzymesFile,<span class="string">'metaCycEnzymes'</span>);
0261       <span class="keyword">end</span>
0262 
0263     <span class="keyword">end</span>
0264 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Wed 14-Mar-2018 21:08:28 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>
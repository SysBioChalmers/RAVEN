<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of parseHPA</title>
  <meta name="keywords" content="parseHPA">
  <meta name="description" content="parseHPA">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../index.html">Home</a> &gt;  <a href="index.html">hpa</a> &gt; parseHPA.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../index.html"><img alt="<" border="0" src="../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for hpa&nbsp;<img alt=">" border="0" src="../right.png"></a></td></tr></table>-->

<h1>parseHPA
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>parseHPA</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function hpaData=parseHPA(fileName, version) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> parseHPA
   Parses a database dump of the Human Protein Atlas (HPA)

   fileName            comma- or tab-separated database dump of HPA. For details
                       regarding the format, see
                       http://www.proteinatlas.org/about/download.
   version             version of HPA [optional, default=17]

   hpaData
       genes               cell array with the unique gene names. In
                           version 17 this is the ensamble name, see
                           geneNames below for the names in ver 17
       geneNames           cell array with the gene names, indexed the
                           same way as genes.
       tissues             cell array with the tissue names. The list may not be
                           unique, as there can be multiple cell types per tissue
       celltypes           cell array with the cell type names for each tissue
       levels              cell array with the unique expression levels
       types               cell array with the unique evidence types
       reliabilities       cell array with the unique reliability levels

       gene2Level          gene-to-expression level mapping in sparse matrix form.
                           The value for element i,j is the index in
                           hpaData.levels of gene i in cell type j
       gene2Type           gene-to-evidence type mapping in sparse matrix form.
                           The value for element i,j is the index in
                           hpaData.types of gene i in cell type j. Doesn't
                           exist in version 17.
       gene2Reliability    gene-to-reliability level mapping in sparse matrix form.
                           The value for element i,j is the index in
                           hpaData.reliabilities of gene i in cell type j


   Usage: hpaData=parseHPA(fileName)

   Johan Gustafsson, 2017-10-10</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function hpaData=parseHPA(fileName, version)</a>
0002 <span class="comment">% parseHPA</span>
0003 <span class="comment">%   Parses a database dump of the Human Protein Atlas (HPA)</span>
0004 <span class="comment">%</span>
0005 <span class="comment">%   fileName            comma- or tab-separated database dump of HPA. For details</span>
0006 <span class="comment">%                       regarding the format, see</span>
0007 <span class="comment">%                       http://www.proteinatlas.org/about/download.</span>
0008 <span class="comment">%   version             version of HPA [optional, default=17]</span>
0009 <span class="comment">%</span>
0010 <span class="comment">%   hpaData</span>
0011 <span class="comment">%       genes               cell array with the unique gene names. In</span>
0012 <span class="comment">%                           version 17 this is the ensamble name, see</span>
0013 <span class="comment">%                           geneNames below for the names in ver 17</span>
0014 <span class="comment">%       geneNames           cell array with the gene names, indexed the</span>
0015 <span class="comment">%                           same way as genes.</span>
0016 <span class="comment">%       tissues             cell array with the tissue names. The list may not be</span>
0017 <span class="comment">%                           unique, as there can be multiple cell types per tissue</span>
0018 <span class="comment">%       celltypes           cell array with the cell type names for each tissue</span>
0019 <span class="comment">%       levels              cell array with the unique expression levels</span>
0020 <span class="comment">%       types               cell array with the unique evidence types</span>
0021 <span class="comment">%       reliabilities       cell array with the unique reliability levels</span>
0022 <span class="comment">%</span>
0023 <span class="comment">%       gene2Level          gene-to-expression level mapping in sparse matrix form.</span>
0024 <span class="comment">%                           The value for element i,j is the index in</span>
0025 <span class="comment">%                           hpaData.levels of gene i in cell type j</span>
0026 <span class="comment">%       gene2Type           gene-to-evidence type mapping in sparse matrix form.</span>
0027 <span class="comment">%                           The value for element i,j is the index in</span>
0028 <span class="comment">%                           hpaData.types of gene i in cell type j. Doesn't</span>
0029 <span class="comment">%                           exist in version 17.</span>
0030 <span class="comment">%       gene2Reliability    gene-to-reliability level mapping in sparse matrix form.</span>
0031 <span class="comment">%                           The value for element i,j is the index in</span>
0032 <span class="comment">%                           hpaData.reliabilities of gene i in cell type j</span>
0033 <span class="comment">%</span>
0034 <span class="comment">%</span>
0035 <span class="comment">%   Usage: hpaData=parseHPA(fileName)</span>
0036 <span class="comment">%</span>
0037 <span class="comment">%   Johan Gustafsson, 2017-10-10</span>
0038 
0039 <span class="keyword">if</span> nargin&lt;2
0040     version=17; <span class="comment">%Change this and add code for more versions when the current HPA version is increased and the format is changed</span>
0041 <span class="keyword">end</span>;
0042 
0043 <span class="keyword">if</span> (version == 17)
0044     fid=fopen(fileName,<span class="string">'r'</span>);
0045     hpa=textscan(fid,<span class="string">'%q %q %q %q %q %q'</span>,<span class="string">'Delimiter'</span>,<span class="string">'\t'</span>);
0046     fclose(fid);
0047 
0048     <span class="comment">%Go through and see if the headers match what was expected</span>
0049     headers={<span class="string">'Gene'</span> <span class="string">'Gene name'</span> <span class="string">'Tissue'</span> <span class="string">'Cell type'</span> <span class="string">'Level'</span> <span class="string">'Reliability'</span>};
0050     <span class="keyword">for</span> i=1:numel(headers)
0051         <span class="keyword">if</span> ~strcmpi(headers(i),hpa{i}(1))
0052             EM=[<span class="string">'Could not find the header &quot;'</span> headers{i} <span class="string">'&quot;. Make sure that the input file matches the format specified at http://www.proteinatlas.org/about/download'</span>];
0053           dispEM(EM);
0054         <span class="keyword">end</span>
0055         <span class="comment">%Remove the header line here</span>
0056         hpa{i}(1)=[];
0057     <span class="keyword">end</span>
0058 
0059     <span class="comment">%Get the unique values of each data type</span>
0060     [hpaData.genes, P, I]=unique(hpa{1});
0061     hpaData.geneNames=hpa{2}(P); <span class="comment">%make this vector use the index as genes</span>
0062     [~, J, K]=unique(strcat(hpa{3},<span class="string">'â‚¬'</span>,hpa{4}));
0063     hpaData.tissues=hpa{3}(J);
0064     hpaData.celltypes=hpa{4}(J);
0065     [hpaData.levels, ~, L]=unique(hpa{5});
0066     [hpaData.reliabilities, ~, N]=unique(hpa{6});
0067 
0068     <span class="comment">%Map the data to be sparse matrises instead</span>
0069     hpaData.gene2Level=sparse(I,K,L,numel(hpaData.genes),numel(hpaData.tissues));
0070     hpaData.gene2Reliability=sparse(I,K,N,numel(hpaData.genes),numel(hpaData.tissues));
0071 <span class="keyword">else</span>
0072     fid=fopen(fileName,<span class="string">'r'</span>);
0073     hpa=textscan(fid,<span class="string">'%q %q %q %q %q %q'</span>,<span class="string">'Delimiter'</span>,<span class="string">','</span>);
0074     fclose(fid);
0075 
0076     <span class="comment">%Go through and see if the headers match what was expected</span>
0077     headers={<span class="string">'Gene'</span> <span class="string">'Tissue'</span> <span class="string">'Cell type'</span> <span class="string">'Level'</span> <span class="string">'Expression type'</span> <span class="string">'Reliability'</span>};
0078     <span class="keyword">for</span> i=1:numel(headers)
0079         <span class="keyword">if</span> ~strcmpi(headers(i),hpa{i}(1))
0080             EM=[<span class="string">'Could not find the header &quot;'</span> headers{i} <span class="string">'&quot;. Make sure that the input file matches the format specified at http://www.proteinatlas.org/about/download'</span>];
0081           dispEM(EM);
0082         <span class="keyword">end</span>
0083         <span class="comment">%Remove the header line here</span>
0084         hpa{i}(1)=[];
0085     <span class="keyword">end</span>
0086 
0087     <span class="comment">%Get the unique values of each data type</span>
0088     [hpaData.genes, ~, I]=unique(hpa{1});
0089     [~, J, K]=unique(strcat(hpa{2},<span class="string">'â‚¬'</span>,hpa{3}));
0090     hpaData.tissues=hpa{2}(J);
0091     hpaData.celltypes=hpa{3}(J);
0092     [hpaData.levels, ~, L]=unique(hpa{4});
0093     [hpaData.types, ~, M]=unique(hpa{5});
0094     [hpaData.reliabilities, ~, N]=unique(hpa{6});
0095 
0096     <span class="comment">%Map the data to be sparse matrises instead</span>
0097     hpaData.gene2Level=sparse(I,K,L,numel(hpaData.genes),numel(hpaData.tissues));
0098     hpaData.gene2Type=sparse(I,K,M,numel(hpaData.genes),numel(hpaData.tissues));
0099     hpaData.gene2Reliability=sparse(I,K,N,numel(hpaData.genes),numel(hpaData.tissues));    
0100 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Wed 14-Mar-2018 21:08:28 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>